<!DOCTYPE html>
<html lang="zh-TW" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UAS R&D Hub (整合版 V4.0)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=JetBrains+Mono:wght@400;700&display=swap');

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #020617;
            color: #cbd5e1;
        }

        .mono-font {
            font-family: 'JetBrains Mono', monospace;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0f172a;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }

        /* UI Components */
        #reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, #38bdf8, #10b981);
            z-index: 9999;
            transition: width 0.2s ease;
            width: 0%;
        }

        #back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 3rem;
            height: 3rem;
            background: #0ea5e9;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transform: translateY(100px);
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.4);
        }

        #back-to-top.visible {
            opacity: 1;
            transform: translateY(0);
        }

        #back-to-top:hover {
            background: #0284c7;
            transform: translateY(-4px);
        }

        .search-container {
            position: relative;
        }

        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 0.5rem;
            margin-top: 0.5rem;
            max-height: 400px;
            overflow-y: auto;
            z-index: 50;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }

        .search-result-item {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #334155;
            cursor: pointer;
            transition: all 0.2s;
        }

        .search-result-item:hover {
            background: #334155;
            padding-left: 1.5rem;
        }

        .bookmark-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
            color: #64748b;
            transition: all 0.2s;
            z-index: 10;
        }

        .bookmark-badge.bookmarked {
            color: #fbbf24;
        }

        .nav-item.active {
            background-color: rgba(14, 165, 233, 0.15);
            color: #38bdf8;
            border-left: 3px solid #38bdf8;
        }

        .interactive-card,
        .port-connector,
        .topo-block,
        .tool-card {
            transition: all 0.2s ease;
            cursor: pointer;
            border: 1px solid #334155;
            min-height: 44px;
        }

        .interactive-card:hover,
        .port-connector:hover,
        .topo-block:hover,
        .tool-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 15px rgba(56, 189, 248, 0.15);
            border-color: #38bdf8;
            background-color: rgba(30, 41, 59, 0.8);
        }

        .voltage-tag {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.65rem;
            font-weight: bold;
            margin-right: 4px;
            display: inline-block;
        }

        .v-5 {
            background: rgba(244, 63, 94, 0.15);
            color: #fb7185;
            border: 1px solid rgba(244, 63, 94, 0.3);
        }

        .v-33 {
            background: rgba(56, 189, 248, 0.15);
            color: #38bdf8;
            border: 1px solid rgba(56, 189, 248, 0.3);
        }

        .source-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .badge-datasheet {
            background-color: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.3);
            color: #c084fc;
        }

        .badge-procurement {
            background-color: rgba(236, 72, 153, 0.1);
            border: 1px solid rgba(236, 72, 153, 0.3);
            color: #f472b6;
        }

        .badge-protocol {
            background-color: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #60a5fa;
        }

        .badge-aiot {
            background-color: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            color: #a78bfa;
        }

        .badge-log {
            background-color: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #fbbf24;
        }

        .badge-exam {
            background-color: rgba(132, 204, 22, 0.1);
            border: 1px solid rgba(132, 204, 22, 0.3);
            color: #a3e635;
        }

        .badge-official {
            background-color: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.3);
            color: #818cf8;
        }

        .badge-microuav {
            background-color: rgba(236, 72, 153, 0.1);
            border: 1px solid rgba(236, 72, 153, 0.3);
            color: #ec4899;
        }

        .badge-vio {
            background-color: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #4ade80;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease;
        }

        /* Topology Diagram Styles */
        .topo-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .topo-box {
            flex: 1;
            background: #0f172a;
            border: 1px solid #334155;
            padding: 1rem;
            border-radius: 0.5rem;
            position: relative;
        }

        .border-l-accent {
            border-left: 3px solid;
        }

        .foc-step {
            position: relative;
        }

        .foc-step::after {
            content: '➜';
            position: absolute;
            right: -20px;
            top: 50%;
            transform: translateY(-50%);
            color: #475569;
            font-size: 1.2rem;
        }

        .foc-step:last-child::after {
            display: none;
        }

        @media (max-width: 768px) {
            .foc-step::after {
                right: 50%;
                top: auto;
                bottom: -25px;
                transform: translateX(50%) rotate(90deg);
            }
        }

        .pin-table th {
            text-align: left;
            padding: 0.5rem;
            color: #94a3b8;
            font-size: 0.7rem;
            text-transform: uppercase;
            border-bottom: 1px solid #334155;
        }

        .pin-table td {
            padding: 0.5rem;
            border-bottom: 1px solid #1e293b;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: #cbd5e1;
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
            max-height: 400px;
        }

        /* Theme Toggle */
        .theme-toggle {
            width: 3rem;
            height: 1.5rem;
            background: #334155;
            border-radius: 9999px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
        }

        .theme-toggle.active {
            background: #0ea5e9;
        }

        .theme-toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 1.25rem;
            height: 1.25rem;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
        }

        .theme-toggle.active .theme-toggle-slider {
            transform: translateX(1.5rem);
        }

        /* Tour Overlay */
        .tour-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9998;
            display: none;
        }

        .tour-overlay.active {
            display: block;
        }

        .tour-tooltip {
            position: fixed;
            background: #1e293b;
            border: 2px solid #38bdf8;
            border-radius: 8px;
            padding: 1.5rem;
            max-width: 350px;
            z-index: 10000;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .tour-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .tour-btn-primary {
            background: #0ea5e9;
            color: white;
        }

        .tour-btn-secondary {
            background: #334155;
            color: #cbd5e1;
        }

        .tour-highlight {
            position: relative;
            z-index: 9999 !important;
            box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.5);
            background-color: #1e293b;
            border-radius: 0.5rem;
        }

        /* IO Logic Flow */
        .io-flow-container {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.75rem;
        }

        .io-box {
            padding: 0.5rem;
            border-radius: 4px;
            border: 1px solid #475569;
            background: #1e293b;
            text-align: center;
            font-weight: bold;
            width: 22%;
        }

        .io-arrow {
            color: #64748b;
            font-size: 1rem;
        }

        /* Official Docs Table Styles */
        .specs-table td {
            padding: 0.5rem;
            border-bottom: 1px solid #334155;
            vertical-align: top;
        }

        .specs-table tr:last-child td {
            border-bottom: none;
        }

        .specs-key {
            font-weight: bold;
            color: #94a3b8;
            width: 30%;
        }

        .specs-val {
            color: #e2e8f0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
        }

        .pinout-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }

        .connector-box {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .connector-title {
            font-weight: bold;
            color: #38bdf8;
            border-bottom: 1px solid #475569;
            padding-bottom: 0.5rem;
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
        }

        .pin-row {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            padding: 0.25rem 0;
            border-bottom: 1px dashed #334155;
        }

        .pin-row:last-child {
            border-bottom: none;
        }

        /* Comparison Table */
        .compare-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .compare-table th {
            background: #1e293b;
            padding: 0.75rem;
            text-align: left;
            border-bottom: 2px solid #475569;
            font-weight: bold;
            color: #38bdf8;
        }

        .compare-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #334155;
        }

        .compare-table tr:hover {
            background: rgba(56, 189, 248, 0.05);
        }

        .check-icon {
            color: #10b981;
        }

        .cross-icon {
            color: #ef4444;
        }

        /* 2025-02-16 Font Size Boost (User Request) */
        main .text-xs {
            font-size: 0.85rem !important;
            /* Was 0.75rem */
            line-height: 1.4rem !important;
        }

        main .text-sm {
            font-size: 1rem !important;
            /* Was 0.875rem */
            line-height: 1.6rem !important;
        }

        main .text-base {
            font-size: 1.1rem !important;
        }

        main h3 {
            font-size: 1.35rem !important;
            /* Boost headers too */
        }
    </style>
</head>

<body class="flex flex-col md:flex-row min-h-screen">

    <div id="reading-progress"></div>
    <div id="back-to-top"><i class="fa-solid fa-arrow-up"></i></div>

    <!-- Tour Overlay -->
    <div id="tour-overlay" class="tour-overlay"></div>

    <!-- Mobile Header -->
    <div
        class="md:hidden bg-slate-900 border-b border-slate-800 p-4 flex justify-between items-center sticky top-0 z-50">
        <h1 class="font-bold text-lg text-slate-100"><i class="fa-solid fa-code mr-2"></i>UAS R&D Hub</h1>
        <button id="mobile-menu-btn" class="text-slate-400 focus:outline-none text-2xl">☰</button>
    </div>

    <!-- Sidebar -->

    <nav id="sidebar"
        class="fixed top-0 left-0 w-64 h-full bg-slate-900 border-r border-slate-800 transform -translate-x-full md:translate-x-0 transition-transform duration-300 z-50 overflow-y-auto custom-scrollbar">
        <div class="p-6 border-b border-slate-800 flex items-center justify-between">
            <h1 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-sky-400 to-indigo-400">
                UAS R&D Hub
                <span class="text-xs block text-slate-500 font-mono mt-1">v5.0 Integrated</span>
            </h1>
            <button id="close-sidebar" class="md:hidden text-slate-400 hover:text-white">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>
        <div class="p-4 space-y-1">
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-white bg-slate-800 border border-slate-700 hover:border-sky-500 rounded-lg transition group mb-4 shadow-lg shadow-black/20"
                data-section="section-landing">
                <i class="fa-solid fa-gauge-high w-6 text-sky-400 group-hover:text-white transition"></i>
                <span class="font-bold">起始頁面 (Start)</span>
            </a>

            <div class="px-4 py-2 text-xs font-bold text-slate-500 uppercase tracking-wider">Overview</div>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-intro">
                <i class="fa-solid fa-home w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 系統概觀
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-roadmap">
                <i class="fa-solid fa-map-location-dot w-6 text-slate-500 group-hover:text-sky-400 transition"></i>
                技術路線圖
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-microuav">
                <i class="fa-solid fa-feather w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 微型無人機
                (Sub-250g)
            </a>

            <div class="px-4 py-2 text-xs font-bold text-slate-500 uppercase tracking-wider mt-4">Hardware Engineering
            </div>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-official-docs">
                <i class="fa-solid fa-book w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 官方技術手冊
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-teardown">
                <i class="fa-solid fa-screwdriver-wrench w-6 text-slate-500 group-hover:text-sky-400 transition"></i>
                硬體拆解分析
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-mcu">
                <i class="fa-solid fa-microchip w-6 text-slate-500 group-hover:text-sky-400 transition"></i> MCU 架構詳解
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-hardware">
                <i class="fa-solid fa-memory w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 硬體解剖學
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-pixhawk">
                <i class="fa-solid fa-server w-6 text-slate-500 group-hover:text-sky-400 transition"></i> Pixhawk 6X/6C
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-design">
                <i class="fa-solid fa-pen-ruler w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 自製硬體指南
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-bldc">
                <i class="fa-solid fa-fan w-6 text-slate-500 group-hover:text-sky-400 transition"></i> BLDC 馬達實驗室
            </a>

            <div class="px-4 py-2 text-xs font-bold text-slate-500 uppercase tracking-wider mt-4">Logic & Software</div>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-software">
                <i class="fa-brands fa-git-alt w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 軟體棧 (Stack)
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-protocols">
                <i class="fa-solid fa-network-wired w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 通訊協定
                (DShot/RF)
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-devenv">
                <i class="fa-solid fa-code w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 開發環境建置
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-aiot">
                <i class="fa-solid fa-brain w-6 text-slate-500 group-hover:text-sky-400 transition"></i> AIoT 與 ROS 2
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-vio">
                <i class="fa-solid fa-eye w-6 text-slate-500 group-hover:text-sky-400 transition"></i> VIO 視覺里程計
            </a>

            <div class="px-4 py-2 text-xs font-bold text-slate-500 uppercase tracking-wider mt-4">Control & Project
            </div>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-pid">
                <i class="fa-solid fa-chart-line w-6 text-slate-500 group-hover:text-sky-400 transition"></i> PID 控制理論
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-tuning">
                <i class="fa-solid fa-sliders w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 系統測試與調參
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-build-aiot">
                <i class="fa-solid fa-tools w-6 text-slate-500 group-hover:text-sky-400 transition"></i> X500-AIoT 建置
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-logs">
                <i class="fa-solid fa-book-journal-whills w-6 text-slate-500 group-hover:text-sky-400 transition"></i>
                實作日誌 & SOP
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-maint">
                <i class="fa-solid fa-stethoscope w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 故障診斷與維護
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-cases">
                <i class="fa-solid fa-rocket w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 實戰案例
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-exam">
                <i class="fa-solid fa-id-card w-6 text-slate-500 group-hover:text-sky-400 transition"></i> CAA 術科測驗
            </a>
            <a href="#"
                class="nav-item flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-sky-400 rounded-lg transition group"
                data-section="section-resources">
                <i class="fa-solid fa-box-archive w-6 text-slate-500 group-hover:text-sky-400 transition"></i> 資源與術語
            </a>

            <div class="mt-8 px-4 text-xs text-slate-600 text-center">
                UAS Hub v5.0<br>Integrated System
                <div class="mt-4 text-emerald-500 font-bold cursor-default hover:text-emerald-400 transition">
                    <i class="fa-solid fa-code mr-1"></i> Compiled by MarlonWu
                </div>
            </div>
        </div>
    </nav>


    <!-- Main Content -->
    <main class="flex-1 p-4 md:p-10 overflow-x-hidden md:ml-64">

        <!-- ========================================
         在這裡插入 Part 2-8 的所有 section 內容
         ======================================== -->
        <!-- ============================================================
     Part 2: Sub-250g 微型無人機系統設計章節
     插入位置: Part 1 的 <main> 區塊內
     ============================================================ -->

        <section id="section-intro" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-intro"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">飛行物理與混控 (Physics)</h2>
            </header>
            <div class="grid lg:grid-cols-2 gap-8">
                <div class="space-y-6">
                    <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                        <h3 class="text-lg font-bold text-sky-400 mb-3">推重比 (Thrust-to-Weight Ratio)</h3>
                        <p class="text-xs text-slate-400 mb-2">決定飛行性能的關鍵指標。X500 V2 建議值為 2.0+。</p>
                        <div class="bg-slate-950 p-4 rounded text-center border border-slate-700">
                            <p class="text-slate-200 text-lg mono-font">$$ TWR = \frac{Total Thrust (g)}{AUW (g)} $$</p>
                        </div>
                    </div>
                    <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                        <h3 class="text-lg font-bold text-emerald-400 mb-3">混控矩陣 (Mixer Matrix)</h3>
                        <p class="text-xs text-slate-400 mb-2">Quad-X 構型的力矩分配原理。</p>
                        <div class="bg-slate-950 p-4 rounded text-left border border-slate-700 overflow-x-auto">
                            <p class="text-slate-200 text-xs mono-font" style="margin:0">
                                Motor 1 (FR): +Roll, -Pitch, +Yaw<br>
                                Motor 2 (RL): +Roll, +Pitch, -Yaw<br>
                                Motor 3 (FL): -Roll, -Pitch, -Yaw<br>
                                Motor 4 (RR): -Roll, +Pitch, +Yaw
                            </p>
                        </div>
                    </div>
                </div>
                <div class="bg-slate-900 p-6 rounded-xl border border-slate-800 shadow-lg">
                    <div class="chart-container"><canvas id="vehicleChart"></canvas></div>
                </div>
            </div>
        </section>
        <section id="section-roadmap" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-roadmap"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">技術演進與定位 (Tech Roadmap & Evolution)</h2>
                <div class="flex items-center gap-2 text-slate-400 text-sm">
                    <span class="source-badge badge-holybro">Official</span>
                    <span>FMUv6 vs FMUv7 (RT)</span>
                </div>
            </header>

            <div class="grid lg:grid-cols-2 gap-8 mb-8">
                <!-- Current Gen: Pixhawk 6C -->
                <div
                    class="bg-slate-900 p-6 rounded-xl border-l-4 border-emerald-500 shadow-lg relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-10"><i class="fa-solid fa-microchip text-9xl"></i>
                    </div>
                    <span
                        class="bg-emerald-900/50 text-emerald-400 px-2 py-1 rounded text-xs font-bold uppercase mb-2 inline-block">Current
                        Standard (現在主流)</span>
                    <h3 class="text-2xl font-bold text-white mb-2">Pixhawk 6C (FMUv6C)</h3>
                    <p class="text-sm text-slate-400 mb-6">被 PX4/ArduPilot 官方廣泛支援的主流開放標準之一。專為中高階無人機設計，強調性價比與整合度。</p>

                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="w-8 mt-1 text-emerald-500"><i class="fa-solid fa-brain"></i></div>
                            <div>
                                <strong class="text-slate-200 block text-sm">STM32H743 (MCU)</strong>
                                <span class="text-xs text-slate-500">480MHz, Cortex-M7。效能足以應付高頻率 EKF3 與振動濾波，是目前
                                    PX4/ArduPilot 的甜蜜點。</span>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-8 mt-1 text-emerald-500"><i class="fa-solid fa-cubes"></i></div>
                            <div>
                                <strong class="text-slate-200 block text-sm">All-in-One 設計</strong>
                                <span class="text-xs text-slate-500">飛控核心與接口載板 (Baseboard) 整合在一起 (除 Mini
                                    版外)，減少接觸不良風險，適合量產機。</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Next Gen: FMURT7 -->
                <div
                    class="bg-slate-900 p-6 rounded-xl border-l-4 border-orange-500 shadow-lg relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-10"><i class="fa-solid fa-rocket text-9xl"></i></div>
                    <span
                        class="bg-orange-900/50 text-orange-400 px-2 py-1 rounded text-xs font-bold uppercase mb-2 inline-block">Next
                        Gen (未來架構 - 自定義分類)</span>
                    <h3 class="text-2xl font-bold text-white mb-2">Pixhawk RT (FMURT7)</h3>
                    <p class="text-sm text-slate-400 mb-6">相較 H7 架構提供更高 I/O 頻寬與原生 GbE，適合邊緣運算 (Edge AI) 與工業級模組化需求。</p>

                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="w-8 mt-1 text-orange-500"><i class="fa-solid fa-bolt"></i></div>
                            <div>
                                <strong class="text-slate-200 block text-sm">i.MX RT1176 (Crossover)</strong>
                                <span class="text-xs text-slate-500">1GHz 雙核心 (M7+M4)。原生支援 Gigabit Ethernet，打破 STM32
                                    的頻寬天花板。</span>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-8 mt-1 text-orange-500"><i class="fa-solid fa-puzzle-piece"></i></div>
                            <div>
                                <strong class="text-slate-200 block text-sm">PAB 標準 (模組化)</strong>
                                <span class="text-xs text-slate-500">Pixhawk Autopilot Bus。將「運算核心」做成類似 SIM
                                    卡的模組，可插拔升級，載板可通用。</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Key Peripherals -->
            <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                <h4 class="font-bold text-slate-200 mb-4 text-sm uppercase tracking-wider flex items-center">
                    <i class="fa-solid fa-plug mr-2 text-indigo-400"></i>
                    6C 關鍵周邊支援 (Key Peripherals)
                </h4>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-slate-950 p-3 rounded border border-slate-700 flex items-start">
                        <i class="fa-solid fa-satellite-dish text-sky-500 mt-1 mr-3"></i>
                        <div>
                            <strong class="text-slate-300 text-sm block">Unicore UM982 (雙天線 RTK)</strong>
                            <p class="text-xs text-slate-500 mt-1">6C 原生支援。透過雙天線直接計算航向
                                (Heading)，取代傳統磁羅盤，徹底解決高壓電塔/橋樑下的磁干擾問題。</p>
                        </div>
                    </div>
                    <div class="bg-slate-950 p-3 rounded border border-slate-700 flex items-start">
                        <i class="fa-solid fa-car-battery text-rose-500 mt-1 mr-3"></i>
                        <div>
                            <strong class="text-slate-300 text-sm block">PM08D (數位電源模組)</strong>
                            <p class="text-xs text-slate-500 mt-1">PM08D：使用 I2C (INA226) 通訊<br>PM08V：使用 I2C (INA228)
                                通訊<br>專為 Pixhawk 5X/6X 設計。</p>
                        </div>
                    </div>
                </div>
                <div class="mt-2 text-xs text-slate-500 text-center">* 數據來源：Holybro 官方規格書</div>
            </div>
        </section>
        <section id="section-microuav" class="mb-16 hidden animate-fade-in">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-3xl font-bold text-pink-400 flex items-center">
                    <i class="fa-solid fa-feather mr-3"></i>Sub-250g 微型無人機系統設計
                </h2>
                <span class="bookmark-badge" data-section="section-microuav"><i
                        class="fa-regular fa-bookmark"></i></span>
            </div>

            <!-- 法規與設計約束 -->
            <div
                class="bg-gradient-to-r from-pink-900/20 to-purple-900/20 border border-pink-500/30 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-pink-300 mb-4 flex items-center">
                    <i class="fa-solid fa-balance-scale mr-2"></i>法規驅動設計 (Regulation-Driven Design)
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-slate-900 p-4 rounded border border-slate-700">
                        <div class="text-sm font-bold text-amber-400 mb-3 flex items-center">
                            <i class="fa-solid fa-gavel mr-2"></i>台灣 CAA 法規要點
                        </div>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span><strong class="text-amber-300">250g 以下</strong>：免註冊、免操作證、免申請飛航</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-exclamation-triangle text-yellow-400 mr-2 mt-1"></i>
                                <span>仍需遵守<strong class="text-yellow-300">禁航區</strong>、<strong
                                        class="text-yellow-300">400呎高度限制</strong></span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-ban text-red-400 mr-2 mt-1"></i>
                                <span>禁止夜間飛行、禁止目視外操作 (BVLOS)</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-shield-halved text-blue-400 mr-2 mt-1"></i>
                                <span>建議投保<strong class="text-blue-300">責任險</strong> (非強制但推薦)</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-info-circle text-slate-400 mr-2 mt-1"></i>
                                <span class="text-slate-400 text-xs">實際規定請以民航局最新公告與圖資為準</span>
                            </li>
                        </ul>
                    </div>

                    <div class="bg-slate-900 p-4 rounded border border-slate-700">
                        <div class="text-sm font-bold text-pink-400 mb-3 flex items-center">
                            <i class="fa-solid fa-weight-scale mr-2"></i>重量分配策略
                        </div>
                        <div class="space-y-3">
                            <div class="bg-slate-950 p-3 rounded">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-xs text-slate-400">機架 + 馬達 + ESC</span>
                                    <span class="text-sm font-bold text-pink-300">~80g</span>
                                </div>
                                <div class="w-full bg-slate-800 rounded-full h-2">
                                    <div class="bg-pink-500 h-2 rounded-full" style="width: 32%"></div>
                                </div>
                            </div>
                            <div class="bg-slate-950 p-3 rounded">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-xs text-slate-400">飛控 + 感測器</span>
                                    <span class="text-sm font-bold text-purple-300">~50g</span>
                                </div>
                                <div class="w-full bg-slate-800 rounded-full h-2">
                                    <div class="bg-purple-500 h-2 rounded-full" style="width: 20%"></div>
                                </div>
                            </div>
                            <div class="bg-slate-950 p-3 rounded">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-xs text-slate-400">電池 (2S 450mAh)</span>
                                    <span class="text-sm font-bold text-sky-300">~28g</span>
                                </div>
                                <div class="w-full bg-slate-800 rounded-full h-2">
                                    <div class="bg-sky-500 h-2 rounded-full" style="width: 28%"></div>
                                </div>
                            </div>
                            <div class="bg-slate-950 p-3 rounded">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-xs text-slate-400">任務載荷 (相機/VIO)</span>
                                    <span class="text-sm font-bold text-emerald-300">~50g</span>
                                </div>
                                <div class="w-full bg-slate-800 rounded-full h-2">
                                    <div class="bg-emerald-500 h-2 rounded-full" style="width: 20%"></div>
                                </div>
                            </div>
                            <div class="border-t border-slate-700 pt-2 mt-2">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm font-bold text-slate-300">總重 (含安全餘裕)</span>
                                    <span class="text-lg font-bold text-pink-400">≤ 245g</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 核心硬體選型 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-pink-300 mb-4 flex items-center">
                    <i class="fa-solid fa-microchip mr-2"></i>核心硬體選型 (Component Selection)
                </h3>

                <!-- 飛控板比較 -->
                <div class="mb-6">
                    <h4 class="text-lg font-bold text-purple-300 mb-3 flex items-center">
                        <i class="fa-solid fa-brain mr-2"></i>飛控板 (Flight Controller)
                    </h4>
                    <div class="overflow-x-auto">
                        <table class="compare-table">
                            <thead>
                                <tr>
                                    <th>型號</th>
                                    <th>處理器</th>
                                    <th>重量</th>
                                    <th>IMU</th>
                                    <th>接口</th>
                                    <th>價格</th>
                                    <th>推薦度</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong class="text-pink-400">Pixhawk 4 Mini</strong></td>
                                    <td class="mono-font text-xs">STM32F765</td>
                                    <td class="text-emerald-400 font-bold">37.2g</td>
                                    <td class="text-xs">ICM-20689<br>BMI055</td>
                                    <td class="text-xs">8×PWM, GPS, Telem, I²C</td>
                                    <td class="text-amber-400">~$150</td>
                                    <td class="text-center"><i class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-regular fa-star text-slate-600"></i></td>
                                </tr>
                                <tr>
                                    <td><strong class="text-sky-400">Holybro Kakute H7 Mini</strong></td>
                                    <td class="mono-font text-xs">STM32H743</td>
                                    <td class="text-emerald-400 font-bold">6.5g</td>
                                    <td class="text-xs">ICM-42688P</td>
                                    <td class="text-xs">9×PWM, OSD, 2×UART</td>
                                    <td class="text-amber-400">~$80</td>
                                    <td class="text-center"><i class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-solid fa-star text-yellow-400"></i></td>
                                </tr>
                                <tr>
                                    <td><strong class="text-purple-400">Matek F405-SE</strong></td>
                                    <td class="mono-font text-xs">STM32F405</td>
                                    <td class="text-emerald-400 font-bold">8g</td>
                                    <td class="text-xs">MPU6000</td>
                                    <td class="text-xs">6×PWM, OSD, BEC 5V/2A</td>
                                    <td class="text-emerald-400">~$40</td>
                                    <td class="text-center"><i class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-solid fa-star text-yellow-400"></i><i
                                            class="fa-regular fa-star text-slate-600"></i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-3 p-3 bg-purple-900/20 border border-purple-500/30 rounded">
                        <div class="text-sm text-purple-300 flex items-start">
                            <i class="fa-solid fa-lightbulb mr-2 mt-1"></i>
                            <span><strong>推薦選擇</strong>：Kakute H7 Mini - 最佳重量/性能比，支援 ArduPilot 4.2+ (建議 4.5+)，內建 OSD 適合
                                FPV
                                整合</span>
                        </div>
                    </div>
                </div>

                <!-- 馬達與螺旋槳 -->
                <div class="mb-6">
                    <h4 class="text-lg font-bold text-sky-300 mb-3 flex items-center">
                        <i class="fa-solid fa-fan mr-2"></i>動力系統 (Propulsion)
                    </h4>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-slate-950 p-4 rounded border border-slate-700">
                            <div class="text-sm font-bold text-sky-400 mb-2 flex items-center">
                                <i class="fa-solid fa-bolt mr-2"></i>馬達規格
                            </div>
                            <div class="space-y-2 text-xs">
                                <div class="flex justify-between">
                                    <span class="text-slate-400">型號</span>
                                    <span class="mono-font text-sky-300">1105 5000KV</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-400">重量</span>
                                    <span class="text-emerald-400 font-bold">4.2g × 4</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-400">最大推力</span>
                                    <span class="text-pink-400">120g/軸</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-400">效率</span>
                                    <span class="text-amber-400">6.5 g/W</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-slate-950 p-4 rounded border border-slate-700">
                            <div class="text-sm font-bold text-purple-400 mb-2 flex items-center">
                                <i class="fa-solid fa-circle-notch mr-2"></i>螺旋槳選擇
                            </div>
                            <div class="space-y-2 text-xs">
                                <div class="flex justify-between">
                                    <span class="text-slate-400">尺寸</span>
                                    <span class="mono-font text-purple-300">3025 (3吋)</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-400">槳距</span>
                                    <span class="text-slate-300">2.5吋</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-400">材質</span>
                                    <span class="text-slate-300">PC (耐撞)</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-400">重量</span>
                                    <span class="text-emerald-400 font-bold">1.8g × 4</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-slate-950 p-4 rounded border border-slate-700">
                            <div class="text-sm font-bold text-amber-400 mb-2 flex items-center">
                                <i class="fa-solid fa-battery-three-quarters mr-2"></i>電池配置
                            </div>
                            <div class="space-y-2 text-xs">
                                <div class="flex justify-between">
                                    <span class="text-slate-400">規格</span>
                                    <span class="mono-font text-amber-300">2S 450mAh 80C</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-400">電壓範圍</span>
                                    <span class="text-slate-300">7.4V ~ 8.4V</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-400">重量</span>
                                    <span class="text-emerald-400 font-bold">28g</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-slate-400">飛行時間</span>
                                    <span class="text-pink-400">~8 分鐘</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 機架設計 -->
                <div>
                    <h4 class="text-lg font-bold text-emerald-300 mb-3 flex items-center">
                        <i class="fa-solid fa-draw-polygon mr-2"></i>機架設計 (Frame Design)
                    </h4>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-slate-950 p-4 rounded border border-slate-700">
                            <div class="text-sm font-bold text-emerald-400 mb-3">結構參數</div>
                        </div>
                    </div>
                </div>

                <!-- NEW: DJI Neo 2 Tech Breakdown -->
                <div class="mt-8 bg-slate-900 border border-slate-700 rounded-lg p-6 relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-5">
                        <i class="fa-solid fa-microchip text-9xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center relative z-10">
                        <i class="fa-solid fa-magnifying-glass-chart mr-2 text-sky-400"></i>
                        技術拆解案例：DJI Neo 2 (Tech Case Study)
                    </h3>
                    <div class="grid md:grid-cols-2 gap-6 relative z-10">
                        <div>
                            <p class="text-sm text-slate-300 mb-4">
                                DJI Neo 2 能夠在 <strong class="text-pink-400">NT$6,290</strong> 的低價位實現 4K/100fps
                                與全向避障，關鍵在於高度整合的 ASIC 策略，而非使用通用樹莓派方案。
                            </p>
                            <div class="space-y-3">
                                <div class="bg-slate-950 p-3 rounded border-l-4 border-sky-500">
                                    <strong class="text-sky-300 text-xs block mb-1">核心處理器 (SoC)</strong>
                                    <div class="text-sm text-white font-bold">DJI ACS2513 (Custom ASIC)</div>
                                    <div class="text-xs text-slate-500">整合 CPU + 圖傳 + 飛控。單晶片成本估計 <$15，功耗 <2W (遠優於樹莓派的
                                            7W)。</div>
                                    </div>
                                    <div class="bg-slate-950 p-3 rounded border-l-4 border-rose-500">
                                        <strong class="text-rose-300 text-xs block mb-1">機構熱設計 (Thermal)</strong>
                                        <div class="text-sm text-white font-bold">分離式 ESC 架構</div>
                                        <div class="text-xs text-slate-500">將發熱的電調 (ESC) 與核心運算板分離，並移除手機 SoC 不必要的
                                            I/O，極致輕量化 (151g)。</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-800/50 p-4 rounded text-xs space-y-2">
                                <h4 class="font-bold text-slate-400 uppercase tracking-wider mb-2">關鍵供應鏈 (Supply Chain)
                                </h4>
                                <div class="flex justify-between border-b border-slate-700 pb-1">
                                    <span class="text-slate-500">IMU / Gyro</span>
                                    <span class="text-emerald-400">InvenSense (TDK)</span>
                                </div>
                                <div class="flex justify-between border-b border-slate-700 pb-1">
                                    <span class="text-slate-500">Camera Sensor</span>
                                    <span class="text-emerald-400">Sony (1/2" CMOS)</span>
                                </div>
                                <div class="flex justify-between border-b border-slate-700 pb-1">
                                    <span class="text-slate-500">Battery</span>
                                    <span class="text-emerald-400">ATL (TDK Group)</span>
                                </div>
                                <div class="flex justify-between border-b border-slate-700 pb-1">
                                    <span class="text-slate-500">Flash Storage</span>
                                    <span class="text-emerald-400">Samsung / Toshiba (49GB)</span>
                                </div>
                                <div class="mt-3 text-slate-500 italic">
                                    * 資料來源：拆解分析報告
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-2 text-xs">
                        <div class="flex justify-between items-center p-2 bg-slate-900 rounded">
                            <span class="text-slate-400">軸距 (Wheelbase)</span>
                            <span class="mono-font text-emerald-300 font-bold">120mm</span>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-slate-900 rounded">
                            <span class="text-slate-400">臂厚 (Arm Thickness)</span>
                            <span class="mono-font text-slate-300">3mm 碳纖維</span>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-slate-900 rounded">
                            <span class="text-slate-400">中板 (Center Plate)</span>
                            <span class="mono-font text-slate-300">1.5mm × 2層</span>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-slate-900 rounded">
                            <span class="text-slate-400">機架重量</span>
                            <span class="text-emerald-400 font-bold">28g</span>
                        </div>
                    </div>
                </div>

                <div class="bg-slate-950 p-4 rounded border border-slate-700">
                    <div class="text-sm font-bold text-sky-400 mb-3">設計考量</div>
                    <ul class="space-y-2 text-xs text-slate-300">
                        <li class="flex items-start">
                            <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                            <span><strong class="text-sky-300">X型佈局</strong>：最佳控制靈敏度</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                            <span><strong class="text-purple-300">低重心設計</strong>：電池置於底部</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                            <span><strong class="text-amber-300">模組化接口</strong>：快拆臂、可換相機座</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                            <span><strong class="text-pink-300">保護設計</strong>：飛控減震墊、槳保護圈</span>
                        </li>
                    </ul>
                </div>
            </div>
            </div>
            </div>

            <!-- 系統架構圖 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-pink-300 mb-4 flex items-center">
                    <i class="fa-solid fa-sitemap mr-2"></i>系統架構 (System Architecture)
                </h3>
                <div class="bg-slate-950 p-6 rounded border border-slate-700">
                    <div class="grid md:grid-cols-3 gap-4 text-xs">
                        <!-- 感知層 -->
                        <div
                            class="bg-gradient-to-br from-emerald-900/20 to-slate-900 p-4 rounded border border-emerald-500/30">
                            <div class="font-bold text-emerald-400 mb-3 flex items-center">
                                <i class="fa-solid fa-eye mr-2"></i>感知層 (Sensing)
                            </div>
                            <div class="space-y-2">
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-emerald-300 font-bold">IMU</div>
                                    <div class="text-slate-400 text-xs">ICM-42688P (6軸)</div>
                                </div>
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-sky-300 font-bold">氣壓計</div>
                                    <div class="text-slate-400 text-xs">機載 MS5611 / 載板可選 DPS310</div>
                                </div>
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-purple-300 font-bold">磁力計</div>
                                    <div class="text-slate-400 text-xs">IST8310 (外接)</div>
                                </div>
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-amber-300 font-bold">光流 (選配)</div>
                                    <div class="text-slate-400 text-xs">PMW3901 + VL53L1X</div>
                                </div>
                            </div>
                        </div>

                        <!-- 控制層 -->
                        <div
                            class="bg-gradient-to-br from-pink-900/20 to-slate-900 p-4 rounded border border-pink-500/30">
                            <div class="font-bold text-pink-400 mb-3 flex items-center">
                                <i class="fa-solid fa-microchip mr-2"></i>控制層 (Control)
                            </div>
                            <div class="space-y-2">
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-pink-300 font-bold">飛控核心</div>
                                    <div class="text-slate-400 text-xs">Kakute H7 Mini</div>
                                </div>
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-sky-300 font-bold">韌體</div>
                                    <div class="text-slate-400 text-xs">ArduCopter 4.5.x</div>
                                </div>
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-purple-300 font-bold">控制演算法</div>
                                    <div class="text-slate-400 text-xs">PID + EKF3 (伴隨電腦可實作 LQR)</div>
                                </div>
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-amber-300 font-bold">飛行模式</div>
                                    <div class="text-slate-400 text-xs">Stabilize/AltHold/Loiter</div>
                                </div>
                            </div>
                        </div>

                        <!-- 執行層 -->
                        <div
                            class="bg-gradient-to-br from-sky-900/20 to-slate-900 p-4 rounded border border-sky-500/30">
                            <div class="font-bold text-sky-400 mb-3 flex items-center">
                                <i class="fa-solid fa-cogs mr-2"></i>執行層 (Actuation)
                            </div>
                            <div class="space-y-2">
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-sky-300 font-bold">ESC</div>
                                    <div class="text-slate-400 text-xs">4-in-1 20A BLHeli_S</div>
                                </div>
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-emerald-300 font-bold">馬達</div>
                                    <div class="text-slate-400 text-xs">1105 5000KV × 4</div>
                                </div>
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-purple-300 font-bold">通訊協定</div>
                                    <div class="text-slate-400 text-xs">DShot600</div>
                                </div>
                                <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                    <div class="text-pink-300 font-bold">遙測</div>
                                    <div class="text-slate-400 text-xs">ExpressLRS 2.4GHz</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 數據流向圖 -->
                    <div class="mt-6 p-4 bg-slate-900 rounded border border-slate-700">
                        <div class="text-sm font-bold text-slate-300 mb-3 text-center">數據流向 (Data Flow)</div>
                        <div class="flex items-center justify-between text-xs">
                            <div class="io-box bg-emerald-900/20 border-emerald-500/50 text-emerald-300">
                                感測器<br>採樣<br><span class="text-xs text-slate-500">典型 1kHz</span>
                            </div>
                            <div class="io-arrow">→</div>
                            <div class="io-box bg-pink-900/20 border-pink-500/50 text-pink-300">
                                姿態<br>估測<br><span class="text-xs text-slate-500">EKF3</span>
                            </div>
                            <div class="io-arrow">→</div>
                            <div class="io-box bg-purple-900/20 border-purple-500/50 text-purple-300">
                                PID<br>控制<br><span class="text-xs text-slate-500">典型 400Hz</span>
                            </div>
                            <div class="io-arrow">→</div>
                            <div class="io-box bg-sky-900/20 border-sky-500/50 text-sky-300">
                                馬達<br>輸出<br><span class="text-xs text-slate-500">DShot</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 性能指標 -->
            <div class="bg-gradient-to-r from-slate-900 to-slate-800 border border-slate-700 rounded-lg p-6">
                <h3 class="text-xl font-bold text-pink-300 mb-4 flex items-center">
                    <i class="fa-solid fa-chart-line mr-2"></i>性能指標 (Performance Metrics)
                </h3>
                <div class="grid md:grid-cols-4 gap-4">
                    <div class="bg-slate-950 p-4 rounded border border-emerald-500/30 text-center">
                        <div class="text-3xl font-bold text-emerald-400 mb-2">245g</div>
                        <div class="text-xs text-slate-400">起飛全重 (MTOW)</div>
                        <div class="text-xs text-emerald-300 mt-1">含電池 + 相機</div>
                    </div>
                    <div class="bg-slate-950 p-4 rounded border border-sky-500/30 text-center">
                        <div class="text-3xl font-bold text-sky-400 mb-2">8 min</div>
                        <div class="text-xs text-slate-400">懸停續航時間</div>
                        <div class="text-xs text-sky-300 mt-1">2S 450mAh</div>
                    </div>
                    <div class="bg-slate-950 p-4 rounded border border-purple-500/30 text-center">
                        <div class="text-3xl font-bold text-purple-400 mb-2">2:1</div>
                        <div class="text-xs text-slate-400">推重比 (T/W Ratio)</div>
                        <div class="text-xs text-purple-300 mt-1">480g 總推力</div>
                    </div>
                    <div class="bg-slate-950 p-4 rounded border border-pink-500/30 text-center">
                        <div class="text-3xl font-bold text-pink-400 mb-2">15 m/s</div>
                        <div class="text-xs text-slate-400">最大飛行速度</div>
                        <div class="text-xs text-pink-300 mt-1">運動模式</div>
                    </div>
                </div>
            </div>
        </section>
        <section id="section-official-docs" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-official-docs"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">Pixhawk 6C 官方技術手冊 (Official Docs)</h2>
                <div class="flex items-center gap-2 text-slate-400 text-sm">
                    <span class="source-badge badge-official">Holybro Docs</span>
                    <span>FMUv6C Open Standard</span>
                </div>
            </header>

            <div class="bg-slate-900 rounded-xl border border-slate-800 overflow-hidden mb-8">
                <div class="flex border-b border-slate-800 bg-slate-950 overflow-x-auto">
                    <button onclick="switchDocsTab('specs')" id="tab-docs-specs"
                        class="px-6 py-4 text-sm font-bold text-indigo-400 bg-slate-900 border-r border-slate-800 transition whitespace-nowrap">規格總覽
                        (Specs)</button>
                    <button onclick="switchDocsTab('ports')" id="tab-docs-ports"
                        class="px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap">接口定義大全
                        (Ports)</button>
                </div>

                <!-- Tab 1: Specs -->
                <div id="content-docs-specs" class="p-6 md:p-8 animate-fade-in">
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-xl font-bold text-white mb-4">處理器與感測器 (Processors & Sensors)</h3>
                            <table class="w-full text-sm specs-table">
                                <tr>
                                    <td class="specs-key">FMU Processor</td>
                                    <td class="specs-val">STM32H743 (Cortex-M7, 480MHz, 2MB Flash, 1MB RAM)</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">IO Processor</td>
                                    <td class="specs-val">STM32F103 (Cortex-M3, 72MHz, 20KB SRAM, 64KB Flash)</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">Accel/Gyro 1</td>
                                    <td class="specs-val text-emerald-400">ICM-42688-P (High Performance)</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">Accel/Gyro 2</td>
                                    <td class="specs-val text-emerald-400">BMI088 (Replaces discontinued BMI055)</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">Magnetometer</td>
                                    <td class="specs-val">IST8310</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">Barometer</td>
                                    <td class="specs-val">MS5611 (或 DPS310，視版本而定)</td>
                                </tr>
                            </table>

                            <h3 class="text-xl font-bold text-white mb-4 mt-8">電氣特性 (Electrical Data)</h3>
                            <table class="w-full text-sm specs-table">
                                <tr>
                                    <td class="specs-key">Max Input</td>
                                    <td class="specs-val text-rose-400">6V</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">USB Power</td>
                                    <td class="specs-val">4.75 ~ 5.25V</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">Servo Rail</td>
                                    <td class="specs-val">0 ~ 36V</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">Telem1 Limit</td>
                                    <td class="specs-val">1.5A (Independent)</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">Other Ports</td>
                                    <td class="specs-val">1.5A (Combined Limit)</td>
                                </tr>
                            </table>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white mb-4">機械數據 (Mechanical)</h3>
                            <table class="w-full text-sm specs-table">
                                <tr>
                                    <td class="specs-key">Dimensions</td>
                                    <td class="specs-val">84.8 x 44 x 12.4 mm</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">Weight</td>
                                    <td class="specs-val">59.3g (Aluminum) / 34.6g (Plastic)</td>
                                </tr>
                                <tr>
                                    <td class="specs-key">Operating Temp</td>
                                    <td class="specs-val">-40 ~ 85°C</td>
                                </tr>
                            </table>

                            <h3 class="text-xl font-bold text-white mb-4 mt-8">主要接口 (Interfaces)</h3>
                            <ul class="list-disc list-inside text-sm text-slate-400 space-y-2 mono-font">
                                <li>16x PWM (8 IO, 8 FMU) w/ 3.3V/5V switch</li>
                                <li>3x General Purpose Serial (Telem 1/2/3)</li>
                                <li>2x GPS Ports (GPS1 Full, GPS2 Basic)</li>
                                <li>2x CAN Buses (CAN FD)</li>
                                <li>1x I2C Port</li>
                                <li>1x Dedicated RC Input (Spektrum/SBUS/PPM)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Tab 2: Ports -->
                <div id="content-docs-ports" class="hidden p-6 md:p-8 animate-fade-in">
                    <div class="bg-amber-900/20 border border-amber-800 p-4 rounded mb-6">
                        <strong class="text-amber-400 block mb-1"><i
                                class="fa-solid fa-triangle-exclamation mr-2"></i>版本差異警告 (Critical Notes)</strong>
                        <ul class="list-disc list-inside text-xs text-slate-300">
                            <li><strong>Telem 3:</strong> 序號為 <code>XXXX 001 XXXXXX</code> 的版本，Pin 4/5 固定連接到 I2C4
                                (3.3V)。不可連接非 I2C 設備。</li>
                            <li><strong>I2C Port:</strong> 序號 <code>XXXX XXX 20221100</code> 及以前的版本，連接的是 I2C4。</li>
                        </ul>
                    </div>

                    <div class="pinout-grid">
                        <!-- Power -->
                        <div class="connector-box">
                            <div class="connector-title"><span>POWER 1 & 2</span> <span
                                    class="text-xs text-slate-500">6-Pin</span></div>
                            <div class="pin-row"><span class="text-rose-400">1</span> <span>VDD_5V (In)</span></div>
                            <div class="pin-row"><span class="text-rose-400">2</span> <span>VDD_5V (In)</span></div>
                            <div class="pin-row"><span class="text-slate-400">3</span> <span>CURRENT (3.3V)</span></div>
                            <div class="pin-row"><span class="text-slate-400">4</span> <span>VOLTAGE (3.3V)</span></div>
                            <div class="pin-row"><span class="text-slate-500">5</span> <span>GND</span></div>
                            <div class="pin-row"><span class="text-slate-500">6</span> <span>GND</span></div>
                        </div>

                        <!-- Telem 1 -->
                        <div class="connector-box">
                            <div class="connector-title"><span>TELEM 1</span> <span
                                    class="text-xs text-slate-500">6-Pin</span></div>
                            <div class="pin-row"><span class="text-rose-400">1</span> <span>VCC_5V</span></div>
                            <div class="pin-row"><span class="text-slate-400">2</span> <span>UART7_TX</span></div>
                            <div class="pin-row"><span class="text-slate-400">3</span> <span>UART7_RX</span></div>
                            <div class="pin-row"><span class="text-slate-400">4</span> <span>UART7_CTS</span></div>
                            <div class="pin-row"><span class="text-slate-400">5</span> <span>UART7_RTS</span></div>
                            <div class="pin-row"><span class="text-slate-500">6</span> <span>GND</span></div>
                        </div>

                        <!-- GPS 1 -->
                        <div class="connector-box">
                            <div class="connector-title"><span>GPS 1</span> <span
                                    class="text-xs text-slate-500">10-Pin</span></div>
                            <div class="pin-row"><span class="text-rose-400">1</span> <span>VCC_5V</span></div>
                            <div class="pin-row"><span class="text-slate-400">2</span> <span>TX1</span></div>
                            <div class="pin-row"><span class="text-slate-400">3</span> <span>RX1</span></div>
                            <div class="pin-row"><span class="text-emerald-400">4</span> <span>SCL1</span></div>
                            <div class="pin-row"><span class="text-emerald-400">5</span> <span>SDA1</span></div>
                            <div class="pin-row"><span class="text-amber-400">6</span> <span>SAFETY_SW</span></div>
                            <div class="pin-row"><span class="text-amber-400">7</span> <span>SAFETY_LED</span></div>
                            <div class="pin-row"><span class="text-slate-400">8</span> <span>VDD_3V3 (Out)</span></div>
                            <div class="pin-row"><span class="text-slate-400">9</span> <span>BUZZER</span></div>
                            <div class="pin-row"><span class="text-slate-500">10</span> <span>GND</span></div>
                        </div>

                        <!-- USB -->
                        <div class="connector-box">
                            <div class="connector-title"><span>USB Port</span> <span
                                    class="text-xs text-slate-500">4-Pin</span></div>
                            <div class="pin-row"><span class="text-rose-400">1</span> <span>VBUS (+5V)</span></div>
                            <div class="pin-row"><span class="text-slate-400">2</span> <span>DM (D-)</span></div>
                            <div class="pin-row"><span class="text-slate-400">3</span> <span>DP (D+)</span></div>
                            <div class="pin-row"><span class="text-slate-500">4</span> <span>GND</span></div>
                        </div>

                        <!-- CAN -->
                        <div class="connector-box">
                            <div class="connector-title"><span>CAN 1 & 2</span> <span
                                    class="text-xs text-slate-500">4-Pin</span></div>
                            <div class="pin-row"><span class="text-rose-400">1</span> <span>VCC_5V</span></div>
                            <div class="pin-row"><span class="text-slate-400">2</span> <span>CAN_H</span></div>
                            <div class="pin-row"><span class="text-slate-400">3</span> <span>CAN_L</span></div>
                            <div class="pin-row"><span class="text-slate-500">4</span> <span>GND</span></div>
                        </div>

                        <!-- I2C -->
                        <div class="connector-box">
                            <div class="connector-title"><span>I2C Port</span> <span
                                    class="text-xs text-slate-500">4-Pin</span></div>
                            <div class="pin-row"><span class="text-rose-400">1</span> <span>VCC_5V</span></div>
                            <div class="pin-row"><span class="text-emerald-400">2</span> <span>SCL (I2C2/4*)</span>
                            </div>
                            <div class="pin-row"><span class="text-emerald-400">3</span> <span>SDA (I2C2/4*)</span>
                            </div>
                            <div class="pin-row"><span class="text-slate-500">4</span> <span>GND</span></div>
                        </div>

                        <!-- RC PPM/SBUS -->
                        <div class="connector-box">
                            <div class="connector-title"><span>RC Port</span> <span
                                    class="text-xs text-slate-500">PPM/SBUS</span></div>
                            <div class="pin-row"><span class="text-rose-400">1</span> <span>VDD_5V</span></div>
                            <div class="pin-row"><span class="text-sky-400">2</span> <span>PPM/SBUS_IN</span></div>
                            <div class="pin-row"><span class="text-slate-400">3</span> <span>RSSI_IN</span></div>
                            <div class="pin-row"><span class="text-slate-400">4</span> <span>VDD_5V (Out)</span></div>
                            <div class="pin-row"><span class="text-slate-500">5</span> <span>GND</span></div>
                        </div>

                        <!-- Debug -->
                        <div class="connector-box">
                            <div class="connector-title"><span>FMU Debug</span> <span
                                    class="text-xs text-slate-500">JST-SH 10-Pin</span></div>
                            <div class="pin-row"><span class="text-rose-400">1</span> <span>VDD_3V3</span></div>
                            <div class="pin-row"><span class="text-slate-400">2</span> <span>UART3_TX</span></div>
                            <div class="pin-row"><span class="text-slate-400">3</span> <span>UART3_RX</span></div>
                            <div class="pin-row"><span class="text-slate-400">4</span> <span>SWD_IO</span></div>
                            <div class="pin-row"><span class="text-slate-400">5</span> <span>SWD_CK</span></div>
                            <div class="pin-row"><span class="text-slate-400">6</span> <span>SWO</span></div>
                            <div class="pin-row"><span class="text-slate-400">7</span> <span>NFC_GPIO</span></div>
                            <div class="pin-row"><span class="text-slate-400">8</span> <span>PH11</span></div>
                            <div class="pin-row"><span class="text-slate-400">9</span> <span>nRST</span></div>
                            <div class="pin-row"><span class="text-slate-500">10</span> <span>GND</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="section-teardown" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-teardown"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">X500 V2 硬體拆解 (Hardware Teardown)</h2>
                <div class="flex items-center gap-2 text-slate-400 text-sm">
                    <span class="source-badge badge-teardown">實機拆解</span>
                    <span>Holybro X500 V2 Kit</span>
                </div>
            </header>
            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                    <h3 class="text-xl font-bold text-emerald-400 mb-4 flex items-center">
                        <i class="fa-solid fa-microchip mr-2"></i>飛控系統 (Updated)
                    </h3>
                    <div class="space-y-3 text-sm text-slate-300">
                        <div class="flex justify-between py-2 border-b border-slate-800">
                            <span class="text-slate-500">飛控:</span>
                            <span class="font-bold">Pixhawk 6C</span>
                        </div>
                        <div class="flex justify-between py-2 border-b border-slate-800">
                            <span class="text-slate-500">MCU:</span>
                            <span class="font-mono text-xs">STM32H743 @ 480MHz</span>
                        </div>
                        <div class="flex justify-between py-2 border-b border-slate-800">
                            <span class="text-slate-500">IMU:</span>
                            <span>ICM-42688-P + BMI088</span>
                        </div>
                        <div class="flex justify-between py-2 border-b border-slate-800">
                            <span class="text-slate-500">Mag:</span>
                            <span>IST8310</span>
                        </div>
                        <div class="flex justify-between py-2">
                            <span class="text-slate-500">Baro:</span>
                            <span>MS5611</span>
                        </div>
                    </div>
                </div>
                <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                    <h3 class="text-xl font-bold text-sky-400 mb-4 flex items-center">
                        <i class="fa-solid fa-bolt mr-2"></i>動力系統
                    </h3>
                    <div class="space-y-3 text-sm text-slate-300">
                        <div class="flex justify-between py-2 border-b border-slate-800">
                            <span class="text-slate-500">馬達:</span>
                            <span class="font-bold">2216 KV880</span>
                        </div>
                        <div class="flex justify-between py-2 border-b border-slate-800">
                            <span class="text-slate-500">ESC:</span>
                            <span>BLHeli_S 20A (DShot)</span>
                        </div>
                        <div class="flex justify-between py-2 border-b border-slate-800">
                            <span class="text-slate-500">螺旋槳:</span>
                            <span>10" 碳纖維</span>
                        </div>
                        <div class="flex justify-between py-2">
                            <span class="text-slate-500">電池:</span>
                            <span>4S 5200mAh LiPo</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                <h3 class="text-lg font-bold text-slate-200 mb-4">
                    <i class="fa-solid fa-weight-hanging mr-2 text-amber-500"></i>重量分析
                </h3>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-slate-900 p-4 rounded border border-slate-700 text-center">
                        <div class="text-2xl font-bold text-emerald-400">1.3 kg</div>
                        <div class="text-xs text-slate-500 mt-1">機架 + 飛控</div>
                    </div>
                    <div class="bg-slate-900 p-4 rounded border border-slate-700 text-center">
                        <div class="text-2xl font-bold text-sky-400">0.6 kg</div>
                        <div class="text-xs text-slate-500 mt-1">動力系統</div>
                    </div>
                    <div class="bg-slate-900 p-4 rounded border border-slate-700 text-center">
                        <div class="text-2xl font-bold text-amber-400">0.58 kg</div>
                        <div class="text-xs text-slate-500 mt-1">電池 (4S 5200mAh)</div>
                    </div>
                </div>
                <div class="mt-4 p-4 bg-slate-800 rounded border-l-4 border-emerald-500">
                    <strong class="text-emerald-400">總重:</strong>
                    <span class="text-slate-300 ml-2">約 2.48 kg (空載)</span>
                    <span class="text-slate-500 text-xs ml-4">| 最大起飛重量: 3.5 kg</span>
                </div>
            </div>

            <!-- NEW: Pixhawk 6C Reverse Engineering Guide -->
            <div class="mt-12 border-t border-slate-800 pt-8">
                <header class="mb-6">
                    <h2
                        class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400 mb-2">
                        <i class="fa-solid fa-toolbox mr-2"></i>Pixhawk 6C 深度拆解與逆向工程 (Reverse Engineering)
                    </h2>
                    <p class="text-slate-400 text-sm">
                        本章節專為硬體與韌體工程師設計，涵蓋 PCB 佈局分析、震動隔離架構解析、以及 DFU/Bootloader 底層操作。
                        <span class="text-rose-400 font-bold ml-2"><i class="fa-solid fa-triangle-exclamation"></i>
                            警告：拆解將導致保固失效。</span>
                    </p>
                </header>

                <!-- 1. Disassembly Guide -->
                <div class="bg-slate-900/50 p-6 rounded-xl border border-slate-700 mb-8">
                    <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                        <i class="fa-solid fa-screwdriver-wrench mr-2 text-sky-400"></i>第一步：外殼拆解 (Disassembly)
                    </h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-slate-950 p-4 rounded border border-slate-800">
                            <h4 class="text-slate-300 font-bold mb-2">塑膠殼版 (Plastic Case)</h4>
                            <ul class="text-xs text-slate-400 space-y-2 list-decimal list-inside">
                                <li>翻轉機身，移除底部 <strong>4 顆 M2.5 Torx 螺絲</strong>。</li>
                                <li>使用塑膠撬片從邊緣輕開卡扣（非全膠合）。</li>
                                <li><strong class="text-rose-400">關鍵：</strong>注意內部排線 (Ribbon Cable)，兩側有矽膠固定，需輕輕拉出。</li>
                                <li>重量：約 34.6g。</li>
                            </ul>
                        </div>
                        <div class="bg-slate-950 p-4 rounded border border-slate-800">
                            <h4 class="text-slate-300 font-bold mb-2">鋁合金版 (Aluminum Case)</h4>
                            <ul class="text-xs text-slate-400 space-y-2 list-decimal list-inside">
                                <li>移除底部及側邊共 <strong>4-6 顆螺絲</strong> (T6/T8)。</li>
                                <li>鋁殼具備較佳散熱與電磁屏蔽屏蔽效果。</li>
                                <li>內部結構更為緊湊，建議使用防靜電手環操作。</li>
                                <li>重量：約 59.3g。</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 2. Hardware Architecture & Schematics -->
                <div class="bg-slate-900/50 p-6 rounded-xl border border-slate-700 mb-8">
                    <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                        <i class="fa-solid fa-code-branch mr-2 text-amber-500"></i>第二步：硬體逆向分析 (PCB & Schematics)
                    </h3>
                    <div class="grid lg:grid-cols-3 gap-6">
                        <!-- Power Tree -->
                        <div class="bg-slate-950 p-4 rounded border-l-4 border-rose-500">
                            <strong class="text-rose-400 text-sm block mb-2">電源架構 (Power Tree)</strong>
                            <ul class="text-xs text-slate-400 space-y-1">
                                <li><strong>Input:</strong> 雙路備援 (Power1/2)，4.9V~5.5V。</li>
                                <li><strong>LDO/Buck:</strong> 5V -> 3.3V 給 FMU/Sensors。</li>
                                <li><strong>Protection:</strong> 過壓/過流保護電路 (E-Fuse/Polyfuse)。</li>
                                <li><strong>Monitoring:</strong> 內建 ADC 電壓/電流感測。</li>
                            </ul>
                        </div>
                        <!-- Component Map -->
                        <div class="bg-slate-950 p-4 rounded border-l-4 border-emerald-500">
                            <strong class="text-emerald-400 text-sm block mb-2">關鍵元件 (Components)</strong>
                            <ul class="text-xs text-slate-400 space-y-1">
                                <li><strong>Core:</strong> STM32H743VIT6 (LQFP-100)。</li>
                                <li><strong>IMU 1:</strong> ICM-42688-P (High Rate)。</li>
                                <li><strong>IMU 2:</strong> BMI088 (Vibration Robust)。</li>
                                <li><strong>IO:</strong> STM32F103 (Failsafe)。</li>
                            </ul>
                        </div>
                        <!-- Reverse Tips -->
                        <div class="bg-slate-950 p-4 rounded border-l-4 border-purple-500">
                            <strong class="text-purple-400 text-sm block mb-2">逆向技巧 (Tips)</strong>
                            <p class="text-xs text-slate-400">
                                建議下載 Holybro 官方提供的 <a href="#" class="text-sky-400 hover:underline">Baseboard Reference
                                    Schematic</a>
                                作為底圖，配合萬用電表追蹤 I2C 上拉電阻與 UART 走線。
                            </p>
                        </div>
                    </div>
                </div>

                <!-- 3. Vibration Isolation -->
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-slate-900/50 p-6 rounded-xl border border-slate-700">
                        <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                            <i class="fa-solid fa-wave-square mr-2 text-sky-400"></i>震動隔離系統 (Vibration Isolation)
                        </h3>
                        <p class="text-sm text-slate-400 mb-4">
                            Pixhawk 6C 採用<strong>整合式懸吊設計</strong>，而非傳統的外部減震球。
                        </p>
                        <ul class="text-xs text-slate-300 space-y-3">
                            <li class="flex items-start">
                                <i class="fa-solid fa-layer-group mt-1 mr-2 text-sky-500"></i>
                                <span><strong>結構原理：</strong>IMU 模組獨立於主 PCB，透過客製矽膠 (Sorbothane-like) 懸吊，專門過濾 >100Hz
                                    的高頻馬達震動。</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-temperature-arrow-up mt-1 mr-2 text-rose-500"></i>
                                <span><strong>恆溫控制：</strong>內建加熱電阻，確保矽膠在 -40~85°C 保持彈性特性，並防止 IMU 溫漂。</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check-circle mt-1 mr-2 text-emerald-500"></i>
                                <span><strong>效能指標：</strong>震動抑制能力優於外加 O-ring，雜訊 < 0.01g RMS。</span>
                            </li>
                        </ul>
                    </div>

                    <!-- 4. PWM vs DShot -->
                    <div class="bg-slate-900/50 p-6 rounded-xl border border-slate-700">
                        <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                            <i class="fa-solid fa-sliders mr-2 text-pink-400"></i>PWM 與 DShot 配置
                        </h3>
                        <div class="space-y-4">
                            <div class="bg-slate-950 p-3 rounded border border-slate-800">
                                <strong class="text-emerald-400 text-xs block mb-1">硬體電壓設定 (Voltage Logic)</strong>
                                <p class="text-xs text-slate-400">
                                    預設 IO/FMU PWM 輸出為 <strong>3.3V</strong>。若需驅動 5V 伺服，需拆殼短接 PCB 上的 <strong>3V3/5V
                                        Pad</strong> (JP1)。
                                </p>
                            </div>
                            <div class="bg-slate-950 p-3 rounded border border-slate-800">
                                <strong class="text-sky-400 text-xs block mb-1">Firmware Setup (DShot)</strong>
                                <ul class="text-xs text-slate-400 list-disc list-inside">
                                    <li><strong>PX4:</strong> 設 <code>PWM_OUT_MODE=3</code> (DShot150/300/600)。建議使用 FMU
                                        (AUX) 埠。</li>
                                    <li><strong>ArduPilot:</strong> 設 <code>MOT_PWM_TYPE=5</code> (DShot150)。支援全部 16
                                        路輸出。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 5. DFU Mode -->
                <div class="bg-slate-800 p-4 rounded-lg border-l-4 border-amber-500">
                    <h3 class="text-sm font-bold text-amber-400 mb-2">
                        <i class="fa-solid fa-key mr-2"></i>進入 DFU 模式 (Recover Bricked Device)
                    </h3>
                    <p class="text-xs text-slate-300 leading-relaxed">
                        Pixhawk 6C 無實體 Boot 按鈕。若需刷寫 Bootloader 或救磚，需拆殼後找到 <strong>R10 / C36</strong> 附近的 Pad，
                        在通電時將 <strong>BOOT0 拉高至 3.3V</strong> (或短接特定測試點)，即可進入 DFU 模式使用 STM32CubeProgrammer 救援。
                    </p>
                </div>
            </div>
        </section>
        <section id="section-mcu" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-mcu"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">STM32 晶片架構詳解 (MCU Deep Dive)</h2>
                <div class="flex items-center gap-2 text-slate-400 text-sm">
                    <span class="source-badge badge-datasheet">Datasheet</span>
                    <span>STM32H753 / H743 / F103</span>
                </div>
            </header>

            <div class="grid lg:grid-cols-2 gap-8 mb-8">
                <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                        <i class="fa-solid fa-brain mr-2 text-purple-500"></i>
                        主飛控核心 (FMU): H7 系列
                    </h3>
                    <div class="space-y-6">
                        <div class="bg-slate-900 p-4 rounded-lg border border-slate-700">
                            <div class="grid grid-cols-2 gap-4 border-b border-slate-800 pb-2 mb-2">
                                <div>
                                    <h4 class="text-emerald-400 font-bold">STM32H753</h4>
                                    <span class="text-xs text-slate-500">Pixhawk 6X (企業級)</span>
                                </div>
                                <div>
                                    <h4 class="text-sky-400 font-bold">STM32H743</h4>
                                    <span class="text-xs text-slate-500">Pixhawk 6C (標準級)</span>
                                </div>
                            </div>
                            <ul class="text-sm text-slate-300 space-y-2 list-disc list-inside">
                                <li><strong>運算核心:</strong> Cortex-M7 @ 480MHz (演算法主算力)。</li>
                                <li><strong>AXI Bus Matrix:</strong> 確保 RAM 與週邊 (Ethernet/SDMMC) 的併發存取不塞車。</li>
                                <li><strong>差異點 (Security):</strong> <br>
                                    <span class="text-emerald-400">H753</span> 獨有硬體加密引擎 (Crypto/Hash),支援高強度 Secure Boot
                                    防篡改。
                                </li>
                            </ul>
                        </div>
                        <div class="bg-slate-800 p-3 rounded text-xs text-slate-400 border-l-4 border-purple-500">
                            <strong>DMA 架構重點:</strong>H7 具備 MDMA (Master DMA),可在不佔用 CPU 情況下,自主搬運大量感測器 SPI 數據到 RAM,這是高頻率
                            (8kHz Loop) 運作的關鍵。
                        </div>
                    </div>
                </div>

                <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                    <h3 class="text-xl font-bold text-white mb-4 flex items-center">
                        <i class="fa-solid fa-shield-halved mr-2 text-rose-500"></i>
                        IO 協處理器 (STM32F103)
                    </h3>
                    <div class="bg-slate-900 p-4 rounded-lg border border-slate-700 h-full">
                        <div class="mb-4 pb-2 border-b border-slate-800">
                            <h4 class="text-rose-400 font-bold">PX4IO 架構 (Safety Island)</h4>
                            <span class="text-xs text-slate-500">目的:當主核 (H7) 當機時,確保飛機仍受控制。</span>
                        </div>
                        <div class="io-flow-container mb-6 bg-slate-900 p-2 rounded border border-slate-800">
                            <div class="io-box border-emerald-900 text-emerald-400">RC Input<br><span
                                    class="text-[10px] text-slate-500">SBUS/PPM</span></div>
                            <i class="fa-solid fa-arrow-right io-arrow"></i>
                            <div class="io-box border-rose-900 text-rose-400">F103 IO<br><span
                                    class="text-[10px] text-slate-500">Mixing/Mux</span></div>
                            <i class="fa-solid fa-arrow-right io-arrow"></i>
                            <div class="io-box border-sky-900 text-sky-400">Main Out<br><span
                                    class="text-[10px] text-slate-500">PWM 1-8</span></div>
                        </div>
                        <div class="space-y-4 text-sm text-slate-300">
                            <div>
                                <strong class="text-white block mb-1">關鍵功能:</strong>
                                <ul class="list-none space-y-3 mt-2">
                                    <li class="relative pl-4 border-l-2 border-emerald-500">
                                        <strong class="text-emerald-300 text-xs uppercase block">1. RC Decoding</strong>
                                        負責繁重的中斷解碼,減輕 H7 負擔。
                                    </li>
                                    <li class="relative pl-4 border-l-2 border-rose-500">
                                        <strong class="text-rose-300 text-xs uppercase block">2. Failsafe Mux</strong>
                                        若 H7 心跳停止,IO 自動切換 RC 直通模式 (Manual Override)。
                                    </li>
                                    <li class="relative pl-4 border-l-2 border-amber-500">
                                        <strong class="text-amber-300 text-xs uppercase block">3. FMU Link
                                            (1.5Mbps)</strong>
                                        專用二進制協議,CRC 校驗,500ms Watchdog 機制。
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NEW: F103 Firmware & Bootloader Deep Dive -->
                <div class="col-span-1 lg:col-span-2 bg-slate-900/50 p-6 rounded-xl border border-slate-700 mt-0">
                    <h3 class="text-xl font-bold text-white mb-6 flex items-center border-b border-slate-700 pb-3">
                        <i class="fa-solid fa-microchip mr-2 text-amber-500"></i>
                        韌體更新與 Bootloader 架構 (Firmware & Bootloader)
                    </h3>

                    <div class="grid lg:grid-cols-2 gap-8">
                        <!-- Left: How to Update -->
                        <div>
                            <h4 class="text-lg font-bold text-sky-400 mb-4">如何更新 F103 的韌體 (FW)？</h4>
                            <div class="space-y-4">
                                <div class="bg-slate-900 p-4 rounded border-l-4 border-emerald-500">
                                    <strong class="text-emerald-400 block mb-1">情境 A：一般開發更新 (最常用)</strong>
                                    <p class="text-sm text-slate-400">
                                        在正常運作下，<span class="text-white">不需要手動更新</span>。
                                        當更新 H743 主韌體 (<code>make px4_fmu-v6c_default upload</code>) 時，編譯系統會自動打包 IO 韌體
                                        (<code>px4_io-v2_default.bin</code>)。
                                        <br><br>
                                        <i class="fa-solid fa-robot mr-1"></i> <strong>自動檢查機制：</strong> 開機時，H743 會檢查
                                        F103 版本。若不一致，會自動透過內部匯流排「推」送新韌體給 F103。
                                    </p>
                                </div>

                                <div class="bg-slate-900 p-4 rounded border-l-4 border-sky-500">
                                    <strong class="text-sky-400 block mb-1">情境 B：終端機手動強制更新</strong>
                                    <p class="text-sm text-slate-400 md:whitespace-nowrap">
                                        若修改了 IO 程式碼想立刻測試，可在 NSH 終端機輸入：
                                    </p>
                                    <code
                                        class="block bg-black px-2 py-1 mt-2 text-emerald-400 mono-font text-xs rounded">px4io update</code>
                                    <p class="text-xs text-slate-500 mt-2">這會觸發主處理器讀取內建 .bin 並刷寫 IO。</p>
                                </div>

                                <div class="bg-slate-900 p-4 rounded border-l-4 border-rose-500">
                                    <strong class="text-rose-400 block mb-1">情境 C：自製板子 (晶片完全空白)</strong>
                                    <p class="text-sm text-slate-400">
                                        若 F103 是空的，無法與 H743 溝通。必須走硬體流程：
                                    </p>
                                    <ul class="list-disc list-inside mt-2 text-xs text-slate-400 space-y-1">
                                        <li><strong>1. 燒錄 Bootloader:</strong>
                                            <div
                                                class="ml-4 mt-1 mb-2 bg-black p-2 rounded border border-slate-800 font-mono text-emerald-500">
                                                # 方法一：STM32CubeProgrammer CLI<br>
                                                STM32_Programmer_CLI -c port=SWD -d px4_io-v2_bootloader.bin 0x08000000
                                                -rst
                                            </div>
                                            <div
                                                class="ml-4 bg-black p-2 rounded border border-slate-800 font-mono text-emerald-500">
                                                # 方法二：OpenOCD<br>
                                                openocd -f interface/stlink-v2.cfg -f target/stm32f1x.cfg -c "program
                                                px4_io-v2_bootloader.elf verify reset exit"
                                            </div>
                                        </li>
                                        <li><strong>2. 後續更新:</strong> 之後即可依「情境 A」由 H743 自動代管。</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Right: Bootloader Comparison -->
                        <div>
                            <h4 class="text-lg font-bold text-amber-400 mb-4">Bootloader 深度對比 & H743 救磚</h4>

                            <!-- H743 Flashing Guide Tab -->
                            <div class="mb-6 bg-slate-800 p-4 rounded border border-slate-700">
                                <h5 class="text-sm font-bold text-purple-400 mb-2 flex items-center">
                                    <i class="fa-solid fa-wrench mr-2"></i>H743 (FMU) 強制燒錄指南
                                </h5>
                                <div class="text-xs text-slate-400 space-y-2">
                                    <p>若 H743 變磚 (無 USB 反應)，需進入 <strong>DFU 模式</strong>：</p>
                                    <ol class="list-decimal list-inside space-y-1">
                                        <li>將 <code class="text-white">BOOT0</code> 引腳拉高至 3.3V (或按住 BOOT 鍵上電)。</li>
                                        <li>連接 USB，電腦應識別為 <code class="text-white">STM32 BOOTLOADER</code>。</li>
                                        <li>執行燒錄指令：</li>
                                    </ol>
                                    <div
                                        class="bg-black p-2 rounded border border-slate-800 font-mono text-purple-300 mt-1">
                                        dfu-util -a 0 -s 0x08000000:leave -D px4_fmu-v6c_bootloader.bin
                                    </div>
                                </div>
                            </div>

                            <p class="text-sm text-slate-400 mb-2">
                                H743 (FMU) 與 F103 (IO) 架構對比：
                            </p>

                            <div class="overflow-x-auto">
                                <table class="w-full text-left border-collapse text-xs">
                                    <thead class="bg-slate-950 text-slate-300">
                                        <tr>
                                            <th class="p-2 border-b border-slate-700">維度</th>
                                            <th class="p-2 border-b border-slate-700 text-sky-400">FMU Bootloader (H743)
                                            </th>
                                            <th class="p-2 border-b border-slate-700 text-rose-400">IO Bootloader (F103)
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="text-slate-400 divide-y divide-slate-800 bg-slate-900">
                                        <tr>
                                            <td class="p-2 font-bold text-slate-300">1. 硬體架構</td>
                                            <td class="p-2">Arm Cortex-M7<br><span
                                                    class="text-[10px] text-slate-500">指令集不同，二進位不相容</span></td>
                                            <td class="p-2">Arm Cortex-M3<br><span
                                                    class="text-[10px] text-slate-500">需獨立編譯</span></td>
                                        </tr>
                                        <tr>
                                            <td class="p-2 font-bold text-slate-300">2. 功能職責</td>
                                            <td class="p-2">
                                                <ul class="list-disc list-inside space-y-1">
                                                    <li><strong>面對 PC (USB):</strong> 讓 QGC 刷寫 PX4 App</li>
                                                    <li><strong>位址:</strong> 0x08000000</li>
                                                </ul>
                                            </td>
                                            <td class="p-2">
                                                <ul class="list-disc list-inside space-y-1">
                                                    <li><strong>面對 FMU (UART):</strong> 等待 H7 傳送韌體</li>
                                                    <li><strong>故障保護:</strong> 負責 PWM Failsafe</li>
                                                </ul>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="p-2 font-bold text-slate-300">3. 編譯來源</td>
                                            <td class="p-2">
                                                <code>make px4_fmu-v6c_bootloader</code>
                                                <div class="text-[10px] text-slate-500 mt-1">PX4-Autopilot (in-tree)
                                                </div>
                                            </td>
                                            <td class="p-2">
                                                <code>make px4_io-v2_bootloader</code>
                                                <div class="text-[10px] text-slate-500 mt-1">PX4-Bootloader (獨立 repo)
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="mt-4 bg-amber-900/10 border border-amber-800 p-3 rounded">
                                <strong class="text-amber-400 text-xs block mb-1"><i
                                        class="fa-solid fa-triangle-exclamation mr-1"></i> 自製板子設計警告</strong>
                                <p class="text-xs text-slate-400">
                                    務必確保 H743 與 F103 都有預留<strong>獨立的 SWD 測試點</strong> (DIO, CLK, GND, 3.3V)。若 Bootloader
                                    損毀，SWD 是唯一的救磚管道。
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Integration Summary -->
                    <div class="mt-6 pt-4 border-t border-slate-700">
                        <h4 class="text-sm font-bold text-slate-300 mb-2">總結佈署架構 (The Full Chain)</h4>
                        <div
                            class="bg-black/30 p-3 rounded flex flex-col md:flex-row items-center justify-between text-xs text-center gap-2">
                            <div class="flex-1">
                                <div class="text-purple-400 font-bold mb-1">RSPI5 (大腦)</div>
                                <div class="text-slate-500">Python/AI <br> (MAVLink over UART)</div>
                            </div>
                            <div class="text-slate-600"><i class="fa-solid fa-arrow-right"></i></div>
                            <div class="flex-1">
                                <div class="text-sky-400 font-bold mb-1">H743 (小腦/FMU)</div>
                                <div class="text-slate-500">PX4 Core <br> (Internal Bus)</div>
                            </div>
                            <div class="text-slate-600"><i class="fa-solid fa-arrow-right"></i></div>
                            <div class="flex-1">
                                <div class="text-rose-400 font-bold mb-1">F103 (執行端/IO)</div>
                                <div class="text-slate-500">PWM/DShot <br> (Motor Control)</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="section-hardware" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-hardware"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">硬體解剖學 (Hardware Anatomy)</h2>
                <div class="flex items-center gap-2 text-slate-400 text-sm">
                    <span class="source-badge badge-teardown">硬體模組架構</span>
                </div>
            </header>
            <div class="grid md:grid-cols-4 gap-4" id="anatomy-grid"></div>
            <div id="anatomy-detail"
                class="mt-6 bg-slate-800/50 border border-slate-700 p-6 rounded-xl shadow-lg hidden">
                <h3 id="detail-title" class="text-xl font-bold text-sky-400 mb-2"></h3>
                <p id="detail-desc" class="text-slate-300 mb-4"></p>
                <div class="bg-slate-900 p-4 rounded border border-slate-800">
                    <h4 class="text-xs text-slate-500 uppercase font-bold mb-2">技術規格 (Technical Specs)</h4>
                    <ul class="space-y-2 text-sm text-emerald-400 mono-font" id="detail-specs"></ul>
                </div>
            </div>
        </section>
        <section id="section-pixhawk" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-pixhawk"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">Pixhawk 6X/6C 接口定義 (Pinouts)</h2>
                <div class="flex items-center gap-2 text-slate-400 text-sm">
                    <span class="source-badge badge-standard">DS-012/018</span>
                    <span>規格已驗證</span>
                </div>
            </header>

            <div class="grid lg:grid-cols-3 gap-6">
                <div class="lg:col-span-2 bg-slate-900 p-6 rounded-xl border border-slate-800">
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <div class="port-connector bg-slate-900/50 p-3 rounded text-center" data-port="power">
                            <div class="port-label text-rose-400">POWER 1/2</div>
                            <i class="fa-solid fa-battery-full text-xl text-rose-500 my-2"></i>
                        </div>
                        <div class="port-connector bg-slate-900/50 p-3 rounded text-center" data-port="gps">
                            <div class="port-label text-emerald-400">GPS 1/2</div>
                            <i class="fa-solid fa-satellite text-xl text-emerald-500 my-2"></i>
                        </div>
                        <div class="port-connector bg-slate-900/50 p-3 rounded text-center" data-port="telem">
                            <div class="port-label text-sky-400">TELEM 1-3</div>
                            <i class="fa-solid fa-wifi text-xl text-sky-500 my-2"></i>
                        </div>
                        <div class="port-connector bg-slate-900/50 p-3 rounded text-center" data-port="fmu_pwm">
                            <div class="port-label text-amber-400">FMU PWM</div>
                            <i class="fa-solid fa-fan text-xl text-amber-500 my-2"></i>
                        </div>
                        <div class="port-connector bg-slate-900/50 p-3 rounded text-center" data-port="io_pwm">
                            <div class="port-label text-slate-300">IO PWM</div>
                            <i class="fa-solid fa-gears text-xl text-slate-400 my-2"></i>
                        </div>
                        <div class="port-connector bg-slate-900/50 p-3 rounded text-center" data-port="can">
                            <div class="port-label text-indigo-400">CAN 1/2</div>
                            <i class="fa-solid fa-network-wired text-xl text-indigo-500 my-2"></i>
                        </div>
                    </div>
                </div>
                <div class="lg:col-span-1">
                    <div id="port-detail-panel"
                        class="bg-slate-900 border border-slate-700 h-full rounded-xl p-6 shadow-lg animate-fade-in flex flex-col">
                        <div class="flex items-center mb-4 pb-4 border-b border-slate-800">
                            <div id="port-icon" class="text-2xl mr-3"></div>
                            <div>
                                <h4 id="port-title" class="text-xl font-bold text-white">請選擇接口</h4>
                            </div>
                        </div>
                        <div id="port-content" class="text-sm text-slate-400 flex-1 overflow-y-auto">
                            <p class="italic opacity-70">點擊左側圖表查看電流限制與邏輯電平。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="section-design" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-design"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">自製載板指南 (Hardware Design Guide)</h2>
                <div class="flex items-center gap-2 text-slate-400 text-sm">
                    <span class="source-badge badge-design">Reference Design</span>
                    <span>相容 FMUv6C 標準</span>
                </div>
            </header>
            <div class="bg-amber-900/10 border border-amber-800 p-4 rounded-lg mb-8 flex items-start">
                <i class="fa-solid fa-circle-exclamation text-amber-500 mt-1 mr-3"></i>
                <div class="text-sm text-slate-300">
                    <strong class="text-amber-400 block mb-1">關於 Pixhawk 6C 原理圖</strong>
                    <p>官方並未公開 6C 原理圖 (SCH)。建議採用 <strong>FMUv6C 標準 + 開源設計 (如 Pix32 v6)</strong> 的策略。下方提供實作導向的模組拆解與完整 H743
                        Pin Mapping。</p>
                </div>
            </div>

            <!-- Tab Navigation for Design -->
            <div class="bg-slate-900 rounded-xl border border-slate-800 overflow-hidden mb-8">
                <div class="flex border-b border-slate-800 bg-slate-950 overflow-x-auto">
                    <button onclick="showDesignTab('modules')" id="tab-design-modules"
                        class="px-6 py-4 text-sm font-bold text-pink-400 bg-slate-900 border-r border-slate-800 transition whitespace-nowrap">模組拆解清單</button>
                    <button onclick="showDesignTab('pinout')" id="tab-design-pinout"
                        class="px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap">All
                        Pin Define (Searchable)</button>
                </div>

                <!-- Content: Modules -->
                <div id="content-design-modules" class="p-6 md:p-8 animate-fade-in">
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-sky-400 font-bold mb-3 border-b border-sky-900 pb-2">1. 核心與 IO (Core)</h4>
                            <ul class="space-y-3 text-sm text-slate-400">
                                <li><strong class="text-white">FMU:</strong> STM32H743ZIT6 (LQFP144)。外掛 QSPI Flash
                                    (儲存)、FRAM (參數)。</li>
                                <li><strong class="text-white">IO MCU:</strong> STM32F103C8T6。負責 PWM 輸出與 RC 解碼。</li>
                            </ul>
                            <h4 class="text-emerald-400 font-bold mb-3 mt-6 border-b border-emerald-900 pb-2">2. 感測器
                                (Sensors)</h4>
                            <ul class="space-y-3 text-sm text-slate-400">
                                <li><strong class="text-white">IMU 1 (SPI):</strong> ICM-42688-P (High Performance).
                                </li>
                                <li><strong class="text-white">IMU 2 (SPI):</strong> BMI088 (Robustness).</li>
                                <li><strong class="text-white">Mag (I2C):</strong> IST8310.</li>
                                <li><strong class="text-white">Baro (I2C):</strong> MS5611.</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="text-rose-400 font-bold mb-3 border-b border-rose-900 pb-2">3. 電源架構 (Power)</h4>
                            <ul class="space-y-3 text-sm text-slate-400">
                                <li><strong class="text-white">輸入冗餘:</strong> POWER1 / POWER2 / USB 三路輸入 (Ideal Diode
                                    OR-ing)。</li>
                                <li><strong class="text-white">電壓軌:</strong> 5V (主供電), 3.3V_FMU, 3.3V_SENSORS (分開 LDO
                                    減少雜訊)。</li>
                            </ul>
                            <h4 class="text-amber-400 font-bold mb-3 mt-6 border-b border-amber-900 pb-2">4. 通訊與接口
                                (Comms)</h4>
                            <ul class="space-y-3 text-sm text-slate-400">
                                <li><strong class="text-white">Connectors:</strong> JST-GH 1.25mm (Pixhawk 標準)。</li>
                                <li><strong class="text-white">CAN:</strong> 2x CAN-FD (需外掛 Transceiver)。</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Content: Pinout (Full List) -->
                <div id="content-design-pinout" class="hidden p-6 md:p-8 animate-fade-in flex flex-col h-[600px]">
                    <div class="mb-4">
                        <input type="text" id="pinout-search" placeholder="搜尋腳位定義 (例如: PA9, UART, FMU...)"
                            class="w-full bg-slate-800 border border-slate-700 rounded px-4 py-2 text-sm text-slate-200 focus:outline-none focus:border-sky-500 transition">
                    </div>
                    <div class="flex-1 overflow-y-auto border border-slate-700 rounded-lg">
                        <table class="w-full text-left border-collapse text-sm" id="pinout-table">
                            <thead class="bg-slate-950 text-slate-300 sticky top-0 z-10">
                                <tr>
                                    <th class="p-3 border-b border-slate-700 font-bold w-1/4">STM32 Pin</th>
                                    <th class="p-3 border-b border-slate-700 w-1/3">STM32 Signal</th>
                                    <th class="p-3 border-b border-slate-700">FMU Usage</th>
                                </tr>
                            </thead>
                            <tbody class="text-slate-400 font-mono divide-y divide-slate-800 bg-slate-900">
                                <!-- Generated by JS -->
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-2 text-xs text-slate-500 text-right">Source: FMUv6C_stm32_pinout_v1.pdf</div>
                </div>
            </div>
        </section>
        <section id="section-bldc" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-bldc"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">FOC 馬達控制 (BLDC Lab)</h2>
            </header>

            <div class="bg-slate-950 p-6 rounded-xl border border-slate-800 shadow-inner mb-8 overflow-x-auto">
                <h3 class="text-sm font-bold text-slate-500 uppercase tracking-wider mb-4">逆變器拓撲 (Inverter Topology)
                </h3>
                <div class="flex flex-col md:flex-row gap-4 items-stretch min-w-[700px]">
                    <div class="topo-box flex-1 bg-slate-900 rounded-lg p-4 cursor-pointer hover:border-sky-500 transition"
                        onclick="showBldcDetail('mcu')">
                        <div class="text-center mt-2">
                            <i class="fa-solid fa-microchip text-3xl text-sky-500 mb-2"></i>
                            <h4 class="font-bold text-slate-200">STM32 G4</h4>
                        </div>
                    </div>
                    <div class="flex items-center justify-center text-slate-600">
                        <i class="fa-solid fa-arrow-right-long text-xl"></i>
                    </div>
                    <div class="topo-box flex-1 bg-slate-900 rounded-lg p-4 cursor-pointer hover:border-amber-500 transition"
                        onclick="showBldcDetail('driver')">
                        <div class="text-center mt-2">
                            <i class="fa-solid fa-charging-station text-3xl text-amber-500 mb-2"></i>
                            <h4 class="font-bold text-slate-200">Gate Driver</h4>
                        </div>
                    </div>
                    <div class="flex items-center justify-center text-slate-600">
                        <i class="fa-solid fa-arrow-right-long text-xl"></i>
                    </div>
                    <div class="topo-box flex-1 bg-slate-900 rounded-lg p-4 cursor-pointer hover:border-rose-500 transition"
                        onclick="showBldcDetail('mosfet')">
                        <div class="text-center mt-2">
                            <i class="fa-solid fa-bolt text-3xl text-rose-500 mb-2"></i>
                            <h4 class="font-bold text-slate-200">MOSFETs</h4>
                        </div>
                    </div>
                </div>
            </div>

            <div id="bldc-detail-box" class="bg-slate-800 border border-slate-700 p-6 rounded-xl shadow-lg mb-8 hidden">
                <div class="flex items-start">
                    <div class="mr-4 text-3xl" id="bldc-icon"></div>
                    <div class="flex-1">
                        <h3 class="text-xl font-bold text-slate-100 mb-2" id="bldc-title"></h3>
                        <p class="text-slate-300 mb-4 text-sm" id="bldc-desc"></p>
                        <div class="bg-slate-950 p-4 rounded border border-slate-800">
                            <h4 class="text-xs text-sky-500 font-bold uppercase mb-3">選型公式</h4>
                            <ul class="text-sm text-slate-400 mono-font space-y-3" id="bldc-specs"></ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                <h3 class="text-lg font-bold text-slate-200 mb-6 flex items-center">
                    <i class="fa-solid fa-wave-square mr-2 text-emerald-500"></i>FOC 控制流程 (Control Loop)
                </h3>
                <div class="grid md:grid-cols-4 gap-4 text-center">
                    <div class="foc-step bg-slate-800 p-4 rounded border border-slate-700">
                        <h4 class="font-bold text-emerald-400 text-sm">1. ADC 採樣</h4>
                        <p class="text-xs text-slate-400 mt-2">讀取相電流 Ia, Ib</p>
                    </div>
                    <div class="foc-step bg-slate-800 p-4 rounded border border-slate-700">
                        <h4 class="font-bold text-emerald-400 text-sm">2. 座標變換</h4>
                        <p class="text-xs text-slate-400 mt-2">Clarke / Park (abc轉dq)</p>
                    </div>
                    <div class="foc-step bg-slate-800 p-4 rounded border border-slate-700">
                        <h4 class="font-bold text-emerald-400 text-sm">3. PID 控制</h4>
                        <p class="text-xs text-slate-400 mt-2">電流環/速度環計算</p>
                    </div>
                    <div class="foc-step bg-slate-800 p-4 rounded border border-slate-700">
                        <h4 class="font-bold text-emerald-400 text-sm">4. SVPWM</h4>
                        <p class="text-xs text-slate-400 mt-2">空間向量調變輸出</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================================
     Part 3: ArduPilot vs PX4 軟體棧深度對比章節
     插入位置: Part 1 的 <main> 區塊內，Part 2 之後
     ============================================================ -->

        <section id="section-software" class="mb-16 hidden animate-fade-in">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-3xl font-bold text-slate-300 flex items-center">
                    <i class="fa-brands fa-git-alt mr-3"></i>軟體棧深度對比 (ArduPilot vs PX4)
                </h2>
                <span class="bookmark-badge" data-section="section-software"><i
                        class="fa-regular fa-bookmark"></i></span>
            </div>

            <!-- 核心差異總覽 -->
            <div
                class="bg-gradient-to-r from-blue-900/20 to-purple-900/20 border border-blue-500/30 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-blue-300 mb-4 flex items-center">
                    <i class="fa-solid fa-code-compare mr-2"></i>核心差異總覽 (Key Differences)
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-slate-900 p-5 rounded border-l-4 border-orange-500">
                        <div class="flex items-center mb-3">
                            <img src="https://ardupilot.org/application/files/3415/7466/2141/ArduPilot-Motto.png"
                                alt="ArduPilot" class="h-8 mr-3 opacity-80">
                            <span class="text-xl font-bold text-orange-400">ArduPilot</span>
                        </div>
                        <div class="space-y-3 text-sm">
                            <div class="flex items-start">
                                <i class="fa-solid fa-calendar text-orange-400 mr-2 mt-1"></i>
                                <div>
                                    <div class="font-bold text-slate-300">成立時間</div>
                                    <div class="text-slate-400">2009年 (15年歷史)</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i class="fa-solid fa-code text-orange-400 mr-2 mt-1"></i>
                                <div>
                                    <div class="font-bold text-slate-300">程式語言</div>
                                    <div class="text-slate-400 mono-font">C++ (單體架構)</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i class="fa-solid fa-users text-orange-400 mr-2 mt-1"></i>
                                <div>
                                    <div class="font-bold text-slate-300">社群特性</div>
                                    <div class="text-slate-400">DIY友好、文檔豐富、論壇活躍</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i class="fa-solid fa-rocket text-orange-400 mr-2 mt-1"></i>
                                <div>
                                    <div class="font-bold text-slate-300">最佳應用</div>
                                    <div class="text-slate-400">長航時任務、農業植保、測繪</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-900 p-5 rounded border-l-4 border-sky-500">
                        <div class="flex items-center mb-3">
                            <img src="https://px4.io/wp-content/uploads/2020/06/PX4-logo.svg" alt="PX4"
                                class="h-8 mr-3 opacity-80">
                            <span class="text-xl font-bold text-sky-400">PX4 Autopilot</span>
                        </div>
                        <div class="space-y-3 text-sm">
                            <div class="flex items-start">
                                <i class="fa-solid fa-calendar text-sky-400 mr-2 mt-1"></i>
                                <div>
                                    <div class="font-bold text-slate-300">成立時間</div>
                                    <div class="text-slate-400">2011年 (ETH Zurich)</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i class="fa-solid fa-code text-sky-400 mr-2 mt-1"></i>
                                <div>
                                    <div class="font-bold text-slate-300">程式語言</div>
                                    <div class="text-slate-400 mono-font">C++ (NuttX RTOS + uORB)</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i class="fa-solid fa-users text-sky-400 mr-2 mt-1"></i>
                                <div>
                                    <div class="font-bold text-slate-300">社群特性</div>
                                    <div class="text-slate-400">學術導向、模組化、ROS2整合</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i class="fa-solid fa-rocket text-sky-400 mr-2 mt-1"></i>
                                <div>
                                    <div class="font-bold text-slate-300">最佳應用</div>
                                    <div class="text-slate-400">研究開發、室內導航、編隊飛行</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 詳細比較表 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-purple-300 mb-4 flex items-center">
                    <i class="fa-solid fa-table-columns mr-2"></i>功能特性比較 (Feature Comparison)
                </h3>
                <div class="overflow-x-auto">
                    <table class="compare-table">
                        <thead>
                            <tr>
                                <th class="w-1/4">比較項目</th>
                                <th class="w-3/8"><i class="fa-solid fa-helicopter mr-2"></i>ArduPilot</th>
                                <th class="w-3/8"><i class="fa-solid fa-drone mr-2"></i>PX4</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="font-bold text-purple-300">架構設計</td>
                                <td>
                                    <div class="text-sm">單體式 (Monolithic)</div>
                                    <div class="text-xs text-slate-400 mt-1">所有功能整合在主循環中</div>
                                </td>
                                <td>
                                    <div class="text-sm">微服務式 (Microservices)</div>
                                    <div class="text-xs text-slate-400 mt-1">基於 uORB 的模組化架構</div>
                                </td>
                            </tr>
                            <tr>
                                <td class="font-bold text-sky-300">即時作業系統</td>
                                <td>
                                    <div class="text-sm mono-font">ChibiOS</div>
                                    <div class="text-xs text-slate-400 mt-1">輕量級、低延遲</div>
                                </td>
                                <td>
                                    <div class="text-sm mono-font">NuttX RTOS</div>
                                    <div class="text-xs text-slate-400 mt-1">POSIX相容、多執行緒</div>
                                </td>
                            </tr>
                            <tr>
                                <td class="font-bold text-emerald-300">支援載具類型</td>
                                <td>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        <span
                                            class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">多旋翼</span>
                                        <span
                                            class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">固定翼</span>
                                        <span
                                            class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">直升機</span>
                                        <span
                                            class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">VTOL</span>
                                        <span
                                            class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">潛水器</span>
                                        <span
                                            class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">地面車</span>
                                        <span
                                            class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">天線追蹤</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        <span class="px-2 py-1 bg-sky-900/30 text-sky-300 rounded text-xs">多旋翼</span>
                                        <span class="px-2 py-1 bg-sky-900/30 text-sky-300 rounded text-xs">固定翼</span>
                                        <span class="px-2 py-1 bg-sky-900/30 text-sky-300 rounded text-xs">VTOL</span>
                                        <span class="px-2 py-1 bg-sky-900/30 text-sky-300 rounded text-xs">地面車</span>
                                    </div>
                                    <div class="text-xs text-slate-400 mt-2">專注於飛行器</div>
                                </td>
                            </tr>
                            <tr>
                                <td class="font-bold text-pink-300">調參工具</td>
                                <td>
                                    <div class="text-sm">Mission Planner (Windows)</div>
                                    <div class="text-sm">APM Planner 2 (跨平台)</div>
                                    <div class="text-xs text-slate-400 mt-1">圖形化介面、自動調參</div>
                                </td>
                                <td>
                                    <div class="text-sm">QGroundControl (跨平台)</div>
                                    <div class="text-xs text-slate-400 mt-1">現代化UI、飛行日誌分析</div>
                                </td>
                            </tr>
                            <tr>
                                <td class="font-bold text-amber-300">感測器融合</td>
                                <td>
                                    <div class="text-sm mono-font">EKF3 (Extended Kalman Filter)</div>
                                    <div class="text-xs text-slate-400 mt-1">24狀態變數、多IMU融合</div>
                                </td>
                                <td>
                                    <div class="text-sm mono-font">EKF2 + Q-Estimator</div>
                                    <div class="text-xs text-slate-400 mt-1">視覺慣性融合、風場估測</div>
                                </td>
                            </tr>
                            <tr>
                                <td class="font-bold text-violet-300">ROS 整合</td>
                                <td>
                                    <div class="text-sm">MAVLink → MAVROS</div>
                                    <div class="text-xs text-slate-400 mt-1">需透過橋接層</div>
                                </td>
                                <td>
                                    <div class="text-sm">原生 ROS2 支援 (DDS/XRCE)</div>
                                    <div class="text-xs text-slate-400 mt-1">微型 XRCE-DDS 客戶端</div>
                                </td>
                            </tr>
                            <tr>
                                <td class="font-bold text-teal-300">模擬器支援</td>
                                <td>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        <span
                                            class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">SITL</span>
                                        <span
                                            class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">Gazebo</span>
                                        <span
                                            class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">RealFlight</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        <span class="px-2 py-1 bg-sky-900/30 text-sky-300 rounded text-xs">Gazebo</span>
                                        <span
                                            class="px-2 py-1 bg-sky-900/30 text-sky-300 rounded text-xs">jMAVSim</span>
                                        <span
                                            class="px-2 py-1 bg-sky-900/30 text-sky-300 rounded text-xs">FlightGear</span>
                                        <span class="px-2 py-1 bg-sky-900/30 text-sky-300 rounded text-xs">AirSim</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="font-bold text-rose-300">參數數量</td>
                                <td>
                                    <div class="text-2xl font-bold text-orange-400">~1200+</div>
                                    <div class="text-xs text-slate-400 mt-1">高度可客製化</div>
                                </td>
                                <td>
                                    <div class="text-2xl font-bold text-sky-400">~800+</div>
                                    <div class="text-xs text-slate-400 mt-1">預設值優化良好</div>
                                </td>
                            </tr>
                            <tr>
                                <td class="font-bold text-indigo-300">學習曲線</td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-orange-500 h-2 rounded-full" style="width: 60%"></div>
                                        </div>
                                        <span class="text-xs text-slate-400">中等</span>
                                    </div>
                                    <div class="text-xs text-slate-400 mt-1">文檔完善、社群支援強</div>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-sky-500 h-2 rounded-full" style="width: 75%"></div>
                                        </div>
                                        <span class="text-xs text-slate-400">較陡</span>
                                    </div>
                                    <div class="text-xs text-slate-400 mt-1">需要 C++ 與 RTOS 知識</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 控制演算法差異 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-sky-300 mb-4 flex items-center">
                    <i class="fa-solid fa-calculator mr-2"></i>控制演算法差異 (Control Algorithms)
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- ArduPilot 控制架構 -->
                    <div class="bg-slate-950 p-5 rounded border border-orange-500/30">
                        <div class="text-lg font-bold text-orange-400 mb-4 flex items-center">
                            <i class="fa-solid fa-layer-group mr-2"></i>ArduPilot 控制架構
                        </div>
                        <div class="space-y-3">
                            <div class="bg-slate-900 p-3 rounded">
                                <div class="font-bold text-orange-300 text-sm mb-2">姿態控制器</div>
                                <div class="text-xs text-slate-400 space-y-1">
                                    <div>• 雙層級 PID 控制</div>
                                    <div>• 外環：角度 PID (Rate FF)</div>
                                    <div>• 內環：角速度 PID</div>
                                    <div class="mono-font text-amber-300">ATC_RAT_RLL_P/I/D</div>
                                </div>
                            </div>
                            <div class="bg-slate-900 p-3 rounded">
                                <div class="font-bold text-sky-300 text-sm mb-2">位置控制器</div>
                                <div class="text-xs text-slate-400 space-y-1">
                                    <div>• 三層級控制</div>
                                    <div>• 位置 → 速度 → 加速度</div>
                                    <div class="mono-font text-emerald-300">PSC_POSXY_P, PSC_VELXY_P</div>
                                </div>
                            </div>
                            <div class="bg-slate-900 p-3 rounded">
                                <div class="font-bold text-purple-300 text-sm mb-2">特殊功能</div>
                                <div class="text-xs text-slate-400 space-y-1">
                                    <div>• Harmonic Notch Filter (陷波濾波)</div>
                                    <div>• AutoTune (自動調參)</div>
                                    <div>• S-Curve 軌跡規劃</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PX4 控制架構 -->
                    <div class="bg-slate-950 p-5 rounded border border-sky-500/30">
                        <div class="text-lg font-bold text-sky-400 mb-4 flex items-center">
                            <i class="fa-solid fa-diagram-project mr-2"></i>PX4 控制架構
                        </div>
                        <div class="space-y-3">
                            <div class="bg-slate-900 p-3 rounded">
                                <div class="font-bold text-sky-300 text-sm mb-2">姿態控制器</div>
                                <div class="text-xs text-slate-400 space-y-1">
                                    <div>• 串級 PID + 前饋控制</div>
                                    <div>• 四元數姿態表示</div>
                                    <div>• 自適應控制分配</div>
                                    <div class="mono-font text-sky-300">MC_ROLLRATE_P/I/D</div>
                                </div>
                            </div>
                            <div class="bg-slate-900 p-3 rounded">
                                <div class="font-bold text-emerald-300 text-sm mb-2">位置控制器</div>
                                <div class="text-xs text-slate-400 space-y-1">
                                    <div>• L1 導航演算法 (固定翼)</div>
                                    <div>• 軌跡平滑 (Jerk-limited)</div>
                                    <div class="mono-font text-emerald-300">MPC_XY_VEL_P_ACC</div>
                                </div>
                            </div>
                            <div class="bg-slate-900 p-3 rounded">
                                <div class="font-bold text-purple-300 text-sm mb-2">特殊功能</div>
                                <div class="text-xs text-slate-400 space-y-1">
                                    <div>• 風場估測與補償</div>
                                    <div>• 失效模式管理 (Failsafe)</div>
                                    <div>• 精確降落 (Precision Landing)</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 開發工作流程比較 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-emerald-300 mb-4 flex items-center">
                    <i class="fa-solid fa-code-branch mr-2"></i>開發工作流程比較 (Development Workflow)
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- ArduPilot 工作流程 -->
                    <div class="bg-slate-950 p-4 rounded border border-orange-500/30">
                        <div class="font-bold text-orange-400 mb-3 flex items-center">
                            <i class="fa-brands fa-github mr-2"></i>ArduPilot 開發流程
                        </div>
                        <div class="space-y-2 text-sm">
                            <div class="flex items-start">
                                <div
                                    class="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                    1</div>
                                <div>
                                    <div class="font-bold text-slate-300">環境建置</div>
                                    <div class="text-xs text-slate-400 mono-font">./waf configure --board Pixhawk6C
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div
                                    class="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                    2</div>
                                <div>
                                    <div class="font-bold text-slate-300">編譯韌體</div>
                                    <div class="text-xs text-slate-400 mono-font">./waf copter</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div
                                    class="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                    3</div>
                                <div>
                                    <div class="font-bold text-slate-300">SITL 模擬</div>
                                    <div class="text-xs text-slate-400 mono-font">sim_vehicle.py -v ArduCopter</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div
                                    class="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                    4</div>
                                <div>
                                    <div class="font-bold text-slate-300">上傳韌體</div>
                                    <div class="text-xs text-slate-400 mono-font">./waf --upload</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PX4 工作流程 -->
                    <div class="bg-slate-950 p-4 rounded border border-sky-500/30">
                        <div class="font-bold text-sky-400 mb-3 flex items-center">
                            <i class="fa-brands fa-github mr-2"></i>PX4 開發流程
                        </div>
                        <div class="space-y-2 text-sm">
                            <div class="flex items-start">
                                <div
                                    class="bg-sky-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                    1</div>
                                <div>
                                    <div class="font-bold text-slate-300">環境建置</div>
                                    <div class="text-xs text-slate-400 mono-font">make px4_fmu-v6c_default</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div
                                    class="bg-sky-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                    2</div>
                                <div>
                                    <div class="font-bold text-slate-300">編譯韌體</div>
                                    <div class="text-xs text-slate-400 mono-font">make px4_sitl gazebo-classic</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div
                                    class="bg-sky-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                    3</div>
                                <div>
                                    <div class="font-bold text-slate-300">Gazebo 模擬</div>
                                    <div class="text-xs text-slate-400 mono-font">make px4_sitl gz_x500</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div
                                    class="bg-sky-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                    4</div>
                                <div>
                                    <div class="font-bold text-slate-300">上傳韌體</div>
                                    <div class="text-xs text-slate-400 mono-font">make px4_fmu-v6c_default upload</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 選擇建議 -->
            <div class="bg-gradient-to-r from-purple-900/20 to-pink-900/20 border border-purple-500/30 rounded-lg p-6">
                <h3 class="text-xl font-bold text-purple-300 mb-4 flex items-center">
                    <i class="fa-solid fa-lightbulb mr-2"></i>選擇建議 (Recommendations)
                </h3>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-slate-900 p-4 rounded border border-orange-500/30">
                        <div class="text-lg font-bold text-orange-400 mb-3 flex items-center">
                            <i class="fa-solid fa-trophy mr-2"></i>選擇 ArduPilot
                        </div>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>商業應用 (農業、測繪)</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>需要多種載具支援</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>重視文檔與社群支援</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>長航時任務優化</span>
                            </li>
                        </ul>
                    </div>

                    <div class="bg-slate-900 p-4 rounded border border-sky-500/30">
                        <div class="text-lg font-bold text-sky-400 mb-3 flex items-center">
                            <i class="fa-solid fa-trophy mr-2"></i>選擇 PX4
                        </div>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>學術研究與論文發表</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>需要 ROS2 深度整合</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>室內導航與 VIO</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>編隊飛行與協同控制</span>
                            </li>
                        </ul>
                    </div>

                    <div class="bg-slate-900 p-4 rounded border border-purple-500/30">
                        <div class="text-lg font-bold text-purple-400 mb-3 flex items-center">
                            <i class="fa-solid fa-code-merge mr-2"></i>混合方案
                        </div>
                        <ul class="space-y-2 text-sm text-slate-300">
                            <li class="flex items-start">
                                <i class="fa-solid fa-lightbulb text-amber-400 mr-2 mt-1"></i>
                                <span>使用 ArduPilot 飛行</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-lightbulb text-amber-400 mr-2 mt-1"></i>
                                <span>透過 MAVLink 與 ROS 通訊</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-lightbulb text-amber-400 mr-2 mt-1"></i>
                                <span>在伴隨電腦運行 AI 演算法</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-lightbulb text-amber-400 mr-2 mt-1"></i>
                                <span>兼顧穩定性與擴展性</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        <section id="section-protocols" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-protocols"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">通訊協定深度解析 (Communication Protocols)</h2>
                <div class="flex items-center gap-2 text-slate-400 text-sm">
                    <span class="source-badge badge-protocol">PWM/DShot/RF</span>
                    <span>Control & Telemetry</span>
                </div>
            </header>

            <div class="bg-slate-900 rounded-xl border border-slate-800 overflow-hidden mb-8">
                <div class="flex border-b border-slate-800 bg-slate-950 overflow-x-auto">
                    <button onclick="switchProtoTab('pwm')" id="tab-proto-pwm"
                        class="px-6 py-4 text-sm font-bold text-blue-400 bg-slate-900 border-r border-slate-800 transition whitespace-nowrap">PWM
                        物理層與韌體</button>
                    <button onclick="switchProtoTab('dshot')" id="tab-proto-dshot"
                        class="px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap">Pixhawk
                        6C DShot 實作</button>
                    <!-- 新增: RF Tab -->
                    <button onclick="switchProtoTab('rf')" id="tab-proto-rf"
                        class="px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap">RF
                        鏈路協議 (ELRS/WiFi)</button>
                </div>

                <!-- Tab 1: PWM -->
                <div id="content-proto-pwm" class="p-6 md:p-8 animate-fade-in">
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-xl font-bold text-blue-400 mb-4">核心物理層定義 (Physical Layer)</h3>
                            <ul
                                class="space-y-2 text-sm text-slate-300 bg-slate-950 p-4 rounded border border-slate-700">
                                <li><strong>基準頻率:</strong> 50Hz (20ms 週期) 至 490Hz。</li>
                                <li><strong>有效脈寬:</strong> 1000µs (最小/0%) ~ 2000µs (最大/100%)。</li>
                                <li><strong>中立點:</strong> 1500µs。</li>
                                <li><strong>死區 (Deadband):</strong> 馬達通常需高於 ~1050µs 才會克服靜摩擦力。</li>
                            </ul>

                            <h3 class="text-xl font-bold text-emerald-400 mt-6 mb-4">轉速映射 (Logic & RPM)</h3>
                            <div class="bg-slate-950 p-4 rounded text-center border border-slate-700">
                                <p class="text-slate-200 text-sm mono-font mb-2">$$ Throttle \% = \frac{PulseWidth -
                                    1000}{1000} \times 100\% $$</p>
                                <p class="text-slate-200 text-sm mono-font">$$ RPM_{theory} = KV \times V_{battery}
                                    \times Throttle \% $$</p>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-amber-400 mb-4">協定演進對比 (Evolution)</h3>
                            <table class="w-full text-sm text-left text-slate-400 mb-6">
                                <thead class="bg-slate-950 text-xs uppercase text-slate-500">
                                    <tr>
                                        <th class="p-2">協定</th>
                                        <th class="p-2">範圍</th>
                                        <th class="p-2">特性</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-slate-800">
                                    <tr>
                                        <td class="p-2 text-white">Standard PWM</td>
                                        <td class="p-2">1000-2000µs</td>
                                        <td>通用性最強，需校準</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2 text-white">OneShot125</td>
                                        <td class="p-2">125-250µs</td>
                                        <td>速度快 8 倍，同步 PID</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2 text-sky-400 font-bold">DShot</td>
                                        <td class="p-2">0-2047 (數位)</td>
                                        <td>無須校準，支援雙向 RPM</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h3 class="text-xl font-bold text-purple-400 mb-4">韌體實作要點 (Firmware)</h3>
                            <div class="bg-slate-950 p-4 rounded border border-slate-700 text-sm text-slate-300">
                                <strong class="text-white">STM32 (C/HAL):</strong>
                                <ul class="list-disc list-inside ml-2 mt-1 mb-3 text-xs text-slate-400">
                                    <li>使用 TIMx 的 PWM Mode 1。</li>
                                    <li>Prescaler 設為 1MHz (1次計數=1µs)。</li>
                                    <li>針對多通道，建議使用 DMA 更新 CCR 暫存器，確保 Jitter 最小。</li>
                                </ul>
                                <strong class="text-white">ESP32 (Arduino/IDF):</strong>
                                <ul class="list-disc list-inside ml-2 mt-1 text-xs text-slate-400">
                                    <li>使用 LEDC 或 MCPWM (專為馬達設計)。</li>
                                    <li>建議解析度設定為 16-bit 以上。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 2: DShot -->
                <div id="content-proto-dshot" class="hidden p-6 md:p-8 animate-fade-in">
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-xl font-bold text-sky-400 mb-4">DShot 接線與韌體配置 (PX4)</h3>
                            <div class="bg-red-900/20 border border-red-500 p-4 rounded mb-4">
                                <strong class="text-red-400 flex items-center">
                                    <i class="fa-solid fa-exclamation-triangle mr-2"></i>
                                    DShot 配置安全警告
                                </strong>
                                <ul class="text-sm text-slate-300 mt-2 space-y-1">
                                    <li>• <strong>務必拆除螺旋槳</strong>後再進行 DShot 測試</li>
                                    <li>• 錯誤的 DShot 配置可能導致馬達不同步或失控</li>
                                    <li>• 首次配置建議使用<strong>邏輯分析儀</strong>監測波形</li>
                                    <li>• 確認所有馬達轉向正確後才可安裝螺旋槳</li>
                                </ul>
                            </div>
                            <div
                                class="bg-slate-950 p-4 rounded border border-slate-700 text-sm text-slate-300 space-y-4">
                                <div>
                                    <strong class="text-rose-400 block mb-1">硬體接線變更 (Critical):</strong>
                                    Pixhawk 6C 若要使用 DShot (讀取 RPM)，ESC 訊號線必須從左側的 <code
                                        class="text-emerald-400">I/O PWM OUT (MAIN)</code> 移至右側的 <code
                                        class="text-amber-400">FMU PWM OUT (AUX)</code> 接口。(註：Pixhawk 4/5/6X
                                    接線不同，請查閱說明書)
                                </div>
                                <div>
                                    <strong class="text-sky-400 block mb-1">雙向 DShot (Bidirectional):</strong>
                                    <ul class="list-disc list-inside text-xs text-slate-400">
                                        <li>需刷入 <code>default-bdshot</code> 韌體版本。</li>
                                        <li>參數 <code>DSHOT_BIDIR_EN</code> = 1 (啟用)。</li>
                                        <li>參數 <code>MOT_POLE_COUNT</code> = 14 (依 2216 馬達設定)。</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-amber-400 mb-4">Actuators 設定與防護</h3>
                            <div
                                class="bg-slate-950 p-4 rounded border border-slate-700 text-sm text-slate-300 space-y-4">
                                <div>
                                    <strong class="text-white block mb-1">QGC 設定:</strong>
                                    需在 Actuators 頁面將馬達映射至正確的 FMU 通道。建議 Minimum PWM 設為 <code
                                        class="text-sky-400">1100us</code> 確保同步啟動。
                                </div>
                                <div class="border-l-4 border-rose-500 pl-3 bg-rose-900/10 py-2">
                                    <strong class="text-rose-400 text-xs block uppercase">開發建議與安全:</strong>
                                    韌體初始化時，PWM 必須強制輸出 1000µs (或 0)，防止上電即飛人的意外。監測波形建議使用邏輯分析儀。
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab 3: RF Link (NEW) -->
                <div id="content-proto-rf" class="hidden p-6 md:p-8 animate-fade-in">
                    <div class="grid lg:grid-cols-2 gap-8 mb-8">
                        <div>
                            <h3 class="text-xl font-bold text-teal-400 mb-4">
                                <i class="fa-solid fa-tower-broadcast mr-2"></i>WiFi vs RC 協議：本質差異
                            </h3>
                            <div class="bg-slate-950 p-4 rounded border border-slate-700 space-y-4">
                                <p class="text-sm text-slate-300">雖然頻率都是 2.4GHz，但設計目標完全不同：</p>
                                <ul class="space-y-3">
                                    <li class="flex items-start">
                                        <div class="w-20 font-bold text-sky-400 text-sm">WiFi (802.11)</div>
                                        <div class="text-xs text-slate-400 flex-1">
                                            <span class="block text-white">高頻寬，雙向握手</span>
                                            封包結構大，對延遲容忍高。視距通常僅數百米，不適合關鍵控制。
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <div class="w-20 font-bold text-amber-400 text-sm">RC 鏈路</div>
                                        <div class="text-xs text-slate-400 flex-1">
                                            <span class="block text-white">低延遲，抗干擾</span>
                                            使用 <strong>FHSS (跳頻擴頻)</strong> 或 <strong>LoRa</strong>。在幾十個頻道間極速跳頻，確保指令連續。
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-xl font-bold text-rose-400 mb-4">
                                <i class="fa-solid fa-ruler-horizontal mr-2"></i>距離極限分析
                            </h3>
                            <div class="overflow-x-auto bg-slate-950 rounded border border-slate-700">
                                <table class="w-full text-xs text-left text-slate-400">
                                    <thead class="bg-slate-900 uppercase">
                                        <tr>
                                            <th class="p-2">協議</th>
                                            <th class="p-2">典型距離</th>
                                            <th class="p-2">技術點評</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-slate-800">
                                        <tr>
                                            <td class="p-2 text-white">FrSky D16</td>
                                            <td class="p-2">1.5 ~ 2.5 Km</td>
                                            <td>傳統 FSK 調變，2Km 極限。</td>
                                        </tr>
                                        <tr>
                                            <td class="p-2 text-emerald-400 font-bold">ExpressLRS</td>
                                            <td class="p-2">2.4G:>10km / 900M:>30km</td>
                                            <td>LoRa 擴頻，靈敏度 -110dBm。</td>
                                        </tr>
                                        <tr>
                                            <td class="p-2 text-white">WiFi</td>
                                            <td class="p-2">
                                                < 500m</td>
                                            <td>功率限制與協議開銷大。</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="mt-4 p-3 bg-slate-900 border-l-4 border-amber-500 rounded">
                                <strong class="text-amber-400 text-xs block mb-1">Fresnel Zone (菲涅耳區) 效應:</strong>
                                <p class="text-xs text-slate-400">2Km 外飛行時，需保持足夠高度，避免地球曲率或地面障礙物切入信號傳輸的橢圓區域，導致訊號衰減。</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-950 p-6 rounded-xl border border-slate-800">
                        <h3 class="text-lg font-bold text-slate-200 mb-4">
                            <i class="fa-solid fa-wrench mr-2 text-emerald-500"></i>給 Marlon 的行動指南 (Actionable Advice)
                        </h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <strong class="text-emerald-400 text-sm block mb-2">1. TX16S 升級策略</strong>
                                <ul class="list-disc list-inside text-xs text-slate-400 space-y-2">
                                    <li><strong>若為 ELRS 版:</strong> 恭喜，已具備最強長距離能力。</li>
                                    <li><strong>若為 4-in-1 版:</strong> 建議購買 <strong>外部 ELRS 模組 (Micro/Nano)</strong> 插在背後
                                        JR Bay，徹底解決距離焦慮。</li>
                                </ul>
                            </div>
                            <div>
                                <strong class="text-emerald-400 text-sm block mb-2">2. 接收機與天線</strong>
                                <ul class="list-disc list-inside text-xs text-slate-400 space-y-2">
                                    <li>升級至 <strong>Radiomaster RP3</strong> (雙天線 Diversity)。</li>
                                    <li>天線安裝需呈現 <strong>90度垂直夾角</strong>。</li>
                                    <li><strong>嚴禁</strong> 被碳纖維機架遮擋 (碳纖維導電會屏蔽 RF)。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="section-devenv" class="mb-16 hidden animate-section relative">
            <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-devenv"></i>
            <header class="mb-8 border-b border-slate-800 pb-4">
                <h2 class="text-3xl font-bold text-slate-100 mb-2">開發環境建置 (Development Setup)</h2>
            </header>
            <div class="bg-slate-900 p-6 rounded-xl border border-slate-800 mb-8">
                <h3 class="text-xl font-bold text-indigo-400 mb-4 flex items-center"><i
                        class="fa-solid fa-layer-group mr-2"></i>基礎 MCU 開發工具</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-left text-sm text-slate-400">
                        <thead class="text-xs text-slate-500 uppercase bg-slate-950">
                            <tr>
                                <th class="px-4 py-2">工具</th>
                                <th class="px-4 py-2">用途</th>
                                <th class="px-4 py-2">優先度</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-800">
                            <tr>
                                <td class="px-4 py-3 font-bold text-white">STM32CubeIDE 1.16.1+</td>
                                <td>ST 官方調試、雙核 H7 支援</td>
                                <td class="text-emerald-400">⭐⭐⭐⭐⭐</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-bold text-white">STM32CubeMX 6.11.1</td>
                                <td>圖形化 Pinout 配置、FreeRTOS 生成</td>
                                <td class="text-emerald-400">⭐⭐⭐⭐⭐</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-bold text-white">PlatformIO (VSCode)</td>
                                <td>輕量級開發、跨平台專案管理</td>
                                <td class="text-sky-400">⭐⭐⭐⭐</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-bold text-white">arm-none-eabi-gcc 12.2+</td>
                                <td>ARM 交叉編譯器 (基礎 Toolchain)</td>
                                <td class="text-emerald-400">⭐⭐⭐⭐⭐</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="bg-slate-900 p-6 rounded-xl border border-slate-800 mb-8">
                <h3 class="text-xl font-bold text-amber-400 mb-4 flex items-center"><i
                        class="fa-solid fa-vr-cardboard mr-2"></i>仿真驗證環境 (SITL)</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-slate-900 p-4 rounded border border-slate-700">
                        <strong class="text-white block mb-2">Gazebo Ignition (推薦)</strong>
                        <p class="text-xs text-slate-400 mb-2">高保真物理引擎，支援 ROS 2 整合。</p>
                        <code
                            class="block bg-slate-900 p-2 rounded text-emerald-400 text-xs">make px4_sitl_default gazebo</code>
                    </div>
                    <div class="bg-slate-900 p-4 rounded border border-slate-700">
                        <strong class="text-white block mb-2">jMAVSim</strong>
                        <p class="text-xs text-slate-400 mb-2">輕量級，適合快速測試演算法。</p>
                        <code
                            class="block bg-slate-900 p-2 rounded text-sky-400 text-xs">make px4_sitl_default jmavsim</code>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================================
     Part 4: AIoT 與邊緣運算平台評估章節
     插入位置: Part 1 的 <main> 區塊內，Part 3 之後
     ============================================================ -->

        <section id="section-aiot" class="mb-16 hidden animate-fade-in">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-3xl font-bold text-violet-400 flex items-center">
                    <i class="fa-solid fa-network-wired mr-3"></i>AIoT 與 Trainer Port 整合
                </h2>
                <span class="bookmark-badge" data-section="section-aiot"><i class="fa-regular fa-bookmark"></i></span>
            </div>

            <!-- Trainer Port 技術解析 -->
            <div
                class="bg-gradient-to-r from-violet-900/20 to-purple-900/20 border border-violet-500/30 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-violet-300 mb-4 flex items-center">
                    <i class="fa-solid fa-plug mr-2"></i>Trainer Port 技術解析 (PPM/S.Bus Output)
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-slate-900 p-5 rounded border border-violet-500/30">
                        <div class="text-lg font-bold text-violet-400 mb-3 flex items-center">
                            <i class="fa-solid fa-info-circle mr-2"></i>什麼是 Trainer Port?
                        </div>
                        <div class="text-sm text-slate-300 space-y-3">
                            <p>Trainer Port 原本用於<strong class="text-violet-300">教練-學員訓練模式</strong>，可輸出遙控器接收到的所有通道訊號。</p>
                            <div class="bg-slate-950 p-3 rounded border border-slate-700">
                                <div class="font-bold text-sky-400 mb-2">核心功能</div>
                                <ul class="space-y-1 text-xs">
                                    <li>• 輸出 8~16 通道 PPM/S.Bus 訊號</li>
                                    <li>• 可被外部設備 (如 Pixhawk) 讀取</li>
                                    <li>• 實現<strong class="text-amber-300">手動/自動混合控制</strong></li>
                                    <li>• 延遲極低 (&lt;5ms)</li>
                                </ul>
                            </div>
                            <div class="bg-purple-900/20 border border-purple-500/30 p-3 rounded">
                                <div class="text-xs text-purple-300 flex items-start">
                                    <i class="fa-solid fa-lightbulb mr-2 mt-1"></i>
                                    <span><strong>應用場景</strong>：伴隨電腦透過 MAVLink 發送控制指令給 Pixhawk，Pixhawk
                                        根據飛行模式決定使用遙控器訊號或電腦指令</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-900 p-5 rounded border border-sky-500/30">
                        <div class="text-lg font-bold text-sky-400 mb-3 flex items-center">
                            <i class="fa-solid fa-diagram-project mr-2"></i>連接拓撲
                        </div>
                        <div class="bg-slate-950 p-4 rounded border border-slate-700">
                            <div class="space-y-3 text-xs">
                                <div class="flex items-center justify-between">
                                    <div
                                        class="bg-pink-900/30 border border-pink-500/50 p-3 rounded text-center flex-1">
                                        <i class="fa-solid fa-tower-broadcast text-pink-400 text-lg mb-1"></i>
                                        <div class="font-bold text-pink-300">遙控器發射機</div>
                                        <div class="text-slate-400 text-xs">ExpressLRS</div>
                                    </div>
                                    <div class="text-slate-500 mx-2">→</div>
                                    <div
                                        class="bg-violet-900/30 border border-violet-500/50 p-3 rounded text-center flex-1">
                                        <i class="fa-solid fa-satellite-dish text-violet-400 text-lg mb-1"></i>
                                        <div class="font-bold text-violet-300">接收機</div>
                                        <div class="text-slate-400 text-xs">EP2 RX</div>
                                    </div>
                                </div>
                                <div class="text-center text-slate-500">↓ Trainer Port (PPM/S.Bus)</div>
                                <div class="flex items-center justify-between">
                                    <div class="bg-sky-900/30 border border-sky-500/50 p-3 rounded text-center flex-1">
                                        <i class="fa-solid fa-microchip text-sky-400 text-lg mb-1"></i>
                                        <div class="font-bold text-sky-300">Pixhawk 6C</div>
                                        <div class="text-slate-400 text-xs">RCIN Port</div>
                                    </div>
                                    <div class="text-slate-500 mx-2">↔</div>
                                    <div
                                        class="bg-emerald-900/30 border border-emerald-500/50 p-3 rounded text-center flex-1">
                                        <i class="fa-solid fa-server text-emerald-400 text-lg mb-1"></i>
                                        <div class="font-bold text-emerald-300">伴隨電腦</div>
                                        <div class="text-slate-400 text-xs">Jetson/RPi</div>
                                    </div>
                                </div>
                                <div class="bg-amber-900/20 border border-amber-500/30 p-2 rounded mt-3">
                                    <div class="text-amber-300 text-xs flex items-start">
                                        <i class="fa-solid fa-exclamation-triangle mr-2 mt-0.5"></i>
                                        <span>伴隨電腦透過 <strong>TELEM2</strong> 與 Pixhawk 通訊 (MAVLink)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 邊緣運算平台比較 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-emerald-300 mb-4 flex items-center">
                    <i class="fa-solid fa-server mr-2"></i>邊緣運算平台評估 (Companion Computer)
                </h3>
                <div class="overflow-x-auto">
                    <table class="compare-table">
                        <thead>
                            <tr>
                                <th>平台</th>
                                <th>處理器</th>
                                <th>記憶體</th>
                                <th>AI 加速</th>
                                <th>功耗</th>
                                <th>重量</th>
                                <th>價格</th>
                                <th>推薦場景</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong class="text-emerald-400">Raspberry Pi 4B</strong></td>
                                <td class="mono-font text-xs">ARM Cortex-A72<br>1.5GHz × 4</td>
                                <td class="text-sky-400">4GB/8GB</td>
                                <td class="text-slate-500">無 (CPU only)</td>
                                <td class="text-emerald-400">5W</td>
                                <td class="text-emerald-400 font-bold">46g</td>
                                <td class="text-amber-400">$55</td>
                                <td class="text-xs">輕量 CV、<br>MAVLink 橋接</td>
                            </tr>
                            <tr>
                                <td><strong class="text-orange-400">Jetson Nano</strong></td>
                                <td class="mono-font text-xs">ARM Cortex-A57<br>1.43GHz × 4</td>
                                <td class="text-sky-400">4GB</td>
                                <td class="text-green-400">128-core Maxwell GPU</td>
                                <td class="text-amber-400">10W</td>
                                <td class="text-amber-400 font-bold">87g</td>
                                <td class="text-amber-400">$99</td>
                                <td class="text-xs">YOLOv5/v8<br>物件偵測</td>
                            </tr>
                            <tr>
                                <td><strong class="text-purple-400">Jetson Orin Nano</strong></td>
                                <td class="mono-font text-xs">ARM Cortex-A78AE<br>2.0GHz × 6</td>
                                <td class="text-sky-400">8GB</td>
                                <td class="text-green-400">1024-core Ampere GPU<br>40 TOPS</td>
                                <td class="text-red-400">15W</td>
                                <td class="text-red-400 font-bold">105g</td>
                                <td class="text-red-400">$499</td>
                                <td class="text-xs">Transformer<br>多模態 AI</td>
                            </tr>
                            <tr>
                                <td><strong class="text-sky-400">Google Coral Dev Board</strong></td>
                                <td class="mono-font text-xs">NXP i.MX 8M<br>1.5GHz × 4</td>
                                <td class="text-sky-400">1GB</td>
                                <td class="text-green-400">Edge TPU<br>4 TOPS</td>
                                <td class="text-emerald-400">5W</td>
                                <td class="text-emerald-400 font-bold">48g</td>
                                <td class="text-amber-400">$150</td>
                                <td class="text-xs">TensorFlow Lite<br>低功耗推論</td>
                            </tr>
                            <tr>
                                <td><strong class="text-pink-400">Intel Neural Compute Stick 2</strong></td>
                                <td class="mono-font text-xs">Intel Movidius<br>Myriad X VPU</td>
                                <td class="text-slate-500">N/A (USB 裝置)</td>
                                <td class="text-green-400">1 TOPS</td>
                                <td class="text-emerald-400">1W</td>
                                <td class="text-emerald-400 font-bold">8.5g</td>
                                <td class="text-emerald-400">$69</td>
                                <td class="text-xs">RPi 加速器<br>OpenVINO</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="mt-6 grid md:grid-cols-3 gap-4">
                    <div class="bg-emerald-900/20 border border-emerald-500/30 p-4 rounded">
                        <div class="text-sm font-bold text-emerald-400 mb-2 flex items-center">
                            <i class="fa-solid fa-trophy mr-2"></i>最佳性價比
                        </div>
                        <div class="text-xs text-slate-300">
                            <strong class="text-emerald-300">Raspberry Pi 4B + Coral USB Accelerator</strong><br>
                            總成本 $115 | 總重 54.5g | 功耗 6W<br>
                            <span class="text-slate-400">適合 Sub-250g 無人機</span>
                        </div>
                    </div>

                    <div class="bg-orange-900/20 border border-orange-500/30 p-4 rounded">
                        <div class="text-sm font-bold text-orange-400 mb-2 flex items-center">
                            <i class="fa-solid fa-bolt mr-2"></i>最佳性能
                        </div>
                        <div class="text-xs text-slate-300">
                            <strong class="text-orange-300">Jetson Orin Nano</strong><br>
                            40 TOPS AI 算力 | 支援 ROS2 Humble<br>
                            <span class="text-slate-400">適合研究與複雜 AI 任務</span>
                        </div>
                    </div>

                    <div class="bg-sky-900/20 border border-sky-500/30 p-4 rounded">
                        <div class="text-sm font-bold text-sky-400 mb-2 flex items-center">
                            <i class="fa-solid fa-feather mr-2"></i>最輕量化
                        </div>
                        <div class="text-xs text-slate-300">
                            <strong class="text-sky-300">Intel NCS2 + RPi Zero 2W</strong><br>
                            總重 23g | 功耗 2.5W<br>
                            <span class="text-slate-400">極致輕量，適合微型機</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 實戰案例：YOLOv8 物件追蹤 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-pink-300 mb-4 flex items-center">
                    <i class="fa-solid fa-crosshairs mr-2"></i>實戰案例：YOLOv8 物件追蹤 (Object Tracking)
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- 系統架構 -->
                    <div class="bg-slate-950 p-5 rounded border border-pink-500/30">
                        <div class="text-lg font-bold text-pink-400 mb-3 flex items-center">
                            <i class="fa-solid fa-sitemap mr-2"></i>系統架構
                        </div>
                        <div class="space-y-3">
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="font-bold text-sky-400 text-sm mb-2 flex items-center">
                                    <i class="fa-solid fa-camera mr-2"></i>影像擷取
                                </div>
                                <div class="text-xs text-slate-400 space-y-1">
                                    <div>• CSI 相機：IMX219 (8MP, 1080p@30fps)</div>
                                    <div>• 視角：160° 廣角鏡頭</div>
                                    <div>• 連接：MIPI CSI-2 (4-lane)</div>
                                </div>
                            </div>

                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="font-bold text-purple-400 text-sm mb-2 flex items-center">
                                    <i class="fa-solid fa-brain mr-2"></i>AI 推論
                                </div>
                                <div class="text-xs text-slate-400 space-y-1">
                                    <div>• 模型：YOLOv8n (Nano, 3.2M 參數)</div>
                                    <div>• 輸入：640×640 RGB</div>
                                    <div>• 推論速度：Jetson Nano ~25 FPS (Measured, 472 GFLOPS FP16)</div>
                                    <div>• 偵測類別：Person, Car, Drone</div>
                                </div>
                            </div>

                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="font-bold text-emerald-400 text-sm mb-2 flex items-center">
                                    <i class="fa-solid fa-route mr-2"></i>控制邏輯
                                </div>
                                <div class="text-xs text-slate-400 space-y-1">
                                    <div>• 計算目標在畫面中的偏移量</div>
                                    <div>• 透過 MAVLink 發送 SET_POSITION_TARGET_LOCAL_NED</div>
                                    <div>• Pixhawk 執行位置修正 (Guided 模式)</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 程式碼範例 -->
                    <div class="bg-slate-950 p-5 rounded border border-sky-500/30">
                        <div class="text-lg font-bold text-sky-400 mb-3 flex items-center">
                            <i class="fa-solid fa-code mr-2"></i>Python 實作範例
                        </div>
                        <div class="bg-slate-900 p-3 rounded border border-slate-700 overflow-x-auto">
                            <pre class="text-xs text-slate-300 mono-font"><code><span class="text-purple-400">from</span> ultralytics <span class="text-purple-400">import</span> YOLO
<span class="text-purple-400">from</span> pymavlink <span class="text-purple-400">import</span> mavutil
<span class="text-purple-400">import</span> cv2

<span class="text-slate-500"># 初始化</span>
model = YOLO(<span class="text-emerald-400">'yolov8n.pt'</span>)
master = mavutil.mavlink_connection(
  <span class="text-emerald-400">'/dev/ttyTHS1'</span>, baud=<span class="text-amber-400">921600</span>
)

<span class="text-slate-500"># 影像處理迴圈</span>
cap = cv2.VideoCapture(<span class="text-amber-400">0</span>)
<span class="text-purple-400">while</span> <span class="text-sky-400">True</span>:
  ret, frame = cap.read()
  results = model.track(frame, persist=<span class="text-sky-400">True</span>)
  
  <span class="text-purple-400">if</span> <span class="text-sky-400">len</span>(results[<span class="text-amber-400">0</span>].boxes) > <span class="text-amber-400">0</span>:
      box = results[<span class="text-amber-400">0</span>].boxes[<span class="text-amber-400">0</span>]
      x_center = (box.xyxy[<span class="text-amber-400">0</span>][<span class="text-amber-400">0</span>] + box.xyxy[<span class="text-amber-400">0</span>][<span class="text-amber-400">2</span>]) / <span class="text-amber-400">2</span>
      
      <span class="text-slate-500"># 計算偏移量 (像素 → 米)</span>
      offset_x = (x_center - <span class="text-amber-400">320</span>) * <span class="text-amber-400">0.01</span>
      
      <span class="text-slate-500"># 發送控制指令</span>
      master.mav.set_position_target_local_ned_send(
          <span class="text-amber-400">0</span>, master.target_system, 
          master.target_component,
          mavutil.mavlink.MAV_FRAME_LOCAL_OFFSET_NED,
          0b0000111111000111, # type_mask (Ignore pos/vel, use accel)
          offset_x, <span class="text-amber-400">0</span>, <span class="text-amber-400">0</span>, <span class="text-slate-500"># x, y, z</span>
          <span class="text-amber-400">0</span>, <span class="text-amber-400">0</span>, <span class="text-amber-400">0</span>, <span class="text-slate-500"># vx, vy, vz</span>
          <span class="text-amber-400">0</span>, <span class="text-amber-400">0</span>, <span class="text-amber-400">0</span>, <span class="text-slate-500"># afx, afy, afz</span>
          <span class="text-amber-400">0</span>, <span class="text-amber-400">0</span> <span class="text-slate-500"># yaw, yaw_rate</span>
      )</code></pre>
                        </div>
                        <div class="mt-3 p-3 bg-amber-900/20 border border-amber-500/30 rounded">
                            <div class="text-xs text-amber-300 flex items-start">
                                <i class="fa-solid fa-exclamation-triangle mr-2 mt-1"></i>
                                <span><strong>安全提示</strong>：實際部署需加入失效保護 (Failsafe)，如目標丟失超過 3 秒自動切換為 Loiter 模式</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 通訊協定與接線 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-sky-300 mb-4 flex items-center">
                    <i class="fa-solid fa-ethernet mr-2"></i>通訊協定與接線 (MAVLink Connection)
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- 接線圖 -->
                    <div class="bg-slate-950 p-5 rounded border border-sky-500/30">
                        <div class="text-lg font-bold text-sky-400 mb-3 flex items-center">
                            <i class="fa-solid fa-plug mr-2"></i>TELEM2 接線
                        </div>
                        <div class="bg-slate-900 p-4 rounded border border-slate-700">
                            <table class="pin-table w-full text-xs">
                                <thead>
                                    <tr>
                                        <th>Pin</th>
                                        <th>Pixhawk 6C</th>
                                        <th>Jetson/RPi</th>
                                        <th>功能</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-amber-400 font-bold">1</td>
                                        <td class="text-red-400">5V</td>
                                        <td class="text-red-400">5V</td>
                                        <td class="text-slate-400">電源 (選配)</td>
                                    </tr>
                                    <tr>
                                        <td class="text-amber-400 font-bold">2</td>
                                        <td class="text-emerald-400">TX</td>
                                        <td class="text-sky-400">RX</td>
                                        <td class="text-slate-400">Pixhawk → 伴隨電腦</td>
                                    </tr>
                                    <tr>
                                        <td class="text-amber-400 font-bold">3</td>
                                        <td class="text-sky-400">RX</td>
                                        <td class="text-emerald-400">TX</td>
                                        <td class="text-slate-400">伴隨電腦 → Pixhawk</td>
                                    </tr>
                                    <tr>
                                        <td class="text-amber-400 font-bold">4</td>
                                        <td class="text-slate-500">GND</td>
                                        <td class="text-slate-500">GND</td>
                                        <td class="text-slate-400">共地</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3 space-y-2 text-xs">
                            <div class="bg-slate-900 p-2 rounded border border-slate-700 flex justify-between">
                                <span class="text-slate-400">Baud Rate</span>
                                <span class="mono-font text-emerald-400 font-bold">921600</span>
                            </div>
                            <div class="bg-slate-900 p-2 rounded border border-slate-700 flex justify-between">
                                <span class="text-slate-400">Protocol</span>
                                <span class="mono-font text-sky-400 font-bold">MAVLink v2</span>
                            </div>
                            <div class="bg-slate-900 p-2 rounded border border-slate-700 flex justify-between">
                                <span class="text-slate-400">ArduPilot 參數</span>
                                <span class="mono-font text-purple-400 font-bold">SERIAL2_PROTOCOL=2</span>
                            </div>
                        </div>
                    </div>

                    <!-- MAVLink 訊息類型 -->
                    <div class="bg-slate-950 p-5 rounded border border-purple-500/30">
                        <div class="text-lg font-bold text-purple-400 mb-3 flex items-center">
                            <i class="fa-solid fa-message mr-2"></i>常用 MAVLink 訊息
                        </div>
                        <div class="space-y-2 text-xs">
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="font-bold text-emerald-400 mb-1">HEARTBEAT</div>
                                <div class="text-slate-400">系統狀態心跳包 (1Hz)</div>
                            </div>
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="font-bold text-sky-400 mb-1">ATTITUDE</div>
                                <div class="text-slate-400">姿態角 (Roll/Pitch/Yaw)</div>
                            </div>
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="font-bold text-purple-400 mb-1">GLOBAL_POSITION_INT</div>
                                <div class="text-slate-400">GPS 位置 (經緯度/高度)</div>
                            </div>
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="font-bold text-pink-400 mb-1">SET_POSITION_TARGET_LOCAL_NED</div>
                                <div class="text-slate-400">發送位置控制指令</div>
                            </div>
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="font-bold text-amber-400 mb-1">COMMAND_LONG</div>
                                <div class="text-slate-400">執行飛行指令 (起飛/降落/切換模式)</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 功耗與散熱管理 -->
            <div class="bg-gradient-to-r from-slate-900 to-slate-800 border border-slate-700 rounded-lg p-6">
                <h3 class="text-xl font-bold text-amber-300 mb-4 flex items-center">
                    <i class="fa-solid fa-temperature-half mr-2"></i>功耗與散熱管理 (Power & Thermal)
                </h3>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-slate-950 p-4 rounded border border-amber-500/30">
                        <div class="text-sm font-bold text-amber-400 mb-3 flex items-center">
                            <i class="fa-solid fa-bolt mr-2"></i>功耗預算
                        </div>
                        <div class="space-y-2 text-xs">
                            <div class="flex justify-between items-center p-2 bg-slate-900 rounded">
                                <span class="text-slate-400">Pixhawk 6C</span>
                                <span class="text-emerald-400 font-bold">2W</span>
                            </div>
                            <div class="flex justify-between items-center p-2 bg-slate-900 rounded">
                                <span class="text-slate-400">Jetson Nano</span>
                                <span class="text-amber-400 font-bold">10W</span>
                            </div>
                            <div class="flex justify-between items-center p-2 bg-slate-900 rounded">
                                <span class="text-slate-400">IMX219 相機</span>
                                <span class="text-emerald-400 font-bold">1.5W</span>
                            </div>
                            <div
                                class="flex justify-between items-center p-2 bg-slate-900 rounded border-t-2 border-amber-500">
                                <span class="text-slate-300 font-bold">總計</span>
                                <span class="text-amber-400 font-bold">13.5W</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-950 p-4 rounded border border-sky-500/30">
                        <div class="text-sm font-bold text-sky-400 mb-3 flex items-center">
                            <i class="fa-solid fa-battery-full mr-2"></i>電池需求
                        </div>
                        <div class="space-y-2 text-xs">
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="text-slate-400 mb-1">推薦配置</div>
                                <div class="mono-font text-sky-300 font-bold">4S 5000mAh 30C (~580g)</div>
                            </div>
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="text-slate-400 mb-1">電壓範圍</div>
                                <div class="text-slate-300">14.8V ~ 16.8V</div>
                            </div>
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="text-slate-400 mb-1">續航時間 (懸停)</div>
                                <div class="text-emerald-400 font-bold">~18 分鐘</div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-950 p-4 rounded border border-red-500/30">
                        <div class="text-sm font-bold text-red-400 mb-3 flex items-center">
                            <i class="fa-solid fa-fan mr-2"></i>散熱方案
                        </div>
                        <ul class="space-y-2 text-xs text-slate-300">
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>鋁製散熱片 (20×20mm)</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>導熱膠帶 (5W/mK)</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                <span>機架開孔通風設計</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa-solid fa-exclamation-triangle text-amber-400 mr-2 mt-1"></i>
                                <span>避免主動風扇 (增加重量)</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================================
     Part 5: VIO 視覺慣性里程計章節
     插入位置: Part 1 的 <main> 區塊內，Part 4 之後
     ============================================================ -->

        <section id="section-vio" class="mb-16 hidden animate-fade-in">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-3xl font-bold text-cyan-400 flex items-center">
                    <i class="fa-solid fa-eye mr-3"></i>VIO 視覺慣性里程計 (Visual-Inertial Odometry)
                </h2>
                <span class="bookmark-badge" data-section="section-vio"><i class="fa-regular fa-bookmark"></i></span>
            </div>

            <!-- VIO 基礎概念 -->
            <div class="bg-gradient-to-r from-cyan-900/20 to-blue-900/20 border border-cyan-500/30 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-cyan-300 mb-4 flex items-center">
                    <i class="fa-solid fa-book mr-2"></i>VIO 基礎概念 (Fundamentals)
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-slate-900 p-5 rounded border border-cyan-500/30">
                        <div class="text-lg font-bold text-cyan-400 mb-3 flex items-center">
                            <i class="fa-solid fa-question-circle mr-2"></i>什麼是 VIO?
                        </div>
                        <div class="text-sm text-slate-300 space-y-3">
                            <p>VIO 是一種<strong class="text-cyan-300">融合視覺與慣性測量單元 (IMU)</strong> 的定位技術，可在<strong
                                    class="text-amber-300">無 GPS 環境</strong>下實現高精度位置估測。</p>
                            <div class="bg-slate-950 p-3 rounded border border-slate-700">
                                <div class="font-bold text-sky-400 mb-2">核心優勢</div>
                                <ul class="space-y-1 text-xs">
                                    <li class="flex items-start">
                                        <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                        <span><strong class="text-emerald-300">室內定位</strong>：GPS 拒止環境可用</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                        <span><strong class="text-sky-300">高更新率</strong>：可達 200Hz (IMU) + 30Hz
                                            (視覺)</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                        <span><strong class="text-purple-300">尺度恢復</strong>：IMU 提供真實尺度資訊</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fa-solid fa-check text-green-400 mr-2 mt-1"></i>
                                        <span><strong class="text-pink-300">低漂移</strong>：視覺修正 IMU 累積誤差</span>
                                    </li>
                                </ul>
                            </div>
                            <div class="bg-amber-900/20 border border-amber-500/30 p-3 rounded">
                                <div class="text-xs text-amber-300 flex items-start">
                                    <i class="fa-solid fa-lightbulb mr-2 mt-1"></i>
                                    <span><strong>應用場景</strong>：倉儲巡檢、橋梁檢測、礦坑探勘、室內編隊飛行</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-900 p-5 rounded border border-blue-500/30">
                        <div class="text-lg font-bold text-blue-400 mb-3 flex items-center">
                            <i class="fa-solid fa-diagram-project mr-2"></i>VIO vs 其他定位技術
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-xs">
                                <thead>
                                    <tr class="border-b border-slate-700">
                                        <th class="text-left p-2 text-slate-400">技術</th>
                                        <th class="text-center p-2 text-slate-400">精度</th>
                                        <th class="text-center p-2 text-slate-400">室內</th>
                                        <th class="text-center p-2 text-slate-400">成本</th>
                                    </tr>
                                </thead>
                                <tbody class="text-slate-300">
                                    <tr class="border-b border-slate-800">
                                        <td class="p-2 font-bold text-emerald-400">GPS</td>
                                        <td class="text-center">±2m</td>
                                        <td class="text-center"><i class="fa-solid fa-xmark text-red-400"></i></td>
                                        <td class="text-center text-emerald-400">低</td>
                                    </tr>
                                    <tr class="border-b border-slate-800">
                                        <td class="p-2 font-bold text-sky-400">RTK-GPS</td>
                                        <td class="text-center text-emerald-400">±2cm</td>
                                        <td class="text-center"><i class="fa-solid fa-xmark text-red-400"></i></td>
                                        <td class="text-center text-amber-400">中</td>
                                    </tr>
                                    <tr class="border-b border-slate-800">
                                        <td class="p-2 font-bold text-purple-400">光流 (Optical Flow)</td>
                                        <td class="text-center">±10cm</td>
                                        <td class="text-center"><i class="fa-solid fa-check text-green-400"></i></td>
                                        <td class="text-center text-emerald-400">低</td>
                                    </tr>
                                    <tr class="border-b border-slate-800">
                                        <td class="p-2 font-bold text-cyan-400">VIO</td>
                                        <td class="text-center text-emerald-400">±5cm (Est.)</td>
                                        <td class="text-center"><i class="fa-solid fa-check text-green-400"></i></td>
                                        <td class="text-center text-amber-400">中</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2 font-bold text-pink-400">Motion Capture</td>
                                        <td class="text-center text-emerald-400">±1mm</td>
                                        <td class="text-center"><i class="fa-solid fa-check text-green-400"></i></td>
                                        <td class="text-center text-red-400">極高</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIO 演算法比較 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-purple-300 mb-4 flex items-center">
                    <i class="fa-solid fa-code-compare mr-2"></i>主流 VIO 演算法比較 (Algorithm Comparison)
                </h3>
                <div class="overflow-x-auto">
                    <table class="compare-table">
                        <thead>
                            <tr>
                                <th>演算法</th>
                                <th>類型</th>
                                <th>精度</th>
                                <th>運算需求</th>
                                <th>開源</th>
                                <th>ROS 支援</th>
                                <th>最佳應用</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong class="text-cyan-400">VINS-Mono</strong></td>
                                <td class="text-xs">
                                    <span class="px-2 py-1 bg-purple-900/30 text-purple-300 rounded">Filter-based</span>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-emerald-500 h-2 rounded-full" style="width: 85%"></div>
                                        </div>
                                        <span class="text-xs">高</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-amber-500 h-2 rounded-full" style="width: 60%"></div>
                                        </div>
                                        <span class="text-xs">中</span>
                                    </div>
                                </td>
                                <td class="text-center"><i class="fa-brands fa-github text-emerald-400 text-lg"></i>
                                </td>
                                <td class="text-center"><i class="fa-solid fa-check text-green-400"></i></td>
                                <td class="text-xs">單目相機<br>長時間飛行</td>
                            </tr>
                            <tr>
                                <td><strong class="text-sky-400">ORB-SLAM3</strong></td>
                                <td class="text-xs">
                                    <span class="px-2 py-1 bg-sky-900/30 text-sky-300 rounded">SLAM</span>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-emerald-500 h-2 rounded-full" style="width: 95%"></div>
                                        </div>
                                        <span class="text-xs">極高</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-red-500 h-2 rounded-full" style="width: 85%"></div>
                                        </div>
                                        <span class="text-xs">高</span>
                                    </div>
                                </td>
                                <td class="text-center"><i class="fa-brands fa-github text-emerald-400 text-lg"></i>
                                </td>
                                <td class="text-center"><i class="fa-solid fa-check text-green-400"></i></td>
                                <td class="text-xs">地圖構建<br>回環檢測</td>
                            </tr>
                            <tr>
                                <td><strong class="text-purple-400">MSCKF</strong></td>
                                <td class="text-xs">
                                    <span class="px-2 py-1 bg-purple-900/30 text-purple-300 rounded">Filter-based</span>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-emerald-500 h-2 rounded-full" style="width: 75%"></div>
                                        </div>
                                        <span class="text-xs">中高</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-emerald-500 h-2 rounded-full" style="width: 40%"></div>
                                        </div>
                                        <span class="text-xs">低</span>
                                    </div>
                                </td>
                                <td class="text-center"><i class="fa-brands fa-github text-emerald-400 text-lg"></i>
                                </td>
                                <td class="text-center"><i class="fa-solid fa-check text-green-400"></i></td>
                                <td class="text-xs">嵌入式系統<br>即時性要求高</td>
                            </tr>
                            <tr>
                                <td><strong class="text-pink-400">Intel RealSense T265</strong></td>
                                <td class="text-xs">
                                    <span class="px-2 py-1 bg-pink-900/30 text-pink-300 rounded">Hardware VIO</span>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-emerald-500 h-2 rounded-full" style="width: 80%"></div>
                                        </div>
                                        <span class="text-xs">高</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-emerald-500 h-2 rounded-full" style="width: 20%"></div>
                                        </div>
                                        <span class="text-xs">極低</span>
                                    </div>
                                </td>
                                <td class="text-center"><i class="fa-solid fa-box text-sky-400 text-lg"></i></td>
                                <td class="text-center"><i class="fa-solid fa-check text-green-400"></i></td>
                                <td class="text-xs">即插即用<br>快速部署</td>
                            </tr>
                            <tr>
                                <td><strong class="text-emerald-400">Kimera-VIO</strong></td>
                                <td class="text-xs">
                                    <span class="px-2 py-1 bg-emerald-900/30 text-emerald-300 rounded">Semantic
                                        SLAM</span>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-emerald-500 h-2 rounded-full" style="width: 90%"></div>
                                        </div>
                                        <span class="text-xs">極高</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="flex items-center">
                                        <div class="flex-1 bg-slate-800 rounded-full h-2 mr-2">
                                            <div class="bg-red-500 h-2 rounded-full" style="width: 90%"></div>
                                        </div>
                                        <span class="text-xs">極高</span>
                                    </div>
                                </td>
                                <td class="text-center"><i class="fa-brands fa-github text-emerald-400 text-lg"></i>
                                </td>
                                <td class="text-center"><i class="fa-solid fa-check text-green-400"></i></td>
                                <td class="text-xs">語義地圖<br>場景理解</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="mt-6 grid md:grid-cols-3 gap-4">
                    <div class="bg-cyan-900/20 border border-cyan-500/30 p-4 rounded">
                        <div class="text-sm font-bold text-cyan-400 mb-2 flex items-center">
                            <i class="fa-solid fa-trophy mr-2"></i>推薦：初學者
                        </div>
                        <div class="text-xs text-slate-300">
                            <strong class="text-pink-300">Intel RealSense T265</strong><br>
                            硬體加速、即插即用、豐富範例<br>
                            <span class="text-slate-400">價格 $199 | 重量 55g</span>
                        </div>
                    </div>

                    <div class="bg-purple-900/20 border border-purple-500/30 p-4 rounded">
                        <div class="text-sm font-bold text-purple-400 mb-2 flex items-center">
                            <i class="fa-solid fa-trophy mr-2"></i>推薦：研究開發
                        </div>
                        <div class="text-xs text-slate-300">
                            <strong class="text-cyan-300">VINS-Mono</strong><br>
                            開源、文檔完善、社群活躍<br>
                            <span class="text-slate-400">支援單目/雙目/魚眼相機</span>
                        </div>
                    </div>

                    <div class="bg-sky-900/20 border border-sky-500/30 p-4 rounded">
                        <div class="text-sm font-bold text-sky-400 mb-2 flex items-center">
                            <i class="fa-solid fa-trophy mr-2"></i>推薦：高精度應用
                        </div>
                        <div class="text-xs text-slate-300">
                            <strong class="text-sky-300">ORB-SLAM3</strong><br>
                            最高精度、回環檢測、地圖重用<br>
                            <span class="text-slate-400">需要 Jetson Orin 或更高算力</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Intel RealSense T265 實戰 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-pink-300 mb-4 flex items-center">
                    <i class="fa-solid fa-camera mr-2"></i>實戰：Intel RealSense T265 整合
                </h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- 硬體規格 -->
                    <div class="bg-slate-950 p-5 rounded border border-pink-500/30">
                        <div class="text-lg font-bold text-pink-400 mb-3 flex items-center">
                            <i class="fa-solid fa-microchip mr-2"></i>硬體規格
                        </div>
                        <div class="space-y-3">
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="grid grid-cols-2 gap-2 text-xs">
                                    <div>
                                        <div class="text-slate-400 mb-1">相機</div>
                                        <div class="text-sky-300 font-bold">雙魚眼 (850nm)</div>
                                    </div>
                                    <div>
                                        <div class="text-slate-400 mb-1">視角</div>
                                        <div class="text-slate-300">163° ± 5°</div>
                                    </div>
                                    <div>
                                        <div class="text-slate-400 mb-1">IMU</div>
                                        <div class="text-purple-300 font-bold">BMI055 (6軸)</div>
                                    </div>
                                    <div>
                                        <div class="text-slate-400 mb-1">更新率</div>
                                        <div class="text-slate-300">200 Hz</div>
                                    </div>
                                    <div>
                                        <div class="text-slate-400 mb-1">處理器</div>
                                        <div class="text-emerald-300 font-bold">Intel Movidius</div>
                                    </div>
                                    <div>
                                        <div class="text-slate-400 mb-1">接口</div>
                                        <div class="text-slate-300">USB 3.0</div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="font-bold text-amber-400 text-sm mb-2">物理參數</div>
                                <div class="grid grid-cols-3 gap-2 text-xs">
                                    <div class="text-center p-2 bg-slate-950 rounded">
                                        <div class="text-2xl font-bold text-emerald-400">55g</div>
                                        <div class="text-slate-400 text-xs">重量</div>
                                    </div>
                                    <div class="text-center p-2 bg-slate-950 rounded">
                                        <div class="text-2xl font-bold text-sky-400">1.5W</div>
                                        <div class="text-slate-400 text-xs">功耗</div>
                                    </div>
                                    <div class="text-center p-2 bg-slate-950 rounded">
                                        <div class="text-2xl font-bold text-purple-400">108mm</div>
                                        <div class="text-slate-400 text-xs">長度</div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-emerald-900/20 border border-emerald-500/30 p-3 rounded">
                                <div class="text-xs text-emerald-300 flex items-start">
                                    <i class="fa-solid fa-check mr-2 mt-1"></i>
                                    <span><strong>重要</strong>：T265 已停產 (2022)，建議替代方案為 <strong>OAK-D-Pro</strong> (含 IMU)
                                        或自建
                                        VINS-Mono 系統</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ROS 整合程式碼 -->
                    <div class="bg-slate-950 p-5 rounded border border-sky-500/30">
                        <div class="text-lg font-bold text-sky-400 mb-3 flex items-center">
                            <i class="fa-solid fa-code mr-2"></i>ROS 整合範例
                        </div>
                        <div class="bg-slate-900 p-3 rounded border border-slate-700 overflow-x-auto mb-3">
                            <div class="text-xs text-slate-400 mb-2 font-bold">1. 安裝 RealSense SDK</div>
                            <pre class="text-xs text-slate-300 mono-font"><code><span class="text-slate-500"># 安裝依賴</span>
sudo apt install ros-noetic-realsense2-camera

<span class="text-slate-500"># 啟動 T265 節點</span>
roslaunch realsense2_camera rs_t265.launch</code></pre>
                        </div>

                        <div class="bg-slate-900 p-3 rounded border border-slate-700 overflow-x-auto mb-3">
                            <div class="text-xs text-slate-400 mb-2 font-bold">2. 發布 Vision Pose 到 Pixhawk</div>
                            <pre class="text-xs text-slate-300 mono-font"><code><span class="text-purple-400">import</span> rospy
<span class="text-purple-400">from</span> nav_msgs.msg <span class="text-purple-400">import</span> Odometry
<span class="text-purple-400">from</span> pymavlink <span class="text-purple-400">import</span> mavutil

master = mavutil.mavlink_connection(
  <span class="text-emerald-400">'/dev/ttyTHS1'</span>, baud=<span class="text-amber-400">921600</span>
)

<span class="text-purple-400">def</span> <span class="text-sky-400">odom_callback</span>(msg):
  master.mav.vision_position_estimate_send(
      rospy.Time.now().to_nsec() // <span class="text-amber-400">1000</span>,
      msg.pose.pose.position.x,
      msg.pose.pose.position.y,
      msg.pose.pose.position.z,
      <span class="text-amber-400">0</span>, <span class="text-amber-400">0</span>, <span class="text-amber-400">0</span>  <span class="text-slate-500"># roll, pitch, yaw</span>
  )

rospy.Subscriber(
  <span class="text-emerald-400">'/camera/odom/sample'</span>, 
  Odometry, 
  odom_callback
)</code></pre>
                        </div>

                        <div class="bg-slate-900 p-3 rounded border border-slate-700">
                            <div class="text-xs text-slate-400 mb-2 font-bold">3. ArduPilot 參數設定</div>
                            <div class="space-y-1 text-xs mono-font text-slate-300">
                                <div class="flex justify-between p-1 bg-slate-950 rounded">
                                    <span class="text-purple-400">EK3_SRC1_POSXY</span>
                                    <span class="text-amber-400">6 (ExternalNav)</span>
                                </div>
                                <div class="flex justify-between p-1 bg-slate-950 rounded">
                                    <span class="text-purple-400">EK3_SRC1_POSZ</span>
                                    <span class="text-amber-400">6 (ExternalNav)</span>
                                </div>
                                <div class="flex justify-between p-1 bg-slate-950 rounded">
                                    <span class="text-purple-400">EK3_SRC1_VELXY</span>
                                    <span class="text-amber-400">6 (ExternalNav)</span>
                                </div>
                                <div class="flex justify-between p-1 bg-slate-950 rounded">
                                    <span class="text-purple-400">VISO_TYPE</span>
                                    <span class="text-amber-400">2 (MAV)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VINS-Mono 自建方案 -->
            <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                <h3 class="text-xl font-bold text-cyan-300 mb-4 flex items-center">
                    <i class="fa-solid fa-hammer mr-2"></i>自建方案：VINS-Mono + IMX219
                </h3>
                <div class="grid md:grid-cols-3 gap-6">
                    <!-- 硬體清單 -->
                    <div class="bg-slate-950 p-4 rounded border border-cyan-500/30">
                        <div class="text-sm font-bold text-cyan-400 mb-3 flex items-center">
                            <i class="fa-solid fa-list mr-2"></i>硬體清單
                        </div>
                        <div class="space-y-2 text-xs">
                            <div
                                class="bg-slate-900 p-2 rounded border border-slate-700 flex justify-between items-center">
                                <span class="text-slate-300">IMX219 相機模組</span>
                                <span class="text-emerald-400 font-bold">$15</span>
                            </div>
                            <div
                                class="bg-slate-900 p-2 rounded border border-slate-700 flex justify-between items-center">
                                <span class="text-slate-300">160° 魚眼鏡頭</span>
                                <span class="text-emerald-400 font-bold">$8</span>
                            </div>
                            <div
                                class="bg-slate-900 p-2 rounded border border-slate-700 flex justify-between items-center">
                                <span class="text-slate-300">Jetson Nano</span>
                                <span class="text-amber-400 font-bold">$99</span>
                            </div>
                            <div
                                class="bg-slate-900 p-2 rounded border border-slate-700 flex justify-between items-center">
                                <span class="text-slate-300">Pixhawk 6C (含 IMU)</span>
                                <span class="text-sky-400 font-bold">內建</span>
                            </div>
                            <div class="border-t border-slate-700 pt-2 mt-2">
                                <div class="flex justify-between items-center font-bold">
                                    <span class="text-slate-300">總成本</span>
                                    <span class="text-cyan-400 text-lg">$122</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 安裝步驟 -->
                    <div class="bg-slate-950 p-4 rounded border border-purple-500/30">
                        <div class="text-sm font-bold text-purple-400 mb-3 flex items-center">
                            <i class="fa-solid fa-terminal mr-2"></i>安裝步驟
                        </div>
                        <div class="space-y-2 text-xs">
                            <div class="flex items-start">
                                <div
                                    class="bg-purple-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                    1</div>
                                <div>
                                    <div class="font-bold text-slate-300">安裝 ROS Noetic</div>
                                    <div class="text-slate-400 mono-font text-xs">sudo apt install
                                        ros-noetic-desktop-full</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div
                                    class="bg-purple-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                    2</div>
                                <div>
                                    <div class="font-bold text-slate-300">編譯 VINS-Mono</div>
                                    <div class="text-slate-400 mono-font text-xs">catkin build vins_estimator</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div
                                    class="bg-purple-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                    3</div>
                                <div>
                                    <div class="font-bold text-slate-300">相機校正</div>
                                    <div class="text-slate-400 mono-font text-xs">rosrun camera_calibration
                                        cameracalibrator.py</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div
                                    class="bg-purple-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                    4</div>
                                <div>
                                    <div class="font-bold text-slate-300">IMU-相機外參校正</div>
                                    <div class="text-slate-400 mono-font text-xs">使用 Kalibr 工具包</div>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div
                                    class="bg-purple-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                    5</div>
                                <div>
                                    <div class="font-bold text-slate-300">啟動 VIO</div>
                                    <div class="text-slate-400 mono-font text-xs">roslaunch vins_estimator
                                        realsense_fisheye.launch</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 性能指標 -->
                    <div class="bg-slate-950 p-4 rounded border border-emerald-500/30">
                        <div class="text-sm font-bold text-emerald-400 mb-3 flex items-center">
                            <i class="fa-solid fa-chart-bar mr-2"></i>性能指標
                        </div>
                        <div class="space-y-3">
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="text-slate-400 text-xs mb-1">位置精度</div>
                                <div class="text-2xl font-bold text-emerald-400">±5cm (Est.)</div>
                                <div class="text-xs text-slate-500">在 10m × 10m 室內環境</div>
                            </div>
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="text-slate-400 text-xs mb-1">更新頻率</div>
                                <div class="text-2xl font-bold text-sky-400">20 Hz</div>
                                <div class="text-xs text-slate-500">Jetson Nano @ 10W</div>
                            </div>
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <div class="text-slate-400 text-xs mb-1">初始化時間</div>
                                <div class="text-2xl font-bold text-purple-400">~3s</div>
                                <div class="text-xs text-slate-500">需要緩慢移動相機</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 常見問題與解決方案 -->
            <div class="bg-gradient-to-r from-slate-900 to-slate-800 border border-slate-700 rounded-lg p-6">
                <h3 class="text-xl font-bold text-amber-300 mb-4 flex items-center">
                    <i class="fa-solid fa-circle-question mr-2"></i>常見問題與解決方案 (Troubleshooting)
                </h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-slate-950 p-4 rounded border border-red-500/30">
                        <div class="text-sm font-bold text-red-400 mb-3 flex items-center">
                            <i class="fa-solid fa-exclamation-triangle mr-2"></i>問題：VIO 初始化失敗
                        </div>
                        <div class="text-xs text-slate-300 space-y-2">
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="font-bold text-amber-400 mb-1">原因</div>
                                <ul class="space-y-1 text-slate-400">
                                    <li>• 環境特徵點不足 (白牆、玻璃)</li>
                                    <li>• 相機運動過快或震動過大</li>
                                    <li>• IMU 時間戳不同步</li>
                                </ul>
                            </div>
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="font-bold text-emerald-400 mb-1">解決方案</div>
                                <ul class="space-y-1 text-slate-400">
                                    <li>• 在紋理豐富的環境初始化</li>
                                    <li>• 緩慢移動相機 (&lt;0.5 m/s)</li>
                                    <li>• 檢查 IMU 校正參數</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-950 p-4 rounded border border-amber-500/30">
                        <div class="text-sm font-bold text-amber-400 mb-3 flex items-center">
                            <i class="fa-solid fa-exclamation-triangle mr-2"></i>問題：位置漂移嚴重
                        </div>
                        <div class="text-xs text-slate-300 space-y-2">
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="font-bold text-amber-400 mb-1">原因</div>
                                <ul class="space-y-1 text-slate-400">
                                    <li>• IMU 與相機外參不準確</li>
                                    <li>• 光照變化劇烈</li>
                                    <li>• 動態物體干擾</li>
                                </ul>
                            </div>
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="font-bold text-emerald-400 mb-1">解決方案</div>
                                <ul class="space-y-1 text-slate-400">
                                    <li>• 使用 Kalibr 重新校正外參</li>
                                    <li>• 啟用自動曝光補償</li>
                                    <li>• 加入 RANSAC 異常值剔除</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-950 p-4 rounded border border-sky-500/30">
                        <div class="text-sm font-bold text-sky-400 mb-3 flex items-center">
                            <i class="fa-solid fa-exclamation-triangle mr-2"></i>問題：運算延遲過高
                        </div>
                        <div class="text-xs text-slate-300 space-y-2">
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="font-bold text-amber-400 mb-1">原因</div>
                                <ul class="space-y-1 text-slate-400">
                                    <li>• 影像解析度過高</li>
                                    <li>• 特徵點數量過多</li>
                                    <li>• CPU 負載過高</li>
                                </ul>
                            </div>
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="font-bold text-emerald-400 mb-1">解決方案</div>
                                <ul class="space-y-1 text-slate-400">
                                    <li>• 降低解析度至 640×480</li>
                                    <li>• 限制特徵點數量 (&lt;150)</li>
                                    <li>• 使用 GPU 加速 (CUDA)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-950 p-4 rounded border border-purple-500/30">
                        <div class="text-sm font-bold text-purple-400 mb-3 flex items-center">
                            <i class="fa-solid fa-exclamation-triangle mr-2"></i>問題：尺度不一致
                        </div>
                        <div class="text-xs text-slate-300 space-y-2">
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="font-bold text-amber-400 mb-1">原因</div>
                                <ul class="space-y-1 text-slate-400">
                                    <li>• 單目相機缺乏深度資訊</li>
                                    <li>• IMU 尺度因子未校正</li>
                                </ul>
                            </div>
                            <div class="bg-slate-900 p-2 rounded">
                                <div class="font-bold text-emerald-400 mb-1">解決方案</div>
                                <ul class="space-y-1 text-slate-400">
                                    <li>• 使用雙目或深度相機</li>
                                    <li>• 與 GPS 融合校正尺度</li>
                                    <li>• 在已知距離環境中標定</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Pixhawk 6C <-> RPi 5 Integration Guide -->
            <div class="mt-12 border-t border-slate-800 pt-8">
                <header class="mb-6">
                    <h2
                        class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-400 to-rose-400 mb-2">
                        <i class="fa-brands fa-raspberry-pi mr-2"></i>Pixhawk 6C 與 RPi 5 深度整合指南
                    </h2>
                    <p class="text-slate-400 text-sm">
                        透過 TELEM2 (UART) 建立高頻寬 MAVLink 通訊，實現邊緣運算 (Edge AI) 與 Offboard 控制。
                    </p>
                </header>

                <div class="grid lg:grid-cols-2 gap-6 mb-8">
                    <!-- 1. Hardware Connection -->
                    <div class="bg-slate-900/50 p-6 rounded-xl border border-slate-700">
                        <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                            <i class="fa-solid fa-plug mr-2 text-sky-400"></i>1. 硬體接線 (Hardware)
                        </h3>
                        <div class="bg-slate-950 p-4 rounded border border-slate-800 mb-4">
                            <table class="w-full text-xs text-left">
                                <thead>
                                    <tr class="text-slate-500 border-b border-slate-800">
                                        <th class="pb-2">Pixhawk TELEM2</th>
                                        <th class="pb-2">訊號 (3.3V)</th>
                                        <th class="pb-2">RPi 5 GPIO</th>
                                    </tr>
                                </thead>
                                <tbody class="text-slate-300 font-mono">
                                    <tr class="border-b border-slate-800/50">
                                        <td class="py-2">Pin 2 (TX)</td>
                                        <td class="text-emerald-400">➜ (Cross) ➜</td>
                                        <td>GPIO 15 (RXD)</td>
                                    </tr>
                                    <tr class="border-b border-slate-800/50">
                                        <td class="py-2">Pin 3 (RX)</td>
                                        <td class="text-sky-400">➜ (Cross) ➜</td>
                                        <td>GPIO 14 (TXD)</td>
                                    </tr>
                                    <tr>
                                        <td class="py-2">Pin 6 (GND)</td>
                                        <td class="text-slate-500">── Common ──</td>
                                        <td>Pin 6 (GND)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="p-3 bg-rose-900/20 border border-rose-500/30 rounded flex items-start">
                            <i class="fa-solid fa-bolt text-rose-500 mt-1 mr-2"></i>
                            <div class="text-xs text-rose-300">
                                <strong>供電警告：</strong> RPi 5 必須使用獨立 5V/5A 電源 (如 UBEC)。<br>
                                <span class="underline">絕對不可</span> 從 TELEM2 埠取電，否則將導致飛控電壓驟降 (Brownout)。
                            </div>
                        </div>
                    </div>

                    <!-- 2. System Configuration -->
                    <div class="bg-slate-900/50 p-6 rounded-xl border border-slate-700">
                        <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                            <i class="fa-solid fa-terminal mr-2 text-emerald-400"></i>2. 系統設定 (System Config)
                        </h3>

                        <div class="space-y-4">
                            <div>
                                <strong class="text-xs text-slate-400 block mb-1">RPi 5 (Ubuntu/RpiOS)</strong>
                                <div
                                    class="bg-black p-3 rounded border border-slate-800 font-mono text-xs text-slate-300">
                                    <span class="text-slate-500"># 1. 編輯 /boot/firmware/config.txt</span><br>
                                    enable_uart=1<br>
                                    dtoverlay=disable-bt<br><br>
                                    <span class="text-slate-500"># 2. 停用 Serial Console</span><br>
                                    sudo raspi-config nonint do_serial 2
                                </div>
                            </div>

                            <div>
                                <strong class="text-xs text-slate-400 block mb-1">Pixhawk Parameters (QGC)</strong>
                                <ul
                                    class="text-xs text-slate-300 space-y-1 bg-slate-950 p-3 rounded border border-slate-800">
                                    <li class="flex justify-between">
                                        <span class="font-mono text-sky-400">MAV_1_CONFIG</span>
                                        <span>TELEM 2 (102)</span>
                                    </li>
                                    <li class="flex justify-between">
                                        <span class="font-mono text-sky-400">SER_TEL2_BAUD</span>
                                        <span>57600 or 921600</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. Troubleshooting -->
                <div class="bg-slate-900 border border-slate-700 rounded-lg p-6">
                    <h3 class="text-lg font-bold text-amber-300 mb-4 flex items-center">
                        <i class="fa-solid fa-screwdriver-wrench mr-2"></i>連線驗證與故障排除
                    </h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <strong class="text-xs text-slate-400 block mb-2">快速驗證指令 (Terminal)</strong>
                            <div
                                class="bg-black p-3 rounded border border-slate-800 font-mono text-xs text-emerald-400 mb-2">
                                sudo mavproxy.py --master=/dev/serial0 --baudrate=57600
                            </div>
                            <p class="text-xs text-slate-500">若看到 `MAV> heartbeats OK` 代表連線成功。</p>
                        </div>

                        <div class="space-y-2">
                            <div class="bg-slate-900 p-2 rounded border border-slate-800 flex items-center">
                                <span class="bg-rose-900/50 text-rose-400 text-xs px-2 py-1 rounded mr-3">無回應</span>
                                <span class="text-xs text-slate-400">檢查 TX/RX 是否交叉接線 (Tx對Rx)。</span>
                            </div>
                            <div class="bg-slate-950 p-2 rounded border border-slate-800 flex items-center">
                                <span class="bg-amber-900/50 text-amber-400 text-xs px-2 py-1 rounded mr-3">權限錯誤</span>
                                <span class="text-xs text-slate-400">`sudo usermod -a -G dialout $USER`</span>
                            </div>
                            <div class="bg-slate-950 p-2 rounded border border-slate-800 flex items-center">
                                <span class="bg-sky-900/50 text-sky-400 text-xs px-2 py-1 rounded mr-3">設備消失</span>
                                <span class="text-xs text-slate-400">確認 `dtoverlay=disable-bt` 已重啟生效。</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Gesture Control Guide -->
            <div class="mt-12 border-t border-slate-800 pt-8">
                <header class="mb-6">
                    <h2
                        class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-violet-400 to-purple-400 mb-2">
                        <i class="fa-solid fa-hand-sparkles mr-2"></i>應用實作：手勢控制無人機 (Gesture Control)
                    </h2>
                    <p class="text-slate-400 text-sm">
                        整合 MediaPipe 手勢辨識與 MAVLink Offboard 控制，實現免遙控器飛行。
                    </p>
                </header>

                <div class="grid lg:grid-cols-3 gap-6 mb-8">
                    <!-- Logic Mapping -->
                    <div class="lg:col-span-1 space-y-4">
                        <div class="bg-slate-900/50 p-6 rounded-xl border border-slate-700 h-full">
                            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                                <i class="fa-solid fa-sitemap mr-2 text-sky-400"></i>控制邏輯 (Logic)
                            </h3>
                            <div class="space-y-3">
                                <div
                                    class="bg-slate-950 p-3 rounded border border-slate-800 flex items-center justify-between">
                                    <div class="flex items-center">
                                        <i class="fa-solid fa-hand-fist text-rose-400 mr-3 w-6 text-center"></i>
                                        <div>
                                            <div class="text-slate-200 font-bold text-sm">握拳 (Fist)</div>
                                            <div class="text-xs text-slate-500">0 Fingers Up</div>
                                        </div>
                                    </div>
                                    <div class="text-rose-400 font-mono text-sm font-bold">LAND</div>
                                </div>
                                <div
                                    class="bg-slate-950 p-3 rounded border border-slate-800 flex items-center justify-between">
                                    <div class="flex items-center">
                                        <i class="fa-solid fa-hand-point-up text-emerald-400 mr-3 w-6 text-center"></i>
                                        <div>
                                            <div class="text-slate-200 font-bold text-sm">食指 (Index)</div>
                                            <div class="text-xs text-slate-500">Index Only</div>
                                        </div>
                                    </div>
                                    <div class="text-emerald-400 font-mono text-sm font-bold">TAKEOFF</div>
                                </div>
                                <div
                                    class="bg-slate-950 p-3 rounded border border-slate-800 flex items-center justify-between">
                                    <div class="flex items-center">
                                        <i class="fa-solid fa-hand text-amber-400 mr-3 w-6 text-center"></i>
                                        <div>
                                            <div class="text-slate-200 font-bold text-sm">手掌傾斜 (Tilt)</div>
                                            <div class="text-xs text-slate-500">Wrist vs Palm</div>
                                        </div>
                                    </div>
                                    <div class="text-amber-400 font-mono text-sm font-bold">YAW</div>
                                </div>
                            </div>

                            <div class="mt-6 p-3 bg-blue-900/20 border border-blue-500/30 rounded">
                                <h4 class="text-blue-400 text-xs font-bold mb-1"><i
                                        class="fa-solid fa-microchip mr-1"></i>RPi 5 優化建議</h4>
                                <ul class="text-xs text-slate-400 list-disc list-inside space-y-1">
                                    <li>使用 <strong>Threading</strong> 分離影像讀取與推論。</li>
                                    <li>解析度設為 <strong>320x240</strong> 以達 30fps。</li>
                                    <li>可選配 <strong>Hailo-8L AI Kit</strong> 加速至 90fps+。</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Python Code -->
                    <div class="lg:col-span-2">
                        <div class="bg-slate-900/80 p-0 rounded-xl border border-slate-700 overflow-hidden shadow-lg">
                            <div
                                class="flex items-center justify-between px-4 py-2 bg-slate-800/50 border-b border-slate-700">
                                <span class="text-xs font-mono text-slate-400">gesture_control.py</span>
                                <span class="text-xs text-emerald-500"><i
                                        class="fa-solid fa-circle text-[8px] mr-1"></i>Python 3</span>
                            </div>
                            <div class="relative group">
                                <pre
                                    class="p-4 text-xs font-mono text-slate-300 overflow-x-auto max-h-[400px] custom-scrollbar bg-[#0d1117]"><code><span class="text-purple-400">import</span> cv2
<span class="text-purple-400">import</span> mediapipe <span class="text-purple-400">as</span> mp
<span class="text-purple-400">import</span> time
<span class="text-purple-400">from</span> pymavlink <span class="text-purple-400">import</span> mavutil

<span class="text-slate-500"># 1. MAVLink 連線 (RPi5 UART)</span>
mav_conn = mavutil.mavlink_connection(<span class="text-emerald-400">'/dev/serial0'</span>, baud=<span class="text-amber-400">57600</span>)
mav_conn.wait_heartbeat()
<span class="text-sky-400">print</span>(<span class="text-emerald-400">"Pixhawk Connected!"</span>)

<span class="text-slate-500"># 2. MediaPipe 初始化</span>
mp_hands = mp.solutions.hands
hands = mp_hands.Hands(
    model_complexity=<span class="text-amber-400">0</span>,  <span class="text-slate-500"># Lite model for speed</span>
    min_detection_confidence=<span class="text-amber-400">0.7</span>,
    max_num_hands=<span class="text-amber-400">1</span>
)

<span class="text-purple-400">def</span> <span class="text-sky-400">send_command</span>(cmd, p7=<span class="text-amber-400">0</span>):
    mav_conn.mav.command_long_send(
        mav_conn.target_system, mav_conn.target_component,
        cmd, <span class="text-amber-400">0</span>, <span class="text-amber-400">0</span>,<span class="text-amber-400">0</span>,<span class="text-amber-400">0</span>,<span class="text-amber-400">0</span>,<span class="text-amber-400">0</span>,<span class="text-amber-400">0</span>, p7
    )

<span class="text-purple-400">def</span> <span class="text-sky-400">set_offboard</span>():
    <span class="text-slate-500"># Set Mode to Offboard (Custom Mode 4)</span>
    mav_conn.mav.set_mode_send(
        mav_conn.target_system, 
        mavutil.mavlink.MAV_MODE_FLAG_CUSTOM_MODE_ENABLED, 
        <span class="text-amber-400">4</span>
    )

<span class="text-slate-500"># 3. 主循環</span>
cap = cv2.VideoCapture(<span class="text-amber-400">0</span>)
debounce = <span class="text-amber-400">0</span>

<span class="text-purple-400">while</span> cap.isOpened():
    ret, frame = cap.read()
    <span class="text-purple-400">if not</span> ret: <span class="text-purple-400">break</span>
    
    <span class="text-slate-500"># 辨識邏輯...</span>
    results = hands.process(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB))
    
    <span class="text-purple-400">if</span> results.multi_hand_landmarks:
        <span class="text-slate-500"># 判斷手指狀態 (fingers_up)</span>
        <span class="text-slate-500"># ... (略過詳細幾何計算)</span>
        
        <span class="text-purple-400">if</span> time.time() - debounce > <span class="text-amber-400">1.0</span>:
            <span class="text-purple-400">if</span> fingers_sum == <span class="text-amber-400">0</span>: <span class="text-slate-500"># 握拳</span>
                send_command(mavutil.mavlink.MAV_CMD_NAV_LAND)
                <span class="text-sky-400">print</span>(<span class="text-rose-400">"CMD: LAND"</span>)
                debounce = time.time()
            <span class="text-purple-400">elif</span> index_finger_only: <span class="text-slate-500"># 食指</span>
                send_command(mavutil.mavlink.MAV_CMD_NAV_TAKEOFF, p7=<span class="text-amber-400">2</span>)
                <span class="text-sky-400">print</span>(<span class="text-emerald-400">"CMD: TAKEOFF"</span>)
                debounce = time.time()
                
                                    cv2.imshow(<span class="text-emerald-400">'Gesture Control'</span>, frame)
                                    <span class="text-purple-400">if</span> cv2.waitKey(<span class="text-amber-400">1</span>) & <span class="text-amber-400">0xFF</span> == <span class="text-sky-400">ord</span>(<span class="text-emerald-400">'q'</span>): <span class="text-purple-400">break</span></code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================================
     Part 6: 系統測試與調參章節
     插入位置: Part 1 的 <main> 區塊內，Part 5 之後
     ============================================================ -->

        <main class="md:ml-64 min-h-screen">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" id="content-container">

                <!-- ============================================================
         Part 0: 起始頁面 (Landing Page / Dashboard)
         ============================================================ -->
                <section id="section-landing" class="mb-16 animate-section relative">
                    <!-- Hero Banner -->
                    <div
                        class="relative rounded-2xl overflow-hidden mb-12 border border-slate-700 shadow-2xl bg-slate-900">
                        <div class="absolute inset-0 bg-gradient-to-r from-blue-900/40 to-purple-900/40 z-0"></div>
                        <div class="relative z-10 p-10 text-center">
                            <h1
                                class="text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-sky-400 via-violet-400 to-fuchsia-400 mb-4 tracking-tight drop-shadow-sm">
                                UAS R&D Hub
                            </h1>
                            <p class="text-xl text-slate-300 font-light mb-8 max-w-3xl mx-auto">
                                整合硬體工程、飛行控制、AIoT 邊緣運算與系統驗證的無人載具研發知識庫
                            </p>
                            <div class="flex flex-wrap justify-center gap-4">
                                <button onclick="document.querySelector('[data-section=\'section-software\']').click()"
                                    class="px-6 py-2 bg-sky-600 hover:bg-sky-500 text-white rounded-full font-bold transition shadow-lg shadow-sky-900/50">
                                    <i class="fa-solid fa-rocket mr-2"></i>開始探索 (Start)
                                </button>
                                <button onclick="document.querySelector('[data-section=\'section-roadmap\']').click()"
                                    class="px-6 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded-full font-bold transition border border-slate-600">
                                    <i class="fa-solid fa-map-location-dot mr-2"></i>技術路線 (Roadmap)
                                </button>
                            </div>
                        </div>
                        <!-- Background Decoration -->
                        <div class="absolute -top-24 -left-24 w-64 h-64 bg-sky-500/20 rounded-full blur-3xl"></div>
                        <div class="absolute -bottom-24 -right-24 w-64 h-64 bg-purple-500/20 rounded-full blur-3xl">
                        </div>
                    </div>

                    <!-- Navigation Grid (4 Categories) -->
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <!-- Card 1: Overview -->
                        <div onclick="document.querySelector('[data-section=\'section-roadmap\']').click()"
                            class="group bg-slate-900/50 hover:bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-sky-500/50 transition cursor-pointer flex flex-col h-full relative overflow-hidden">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition transform group-hover:scale-110">
                                <i class="fa-solid fa-gauge-high text-6xl text-sky-400"></i>
                            </div>
                            <h3 class="text-xl font-bold text-sky-400 mb-2 group-hover:translate-x-1 transition">
                                <i class="fa-solid fa-gauge-high mr-2"></i>系統概觀 (Overview)
                            </h3>
                            <p class="text-sm text-slate-400 mb-4 flex-grow">
                                技術路線圖、微型無人機與系統發展沿革。
                            </p>
                            <div class="flex gap-2 text-xs">
                                <span
                                    class="bg-slate-800 px-2 py-1 rounded text-slate-300 border border-slate-700">Roadmap</span>
                                <span
                                    class="bg-slate-800 px-2 py-1 rounded text-slate-300 border border-slate-700">MicroUAV</span>
                            </div>
                        </div>

                        <!-- Card 2: Hardware -->
                        <div onclick="document.querySelector('[data-section=\'section-official-docs\']').click()"
                            class="group bg-slate-900/50 hover:bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-amber-500/50 transition cursor-pointer flex flex-col h-full relative overflow-hidden">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition transform group-hover:scale-110">
                                <i class="fa-solid fa-microchip text-6xl text-amber-400"></i>
                            </div>
                            <h3 class="text-xl font-bold text-amber-400 mb-2 group-hover:translate-x-1 transition">
                                <i class="fa-solid fa-microchip mr-2"></i>硬體工程 (Hardware)
                            </h3>
                            <p class="text-sm text-slate-400 mb-4 flex-grow">
                                官方技術手冊、MCU 架構詳解與硬體拆解分析。
                            </p>
                            <div class="flex gap-2 text-xs">
                                <span
                                    class="bg-slate-800 px-2 py-1 rounded text-slate-300 border border-slate-700">Docs</span>
                                <span
                                    class="bg-slate-800 px-2 py-1 rounded text-slate-300 border border-slate-700">Teardown</span>
                            </div>
                        </div>

                        <!-- Card 3: Software -->
                        <div onclick="document.querySelector('[data-section=\'section-software\']').click()"
                            class="group bg-slate-900/50 hover:bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-violet-500/50 transition cursor-pointer flex flex-col h-full relative overflow-hidden">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition transform group-hover:scale-110">
                                <i class="fa-brands fa-git-alt text-6xl text-violet-400"></i>
                            </div>
                            <h3 class="text-xl font-bold text-violet-400 mb-2 group-hover:translate-x-1 transition">
                                <i class="fa-brands fa-git-alt mr-2"></i>軟體與邏輯 (Software)
                            </h3>
                            <p class="text-sm text-slate-400 mb-4 flex-grow">
                                軟體棧 (Stack)、通訊協定與開發環境建置。
                            </p>
                            <div class="flex gap-2 text-xs">
                                <span
                                    class="bg-slate-800 px-2 py-1 rounded text-slate-300 border border-slate-700">PX4/Ardu</span>
                                <span
                                    class="bg-slate-800 px-2 py-1 rounded text-slate-300 border border-slate-700">Protocols</span>
                            </div>
                        </div>

                        <!-- Card 4: Control -->
                        <div onclick="document.querySelector('[data-section=\'section-pid\']').click()"
                            class="group bg-slate-900/50 hover:bg-slate-800 p-6 rounded-xl border border-slate-700 hover:border-emerald-500/50 transition cursor-pointer flex flex-col h-full relative overflow-hidden">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition transform group-hover:scale-110">
                                <i class="fa-solid fa-sliders text-6xl text-emerald-400"></i>
                            </div>
                            <h3 class="text-xl font-bold text-emerald-400 mb-2 group-hover:translate-x-1 transition">
                                <i class="fa-solid fa-sliders mr-2"></i>控制與專案 (Control)
                            </h3>
                            <p class="text-sm text-slate-400 mb-4 flex-grow">
                                PID 控制理論、系統調參與 AIoT 專案實作。
                            </p>
                            <div class="flex gap-2 text-xs">
                                <span
                                    class="bg-slate-800 px-2 py-1 rounded text-slate-300 border border-slate-700">PID</span>
                                <span
                                    class="bg-slate-800 px-2 py-1 rounded text-slate-300 border border-slate-700">Build</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ============================================================
         Part 1: 系統概觀與目標
         ============================================================ -->
                <section id="section-pid" class="mb-16 hidden animate-section relative">
                    <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-pid"></i>
                    <header class="mb-8 border-b border-slate-800 pb-4">
                        <h2 class="text-3xl font-bold text-slate-100 mb-2">PID 控制理論與實作 (Control Theory)</h2>
                        <div class="flex items-center gap-2 text-slate-400 text-sm">
                            <span class="source-badge badge-software">Control Loop</span>
                            <span>Inner & Outer Loop Tuning</span>
                        </div>
                    </header>

                    <div class="grid lg:grid-cols-2 gap-8">
                        <!-- Theory -->
                        <div class="space-y-6">
                            <div class="bg-slate-900 p-6 rounded-xl border border-slate-800 shadow-lg">
                                <h3 class="text-lg font-bold text-emerald-400 mb-4">標準 PID 公式 + 前饋 (Feed Forward)</h3>
                                <div class="bg-slate-950 p-4 rounded text-center border border-slate-700 mb-4">
                                    <p class="text-slate-200 text-sm mono-font">$$ u(t) = K_p e(t) + K_i \int_0^t
                                        e(\tau)d\tau +
                                        K_d \frac{de(t)}{dt} + FF $$</p>
                                </div>
                                <ul class="text-sm text-slate-300 space-y-3">
                                    <li><strong class="text-emerald-400">P (比例):</strong> 對抗當前誤差。過高會導致高頻震盪
                                        (Oscillation)。</li>
                                    <li><strong class="text-sky-400">I (積分):</strong> 消除穩態誤差 (如重心偏移)。過高會導致低頻畫圈。</li>
                                    <li><strong class="text-rose-400">D (微分):</strong> 預測趨勢，提供阻尼 (Damping)。對雜訊極敏感。</li>
                                    <li><strong class="text-amber-400">FF (前饋):</strong> 直接將目標指令轉換為輸出，大幅降低響應延遲。</li>
                                </ul>
                            </div>

                            <div class="bg-slate-900 p-6 rounded-xl border border-slate-800 shadow-lg">
                                <h3 class="text-lg font-bold text-violet-400 mb-4">串級 PID 架構 (Cascaded PID)</h3>
                                <div
                                    class="bg-slate-950 p-4 rounded border border-slate-700 text-xs font-mono text-slate-400 whitespace-pre overflow-x-auto">
                                    [搖桿指令 Target Angle]
                                    ↓ (外環 P: 姿態環 50-100Hz)
                                    [目標角速度 Target Rate]
                                    ↓ (內環 PID: 角速度環 400-800Hz)
                                    [馬達輸出 Motor Output]</div>
                            </div>
                        </div>

                        <!-- Simulation -->
                        <div class="bg-slate-900 p-6 rounded-xl border border-slate-800 shadow-lg flex flex-col">
                            <h3 class="text-lg font-bold text-sky-400 mb-4">閉迴路響應模擬 (Step Response)</h3>
                            <div
                                class="chart-container flex-1 min-h-[250px] bg-slate-950 rounded border border-slate-700 p-2 mb-4">
                                <canvas id="pidChart"></canvas>
                            </div>
                            <div class="flex flex-wrap justify-center gap-3">
                                <button onclick="updatePidChart('balanced')"
                                    class="px-3 py-1.5 bg-emerald-900/30 text-emerald-400 border border-emerald-800 rounded hover:bg-emerald-900/50 transition font-bold text-sm">完美調校</button>
                                <button onclick="updatePidChart('highP')"
                                    class="px-3 py-1.5 bg-rose-900/30 text-rose-400 border border-rose-800 rounded hover:bg-rose-900/50 transition font-bold text-sm">P值過高</button>
                                <button onclick="updatePidChart('lowD')"
                                    class="px-3 py-1.5 bg-amber-900/30 text-amber-400 border border-amber-800 rounded hover:bg-amber-900/50 transition font-bold text-sm">D值過低</button>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="section-tuning" class="mb-16 hidden animate-fade-in">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-3xl font-bold text-orange-400 flex items-center">
                            <i class="fa-solid fa-sliders mr-3"></i>系統測試與調參 (Testing & Tuning)
                        </h2>
                        <span class="bookmark-badge" data-section="section-tuning"><i
                                class="fa-regular fa-bookmark"></i></span>
                    </div>

                    <!-- 調參流程總覽 -->
                    <div
                        class="bg-gradient-to-r from-orange-900/20 to-red-900/20 border border-orange-500/30 rounded-lg p-6 mb-8">
                        <h3 class="text-xl font-bold text-orange-300 mb-4 flex items-center">
                            <i class="fa-solid fa-route mr-2"></i>調參流程總覽 (Tuning Workflow)
                        </h3>
                        <div class="bg-slate-900 p-5 rounded border border-slate-700">
                            <div class="grid md:grid-cols-5 gap-3 text-xs">
                                <div
                                    class="bg-gradient-to-br from-emerald-900/30 to-slate-900 p-4 rounded border border-emerald-500/50 text-center">
                                    <div class="text-3xl font-bold text-emerald-400 mb-2">1</div>
                                    <div class="font-bold text-emerald-300 mb-2">基礎檢查</div>
                                    <div class="text-slate-400 text-xs">
                                        • 重心校正<br>
                                        • 馬達方向<br>
                                        • 感測器校正<br>
                                        • 遙控器設定
                                    </div>
                                </div>
                                <div
                                    class="bg-gradient-to-br from-sky-900/30 to-slate-900 p-4 rounded border border-sky-500/50 text-center">
                                    <div class="text-3xl font-bold text-sky-400 mb-2">2</div>
                                    <div class="font-bold text-sky-300 mb-2">姿態調參</div>
                                    <div class="text-slate-400 text-xs">
                                        • Rate P/I/D<br>
                                        • 濾波器設定<br>
                                        • 前饋增益<br>
                                        • AutoTune
                                    </div>
                                </div>
                                <div
                                    class="bg-gradient-to-br from-purple-900/30 to-slate-900 p-4 rounded border border-purple-500/50 text-center">
                                    <div class="text-3xl font-bold text-purple-400 mb-2">3</div>
                                    <div class="font-bold text-purple-300 mb-2">位置調參</div>
                                    <div class="text-slate-400 text-xs">
                                        • 速度控制<br>
                                        • 位置控制<br>
                                        • 高度保持<br>
                                        • Loiter 測試
                                    </div>
                                </div>
                                <div
                                    class="bg-gradient-to-br from-pink-900/30 to-slate-900 p-4 rounded border border-pink-500/50 text-center">
                                    <div class="text-3xl font-bold text-pink-400 mb-2">4</div>
                                    <div class="font-bold text-pink-300 mb-2">進階功能</div>
                                    <div class="text-slate-400 text-xs">
                                        • 任務飛行<br>
                                        • 失效保護<br>
                                        • 地理圍欄<br>
                                        • 避障測試
                                    </div>
                                </div>
                                <div
                                    class="bg-gradient-to-br from-amber-900/30 to-slate-900 p-4 rounded border border-amber-500/50 text-center">
                                    <div class="text-3xl font-bold text-amber-400 mb-2">5</div>
                                    <div class="font-bold text-amber-300 mb-2">性能優化</div>
                                    <div class="text-slate-400 text-xs">
                                        • 日誌分析<br>
                                        • 振動檢查<br>
                                        • 續航優化<br>
                                        • 最終驗證
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 第一階段：基礎檢查 -->
                    <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                        <h3 class="text-xl font-bold text-emerald-300 mb-4 flex items-center">
                            <i class="fa-solid fa-clipboard-check mr-2"></i>第一階段：基礎檢查 (Pre-flight Checks)
                        </h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <!-- 硬體檢查清單 -->
                            <div class="bg-slate-950 p-5 rounded border border-emerald-500/30">
                                <div class="text-lg font-bold text-emerald-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-wrench mr-2"></i>硬體檢查清單
                                </div>
                                <div class="space-y-2">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="checkbox" class="w-4 h-4 text-emerald-500 rounded mr-3">
                                            <div class="flex-1">
                                                <div class="font-bold text-slate-300 text-sm">重心檢查</div>
                                                <div class="text-xs text-slate-400">用手指支撐機架中心，確保水平平衡</div>
                                            </div>
                                        </label>
                                    </div>
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="checkbox" class="w-4 h-4 text-emerald-500 rounded mr-3">
                                            <div class="flex-1">
                                                <div class="font-bold text-slate-300 text-sm">螺旋槳安裝</div>
                                                <div class="text-xs text-slate-400">檢查正反槳、鎖緊螺母、無裂痕</div>
                                            </div>
                                        </label>
                                    </div>
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="checkbox" class="w-4 h-4 text-emerald-500 rounded mr-3">
                                            <div class="flex-1">
                                                <div class="font-bold text-slate-300 text-sm">馬達轉向</div>
                                                <div class="text-xs text-slate-400">低油門測試，確認符合 X 型佈局</div>
                                            </div>
                                        </label>
                                    </div>
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="checkbox" class="w-4 h-4 text-emerald-500 rounded mr-3">
                                            <div class="flex-1">
                                                <div class="font-bold text-slate-300 text-sm">接線檢查</div>
                                                <div class="text-xs text-slate-400">所有連接器牢固、無短路、絕緣良好</div>
                                            </div>
                                        </label>
                                    </div>
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <label class="flex items-center cursor-pointer">
                                            <input type="checkbox" class="w-4 h-4 text-emerald-500 rounded mr-3">
                                            <div class="flex-1">
                                                <div class="font-bold text-slate-300 text-sm">電池檢查</div>
                                                <div class="text-xs text-slate-400">電壓 &gt; 3.7V/cell、無膨脹、XT60 接頭完好
                                                </div>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- 軟體校正步驟 -->
                            <div class="bg-slate-950 p-5 rounded border border-sky-500/30">
                                <div class="text-lg font-bold text-sky-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-microchip mr-2"></i>感測器校正步驟
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="font-bold text-sky-300 text-sm flex items-center">
                                                <i class="fa-solid fa-compass mr-2"></i>加速度計校正
                                            </div>
                                            <span class="px-2 py-1 bg-sky-900/30 text-sky-300 rounded text-xs">必須</span>
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            Mission Planner → Initial Setup → Accel Calibration<br>
                                            依序放置六個面，每面保持靜止 5 秒
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="font-bold text-purple-300 text-sm flex items-center">
                                                <i class="fa-solid fa-magnet mr-2"></i>羅盤校正
                                            </div>
                                            <span
                                                class="px-2 py-1 bg-purple-900/30 text-purple-300 rounded text-xs">必須</span>
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            戶外開闊環境，遠離金屬物體<br>
                                            旋轉無人機完成 360° × 3 軸校正
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="font-bold text-emerald-300 text-sm flex items-center">
                                                <i class="fa-solid fa-radio mr-2"></i>遙控器校正
                                            </div>
                                            <span
                                                class="px-2 py-1 bg-emerald-900/30 text-emerald-300 rounded text-xs">必須</span>
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            Radio Calibration → 移動所有搖桿至極限位置<br>
                                            檢查通道映射：AETR (Aileron/Elevator/Throttle/Rudder)
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="font-bold text-amber-300 text-sm flex items-center">
                                                <i class="fa-solid fa-battery-half mr-2"></i>ESC 校正
                                            </div>
                                            <span
                                                class="px-2 py-1 bg-amber-900/30 text-amber-300 rounded text-xs">選配</span>
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            使用 DShot 協定可跳過<br>
                                            傳統 PWM 需要：油門最大 → 接電 → 聽到嗶聲 → 油門最小
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 馬達測試 -->
                        <div class="mt-6 bg-slate-950 p-5 rounded border border-orange-500/30">
                            <div class="text-lg font-bold text-orange-400 mb-3 flex items-center">
                                <i class="fa-solid fa-fan mr-2"></i>馬達測試 (Motor Test)
                            </div>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div class="bg-slate-900 p-4 rounded border border-slate-700">
                                    <div class="font-bold text-slate-300 mb-3 text-sm">X 型佈局馬達編號</div>
                                    <div class="relative bg-slate-950 p-6 rounded border border-slate-700">
                                        <div
                                            class="absolute top-4 left-4 w-12 h-12 bg-emerald-500 rounded-full flex items-center justify-center font-bold text-white">
                                            1<br><span class="text-xs">CCW</span>
                                        </div>
                                        <div
                                            class="absolute top-4 right-4 w-12 h-12 bg-sky-500 rounded-full flex items-center justify-center font-bold text-white">
                                            2<br><span class="text-xs">CW</span>
                                        </div>
                                        <div
                                            class="absolute bottom-4 right-4 w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center font-bold text-white">
                                            3<br><span class="text-xs">CCW</span>
                                        </div>
                                        <div
                                            class="absolute bottom-4 left-4 w-12 h-12 bg-pink-500 rounded-full flex items-center justify-center font-bold text-white">
                                            4<br><span class="text-xs">CW</span>
                                        </div>
                                        <div class="w-full h-32 flex items-center justify-center">
                                            <div class="text-slate-500 text-sm">前方 ↑</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-slate-900 p-4 rounded border border-slate-700">
                                    <div class="font-bold text-slate-300 mb-3 text-sm">Mission Planner 測試步驟</div>
                                    <div class="space-y-2 text-xs">
                                        <div class="flex items-start">
                                            <div
                                                class="bg-orange-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                1</div>
                                            <div class="text-slate-300">
                                                <strong>拆除螺旋槳</strong> (安全第一！)
                                            </div>
                                        </div>
                                        <div class="flex items-start">
                                            <div
                                                class="bg-orange-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                2</div>
                                            <div class="text-slate-300">
                                                Initial Setup → Optional Hardware → <strong>Motor Test</strong>
                                            </div>
                                        </div>
                                        <div class="flex items-start">
                                            <div
                                                class="bg-orange-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                3</div>
                                            <div class="text-slate-300">
                                                依序測試馬達 A/B/C/D (對應 1/2/3/4)
                                            </div>
                                        </div>
                                        <div class="flex items-start">
                                            <div
                                                class="bg-orange-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                4</div>
                                            <div class="text-slate-300">
                                                油門設定 <strong>5%</strong>，持續時間 <strong>2 秒</strong>
                                            </div>
                                        </div>
                                        <div class="flex items-start">
                                            <div
                                                class="bg-orange-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                5</div>
                                            <div class="text-slate-300">
                                                檢查轉向：1/3 逆時針 (CCW)、2/4 順時針 (CW)
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mt-3 p-3 bg-red-900/20 border border-red-500/30 rounded">
                                        <div class="text-xs text-red-300 flex items-start">
                                            <i class="fa-solid fa-exclamation-triangle mr-2 mt-1"></i>
                                            <span><strong>警告</strong>：馬達測試時務必拆除螺旋槳，避免意外傷害！</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 第二階段：姿態調參 -->
                    <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                        <h3 class="text-xl font-bold text-sky-300 mb-4 flex items-center">
                            <i class="fa-solid fa-rotate mr-2"></i>第二階段：姿態調參 (Attitude Tuning)
                        </h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <!-- PID 參數說明 -->
                            <div class="bg-slate-950 p-5 rounded border border-sky-500/30">
                                <div class="text-lg font-bold text-sky-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-calculator mr-2"></i>PID 參數說明
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-emerald-400 text-sm mb-2 flex items-center">
                                            <span
                                                class="w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center text-white mr-2">P</span>
                                            比例增益 (Proportional)
                                        </div>
                                        <div class="text-xs text-slate-400 space-y-1">
                                            <div>• <strong class="text-emerald-300">作用</strong>：誤差越大，修正力度越大</div>
                                            <div>• <strong class="text-amber-300">過高</strong>：震盪、過衝</div>
                                            <div>• <strong class="text-red-300">過低</strong>：反應遲鈍、無法穩定</div>
                                            <div class="mono-font text-sky-300">ATC_RAT_RLL_P: 0.135 (Example)</div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-purple-400 text-sm mb-2 flex items-center">
                                            <span
                                                class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white mr-2">I</span>
                                            積分增益 (Integral)
                                        </div>
                                        <div class="text-xs text-slate-400 space-y-1">
                                            <div>• <strong class="text-purple-300">作用</strong>：消除穩態誤差 (如風漂)</div>
                                            <div>• <strong class="text-amber-300">過高</strong>：積分飽和、慢震盪</div>
                                            <div>• <strong class="text-red-300">過低</strong>：無法抗風、位置漂移</div>
                                            <div class="mono-font text-sky-300">ATC_RAT_RLL_I: 0.135 (預設)</div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-pink-400 text-sm mb-2 flex items-center">
                                            <span
                                                class="w-8 h-8 bg-pink-500 rounded-full flex items-center justify-center text-white mr-2">D</span>
                                            微分增益 (Derivative)
                                        </div>
                                        <div class="text-xs text-slate-400 space-y-1">
                                            <div>• <strong class="text-pink-300">作用</strong>：阻尼震盪、預測趨勢</div>
                                            <div>• <strong class="text-amber-300">過高</strong>：對噪音敏感、高頻震盪</div>
                                            <div>• <strong class="text-red-300">過低</strong>：過衝、震盪衰減慢</div>
                                            <div class="mono-font text-sky-300">ATC_RAT_RLL_D: 0.0036 (預設)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- AutoTune 使用指南 -->
                            <div class="bg-slate-950 p-5 rounded border border-orange-500/30">
                                <div class="text-lg font-bold text-orange-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-wand-magic-sparkles mr-2"></i>AutoTune 使用指南
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-amber-900/20 border border-amber-500 p-3 rounded">
                                        <strong class="text-amber-400">⚠️ AutoTune 執行條件</strong>
                                        <ul class="text-xs text-slate-300 mt-2 space-y-1">
                                            <li class="flex items-start">
                                                <span>• 電池電量 &gt; 50%</span>
                                            </li>
                                            <li class="flex items-start">
                                                <span>• 風速 &lt; 3 m/s (微風)</span>
                                            </li>
                                            <li class="flex items-start">
                                                <span>• 開闊場地，半徑 &gt; 50m</span>
                                            </li>
                                            <li class="flex items-start">
                                                <span>• 飛手需熟悉手動模式以應對異常</span>
                                            </li>
                                            <li class="flex items-start">
                                                <span>• 飛行高度 5~10 米</span>
                                            </li>
                                        </ul>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-sky-300 text-sm mb-2">操作步驟</div>
                                        <div class="space-y-2 text-xs">
                                            <div class="flex items-start">
                                                <div
                                                    class="bg-sky-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                    1</div>
                                                <div class="text-slate-300">
                                                    設定 <strong class="mono-font text-purple-400">AUTOTUNE_AXES =
                                                        7</strong>
                                                    (Roll/Pitch/Yaw)
                                                </div>
                                            </div>
                                            <div class="flex items-start">
                                                <div
                                                    class="bg-sky-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                    2</div>
                                                <div class="text-slate-300">
                                                    分配遙控器開關至 <strong class="mono-font text-emerald-400">CH7 =
                                                        AutoTune</strong>
                                                </div>
                                            </div>
                                            <div class="flex items-start">
                                                <div
                                                    class="bg-sky-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                    3</div>
                                                <div class="text-slate-300">
                                                    切換至 <strong class="text-amber-400">AltHold 模式</strong>，懸停穩定
                                                </div>
                                            </div>
                                            <div class="flex items-start">
                                                <div
                                                    class="bg-sky-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                    4</div>
                                                <div class="text-slate-300">
                                                    開啟 AutoTune 開關，無人機開始<strong class="text-pink-400">自動搖擺測試</strong>
                                                </div>
                                            </div>
                                            <div class="flex items-start">
                                                <div
                                                    class="bg-sky-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                    5</div>
                                                <div class="text-slate-300">
                                                    等待 <strong>5~10 分鐘 (大型機約 20-30 分鐘)</strong>，完成後自動停止
                                                </div>
                                            </div>
                                            <div class="flex items-start">
                                                <div
                                                    class="bg-sky-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold mr-2 mt-0.5 flex-shrink-0">
                                                    6</div>
                                                <div class="text-slate-300">
                                                    降落後<strong class="text-emerald-400">重新上電</strong>以保存參數
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-amber-900/20 border border-amber-500/30 p-3 rounded">
                                        <div class="text-xs text-amber-300 flex items-start">
                                            <i class="fa-solid fa-lightbulb mr-2 mt-1"></i>
                                            <span><strong>提示</strong>：AutoTune 過程中可隨時關閉開關恢復手動控制，已調整的參數會暫存</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 濾波器設定 -->
                        <div class="mt-6 bg-slate-950 p-5 rounded border border-purple-500/30">
                            <div class="text-lg font-bold text-purple-400 mb-3 flex items-center">
                                <i class="fa-solid fa-filter mr-2"></i>濾波器設定 (Filter Configuration)
                            </div>
                            <div class="grid md:grid-cols-3 gap-4">
                                <div class="bg-slate-900 p-4 rounded border border-slate-700">
                                    <div class="font-bold text-sky-400 text-sm mb-3">陷波濾波器 (Notch Filter)</div>
                                    <div class="space-y-2 text-xs">
                                        <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                            <span class="text-slate-400 mono-font">INS_HNTCH_ENABLE</span>
                                            <span class="text-emerald-400 font-bold">1</span>
                                        </div>
                                        <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                            <span class="text-slate-400 mono-font">INS_HNTCH_FREQ</span>
                                            <span class="text-sky-400 font-bold">80 Hz (Typical)</span>
                                        </div>
                                        <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                            <span class="text-slate-400 mono-font">INS_HNTCH_BW</span>
                                            <span class="text-purple-400 font-bold">40 Hz</span>
                                        </div>
                                        <div class="text-slate-400 mt-2">
                                            <strong class="text-purple-300">用途</strong>：濾除馬達振動頻率 (Based on 2216
                                            Motor/10" Prop)
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-slate-900 p-4 rounded border border-slate-700">
                                    <div class="font-bold text-emerald-400 text-sm mb-3">低通濾波器 (Low-pass)</div>
                                    <div class="space-y-2 text-xs">
                                        <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                            <span class="text-slate-400 mono-font">INS_GYRO_FILTER</span>
                                            <span class="text-emerald-400 font-bold">80 Hz</span>
                                        </div>
                                        <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                            <span class="text-slate-400 mono-font">INS_ACCEL_FILTER</span>
                                            <span class="text-sky-400 font-bold">20 Hz</span>
                                        </div>
                                        <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                            <span class="text-slate-400 mono-font">ATC_RAT_RLL_FLTD</span>
                                            <span class="text-purple-400 font-bold">20 Hz</span>
                                        </div>
                                        <div class="text-slate-400 mt-2">
                                            <strong class="text-emerald-300">用途</strong>：濾除高頻噪音
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-slate-900 p-4 rounded border border-slate-700">
                                    <div class="font-bold text-pink-400 text-sm mb-3">動態濾波器 (Dynamic)</div>
                                    <div class="space-y-2 text-xs">
                                        <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                            <span class="text-slate-400 mono-font">INS_HNTCH_MODE</span>
                                            <span class="text-emerald-400 font-bold">1 (Throttle)</span>
                                        </div>
                                        <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                            <span class="text-slate-400 mono-font">INS_HNTCH_REF</span>
                                            <span class="text-sky-400 font-bold">0.15</span>
                                        </div>
                                        <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                            <span class="text-slate-400 mono-font">INS_HNTCH_ATT</span>
                                            <span class="text-purple-400 font-bold">40 dB</span>
                                        </div>
                                        <div class="text-slate-400 mt-2">
                                            <strong class="text-pink-300">用途</strong>：隨油門動態調整
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 第三階段：位置調參 -->
                    <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                        <h3 class="text-xl font-bold text-purple-300 mb-4 flex items-center">
                            <i class="fa-solid fa-location-dot mr-2"></i>第三階段：位置調參 (Position Control)
                        </h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <!-- 速度控制器 -->
                            <div class="bg-slate-950 p-5 rounded border border-purple-500/30">
                                <div class="text-lg font-bold text-purple-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-gauge-high mr-2"></i>速度控制器
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-sky-400 text-sm mb-2">水平速度參數</div>
                                        <div class="space-y-2 text-xs">
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400 mono-font">PSC_VELXY_P</span>
                                                <span class="text-emerald-400 font-bold">1.0</span>
                                            </div>
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400 mono-font">PSC_VELXY_I</span>
                                                <span class="text-sky-400 font-bold">0.5</span>
                                            </div>
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400 mono-font">PSC_VELXY_D</span>
                                                <span class="text-purple-400 font-bold">0.0</span>
                                            </div>
                                            <div class="text-slate-400 mt-2">
                                                <strong class="text-emerald-300">調整建議</strong>：P 增大 → 速度響應更快<br>
                                                I 增大 → 抗風能力更強
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-emerald-400 text-sm mb-2">垂直速度參數</div>
                                        <div class="space-y-2 text-xs">
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400 mono-font">PSC_VELZ_P</span>
                                                <span class="text-emerald-400 font-bold">5.0</span>
                                            </div>
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400 mono-font">PSC_ACCZ_P</span>
                                                <span class="text-sky-400 font-bold">0.5</span>
                                            </div>
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400 mono-font">PSC_ACCZ_I</span>
                                                <span class="text-purple-400 font-bold">1.0</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 位置控制器 -->
                            <div class="bg-slate-950 p-5 rounded border border-pink-500/30">
                                <div class="text-lg font-bold text-pink-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-crosshairs mr-2"></i>位置控制器
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-pink-400 text-sm mb-2">Loiter 模式參數</div>
                                        <div class="space-y-2 text-xs">
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400 mono-font">PSC_POSXY_P</span>
                                                <span class="text-emerald-400 font-bold">1.0</span>
                                            </div>
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400 mono-font">PSC_POSZ_P</span>
                                                <span class="text-sky-400 font-bold">1.0</span>
                                            </div>
                                            <div class="text-slate-400 mt-2">
                                                <strong class="text-pink-300">測試方法</strong>：<br>
                                                1. 切換至 Loiter 模式<br>
                                                2. 輕推搖桿移動 5 米<br>
                                                3. 鬆開搖桿，觀察剎車距離<br>
                                                4. 理想：1 秒內停止，偏移 &lt; 1 米
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-amber-400 text-sm mb-2">常見問題</div>
                                        <div class="space-y-2 text-xs text-slate-400">
                                            <div class="flex items-start">
                                                <i class="fa-solid fa-circle-question text-amber-400 mr-2 mt-1"></i>
                                                <div>
                                                    <strong class="text-slate-300">剎車距離過長</strong><br>
                                                    → 增大 PSC_VELXY_P (如 1.0 → 1.2)
                                                </div>
                                            </div>
                                            <div class="flex items-start">
                                                <i class="fa-solid fa-circle-question text-amber-400 mr-2 mt-1"></i>
                                                <div>
                                                    <strong class="text-slate-300">位置漂移嚴重</strong><br>
                                                    → 增大 PSC_VELXY_I (如 0.5 → 0.8)
                                                </div>
                                            </div>
                                            <div class="flex items-start">
                                                <i class="fa-solid fa-circle-question text-amber-400 mr-2 mt-1"></i>
                                                <div>
                                                    <strong class="text-slate-300">定點震盪</strong><br>
                                                    → 減小 PSC_POSXY_P (如 1.0 → 0.8)
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 日誌分析 -->
                    <div class="bg-gradient-to-r from-slate-900 to-slate-800 border border-slate-700 rounded-lg p-6">
                        <h3 class="text-xl font-bold text-amber-300 mb-4 flex items-center">
                            <i class="fa-solid fa-chart-line mr-2"></i>日誌分析 (Log Analysis)
                        </h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <!-- 振動檢查 -->
                            <div class="bg-slate-950 p-5 rounded border border-amber-500/30">
                                <div class="text-lg font-bold text-amber-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-wave-square mr-2"></i>振動檢查
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-sky-400 text-sm mb-2">檢查項目</div>
                                        <div class="space-y-2 text-xs">
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400">IMU.AccX/Y/Z</span>
                                                <span class="text-emerald-400 font-bold">&lt; 30 m/s²</span>
                                            </div>
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400">Clipping (削波)</span>
                                                <span class="text-emerald-400 font-bold">&lt; 1%</span>
                                            </div>
                                            <div class="flex justify-between items-center p-2 bg-slate-950 rounded">
                                                <span class="text-slate-400">EKF Variance</span>
                                                <span class="text-emerald-400 font-bold">&lt; 0.3</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-red-400 text-sm mb-2">振動過高解決方案</div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li class="flex items-start">
                                                <i class="fa-solid fa-wrench text-emerald-400 mr-2 mt-1"></i>
                                                <span>檢查螺旋槳平衡 (動平衡)</span>
                                            </li>
                                            <li class="flex items-start">
                                                <i class="fa-solid fa-wrench text-emerald-400 mr-2 mt-1"></i>
                                                <span>更換減震墊 (3M VHB 泡棉)</span>
                                            </li>
                                            <li class="flex items-start">
                                                <i class="fa-solid fa-wrench text-emerald-400 mr-2 mt-1"></i>
                                                <span>檢查馬達軸承磨損</span>
                                            </li>
                                            <li class="flex items-start">
                                                <i class="fa-solid fa-wrench text-emerald-400 mr-2 mt-1"></i>
                                                <span>機架螺絲是否鬆動</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- PID 響應分析 -->
                            <div class="bg-slate-950 p-5 rounded border border-sky-500/30">
                                <div class="text-lg font-bold text-sky-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-chart-area mr-2"></i>PID 響應分析
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-purple-400 text-sm mb-2">理想響應曲線</div>
                                        <div class="text-xs text-slate-400 space-y-2">
                                            <div>
                                                <strong class="text-emerald-300">期望值 (Desired)</strong> vs <strong
                                                    class="text-sky-300">實際值 (Actual)</strong>
                                            </div>
                                            <div class="bg-slate-950 p-3 rounded">
                                                <div class="flex items-center justify-between mb-2">
                                                    <span class="text-slate-500">時間 →</span>
                                                </div>
                                                <svg viewBox="0 0 200 80" class="w-full h-20">
                                                    <line x1="10" y1="70" x2="190" y2="70" stroke="#475569"
                                                        stroke-width="1" />
                                                    <line x1="10" y1="10" x2="10" y2="70" stroke="#475569"
                                                        stroke-width="1" />
                                                    <!-- 期望值 (階躍) -->
                                                    <path d="M 10 70 L 30 70 L 30 30 L 190 30" stroke="#10b981"
                                                        stroke-width="2" fill="none" />
                                                    <!-- 實際值 (良好響應) -->
                                                    <path d="M 10 70 L 30 70 Q 50 20, 70 30 Q 80 35, 90 30 L 190 30"
                                                        stroke="#0ea5e9" stroke-width="2" fill="none"
                                                        stroke-dasharray="3,3" />
                                                </svg>
                                                <div class="flex justify-between text-xs mt-1">
                                                    <span class="text-emerald-400">— 期望</span>
                                                    <span class="text-sky-400">- - 實際</span>
                                                </div>
                                            </div>
                                            <div class="text-slate-500">
                                                <strong class="text-slate-300">特徵</strong>：快速響應、輕微過衝、快速穩定
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-pink-400 text-sm mb-2">Mission Planner 分析</div>
                                        <div class="text-xs text-slate-400 space-y-1">
                                            <div>1. Flight Data → DataFlash Logs → <strong class="text-sky-300">Download
                                                    Log</strong></div>
                                            <div>2. 使用 <strong class="text-purple-300">MAVExplorer</strong> 或 <strong
                                                    class="text-emerald-300">UAV Log Viewer</strong></div>
                                            <div>3. 繪製圖表：
                                                <div class="mono-font text-amber-300 ml-4 mt-1">
                                                    ATT.Roll vs ATT.DesRoll<br>
                                                    RATE.R vs RATE.RDes
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="section-build-aiot" class="mb-16 hidden animate-section relative">
                    <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-build-aiot"></i>
                    <header class="mb-8 border-b border-slate-800 pb-4">
                        <h2 class="text-3xl font-bold text-slate-100 mb-2">X500-AIoT-V1 硬體採購與架構 (Procurement)</h2>
                        <div class="flex items-center gap-2 text-slate-400 text-sm">
                            <span class="source-badge badge-procurement">Project Spec</span>
                            <span>2026/02/12 Updated</span>
                        </div>
                    </header>

                    <div class="grid lg:grid-cols-3 gap-8">
                        <!-- Left: BOM -->
                        <div class="lg:col-span-2 space-y-8">
                            <!-- Flight Platform -->
                            <div class="bg-slate-900 rounded-xl border border-slate-800 overflow-hidden">
                                <div class="px-6 py-4 bg-slate-950 border-b border-slate-800 flex justify-between">
                                    <h3 class="font-bold text-sky-400">1. 核心飛行平台 (Flight Platform)</h3>
                                    <span class="text-xs text-slate-500">底層控制與動力</span>
                                </div>
                                <table class="w-full text-sm text-left text-slate-400">
                                    <tbody class="divide-y divide-slate-800">
                                        <tr>
                                            <td class="p-4"><strong class="text-white block">Holybro X500 V2
                                                    ARF</strong><span class="text-xs">含馬達 2216/920KV, 電變 20A, PDB</span>
                                            </td>
                                            <td class="p-4 text-right">ARF 預焊版節省佈線時間。</td>
                                        </tr>
                                        <tr>
                                            <td class="p-4"><strong class="text-white block">Pixhawk 6C (Alu
                                                    Case)</strong><span class="text-xs">STM32H743 + F103</span></td>
                                            <td class="p-4 text-right">鋁殼版抗 EMI 干擾能力較佳。</td>
                                        </tr>
                                        <tr>
                                            <td class="p-4"><strong class="text-white block">Holybro M10
                                                    GPS</strong><span class="text-xs">u-blox M10 Chip</span></td>
                                            <td class="p-4 text-right">多星系定位，冷啟動快。</td>
                                        </tr>
                                        <tr>
                                            <td class="p-4"><strong class="text-white block">RadioMaster
                                                    RP1</strong><span class="text-xs">ELRS 2.4GHz</span></td>
                                            <td class="p-4 text-right">CRSF 協定，低延遲控制。</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- Edge AI -->
                            <div class="bg-slate-900 rounded-xl border border-slate-800 overflow-hidden">
                                <div class="px-6 py-4 bg-slate-950 border-b border-slate-800 flex justify-between">
                                    <h3 class="font-bold text-violet-400">2. 邊緣運算與視覺 (Edge AI)</h3>
                                    <span class="text-xs text-slate-500">YOLOv8 / VSLAM</span>
                                </div>
                                <table class="w-full text-sm text-left text-slate-400">
                                    <tbody class="divide-y divide-slate-800">
                                        <tr>
                                            <td class="p-4"><strong class="text-white block">Raspberry Pi 5
                                                    (8GB)</strong><span class="text-xs">Cortex-A76 Quad</span></td>
                                            <td class="p-4 text-right">8GB 適合跑 YOLOv8 Nano/Small。</td>
                                        </tr>
                                        <tr>
                                            <td class="p-4"><strong class="text-white block">Active Cooler</strong><span
                                                    class="text-xs">原廠主動散熱</span></td>
                                            <td class="p-4 text-right">防止 AI 全速運算時熱降頻。</td>
                                        </tr>
                                        <tr>
                                            <td class="p-4"><strong class="text-white block">Global Shutter
                                                    Cam</strong><span class="text-xs">Raspberry Pi GS / OAK-D</span>
                                            </td>
                                            <td class="p-4 text-right">全域快門消除飛行果凍效應 (Jello)。</td>
                                        </tr>
                                        <tr>
                                            <td class="p-4 border-l-4 border-rose-500 bg-rose-900/10"><strong
                                                    class="text-rose-300 block">UBEC 5.1V/5A (Low Noise)</strong><span
                                                    class="text-xs">Matek/Mauch 等級</span></td>
                                            <td class="p-4 text-right text-rose-300">Pi 5 需獨立低壓降供電，不可吃飛控電源！</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Right: Topology & Notes -->
                        <div class="space-y-8">
                            <!-- Topology Visualized -->
                            <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                                <h3 class="font-bold text-emerald-400 mb-4"><i
                                        class="fa-solid fa-sitemap mr-2"></i>系統整合架構</h3>
                                <div class="topo-container text-xs">
                                    <div class="topo-box border-l-accent border-rose-500">
                                        <h4 class="text-rose-400">⚡ 電源層 (Power)</h4>
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="bg-slate-800 px-2 py-1 rounded">LiPo 4S</span>
                                            <i class="fa-solid fa-arrow-right text-slate-600"></i>
                                            <span class="bg-slate-800 px-2 py-1 rounded">PDB</span>
                                        </div>
                                        <div class="space-y-1 pl-2 border-l border-slate-700">
                                            <div class="flex justify-between"><span>➡ Power Module</span> <span
                                                    class="text-sky-400">Pixhawk</span></div>
                                            <div class="flex justify-between"><span>➡ XT30/UBEC</span> <span
                                                    class="text-violet-400">RPi 5</span></div>
                                        </div>
                                    </div>
                                    <div class="topo-box border-l-accent border-sky-500">
                                        <h4 class="text-sky-400">🎮 控制層 (Control)</h4>
                                        <div class="flex justify-between">
                                            <span class="bg-slate-800 px-2 py-1 rounded">Pixhawk 6C</span>
                                            <span class="text-slate-500 text-center">TELEM2<br>921600</span>
                                            <span class="bg-slate-800 px-2 py-1 rounded">RPi 5</span>
                                        </div>
                                    </div>
                                    <div class="topo-box border-l-accent border-violet-500">
                                        <h4 class="text-violet-400">🧠 AI 層 (Vision)</h4>
                                        <div class="flex flex-col gap-2">
                                            <div class="flex justify-between"><span>RPi 5</span> <i
                                                    class="fa-solid fa-link"></i> <span>Global Cam</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Tech Notes -->
                            <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                                <h3 class="font-bold text-amber-400 mb-4"><i
                                        class="fa-solid fa-user-graduate mr-2"></i>工程師筆記
                                </h3>
                                <ul class="text-sm text-slate-300 space-y-3 list-disc list-inside">
                                    <li><strong class="text-white">供電隔離:</strong> Pi 5 運算突波極大，務必使用低壓降 UBEC 調至 5.1V 補償線損。
                                    </li>
                                    <li><strong class="text-white">散熱干擾:</strong> Active Cooler 的 PWM 訊號有微弱 EMI，請與 GPS
                                        桅杆保持物理距離。
                                    </li>
                                    <li><strong class="text-white">避震:</strong> 全域快門相機仍需矽膠減震球，避免高頻震動影響 IMU/影像。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="section-logs" class="mb-16 hidden animate-section relative">
                    <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-logs"></i>
                    <header class="mb-8 border-b border-slate-800 pb-4">
                        <h2 class="text-3xl font-bold text-slate-100 mb-2">專案實作日誌與 SOP (Project Logs & SOP)</h2>
                        <div class="flex items-center gap-2 text-slate-400 text-sm">
                            <span class="source-badge badge-log">實作紀錄</span>
                            <span>2026/02/12 更新 (X500-V2)</span>
                        </div>
                    </header>

                    <div class="bg-slate-900 rounded-xl border border-slate-800 overflow-hidden mb-8">
                        <div class="flex border-b border-slate-800 bg-slate-950 overflow-x-auto">
                            <button onclick="switchLogsTab('status')" id="tab-log-status"
                                class="px-6 py-4 text-sm font-bold text-amber-400 bg-slate-900 border-r border-slate-800 transition whitespace-nowrap">專案現況
                                (Status)</button>
                            <button onclick="switchLogsTab('sop')" id="tab-log-sop"
                                class="px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap">SOP
                                配置指南 (Configuration)</button>
                        </div>

                        <!-- Tab 1: Status -->
                        <div id="content-logs-status" class="p-6 md:p-8 animate-fade-in">
                            <div class="flex justify-between items-center mb-6">
                                <div>
                                    <h3 class="text-xl font-bold text-amber-400"><i
                                            class="fa-solid fa-helicopter mr-2"></i>Holybro X500 V2 系統整合</h3>
                                    <p class="text-sm text-slate-400 mt-1">Pixhawk 6C / PX4 v1.14.x / Operator: Marlon
                                    </p>
                                </div>
                                <div class="text-right">
                                    <span
                                        class="bg-emerald-900/30 text-emerald-400 px-3 py-1 rounded text-sm font-bold border border-emerald-800">Flight
                                        Ready</span>
                                </div>
                            </div>
                            <div class="grid md:grid-cols-2 gap-6">
                                <div class="bg-slate-900 p-4 rounded border border-slate-700">
                                    <strong class="text-sky-400 block mb-2">系統驗收狀態</strong>
                                    <ul class="text-sm text-slate-300 space-y-2">
                                        <li><i class="fa-solid fa-check text-emerald-500 mr-2"></i><strong>機架:</strong>
                                            Holybro
                                            X500 V2 (Quad X)</li>
                                        <li><i class="fa-solid fa-check text-emerald-500 mr-2"></i><strong>感測器:</strong>
                                            Accel,
                                            Gyro, Mag, Level 校正完成</li>
                                        <li><i class="fa-solid fa-check text-emerald-500 mr-2"></i><strong>動力:</strong>
                                            馬達轉向驗證通過
                                            (1000-2000us PWM)</li>
                                        <li><i class="fa-regular fa-square text-slate-500 mr-2"></i><strong>遙控:</strong>
                                            R81
                                            接收機安裝校正完成</li>
                                    </ul>
                                </div>
                                <div class="bg-slate-900 p-4 rounded border border-slate-700">
                                    <strong class="text-amber-400 block mb-2">架構操作定義</strong>
                                    <table class="w-full text-xs text-left text-slate-400">
                                        <thead>
                                            <tr>
                                                <th class="pb-1">組件</th>
                                                <th class="pb-1">連線</th>
                                                <th class="pb-1">功能定義</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-slate-800">
                                            <tr>
                                                <td class="py-1">QGC (PC)</td>
                                                <td>USB</td>
                                                <td>工廠配置、韌體更新</td>
                                            </tr>
                                            <tr>
                                                <td class="py-1">QGC (PC)</td>
                                                <td>433MHz</td>
                                                <td>地面站監控 (Telemetry)</td>
                                            </tr>
                                            <tr>
                                                <td class="py-1">RC (TX16S)</td>
                                                <td>2.4GHz</td>
                                                <td>即時姿態控制 (Real-time)</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Tab 2: SOP -->
                        <div id="content-logs-sop" class="hidden p-6 md:p-8 animate-fade-in">
                            <div class="space-y-6">
                                <div class="bg-slate-900 p-4 rounded border border-slate-800">
                                    <h4
                                        class="text-lg font-bold text-emerald-400 mb-3 border-l-4 border-emerald-500 pl-3">
                                        1.
                                        感測器校正 (Calibration)</h4>
                                    <p class="text-sm text-slate-300 mb-2"><strong>加速度計 (Wall-Assist):</strong> 針對 Nose
                                        Down
                                        超時問題，採用「靠牆法」物理固定機身，消除手持微震動。驗證 Z 軸 ≈ 9.8 m/s²。</p>
                                    <p class="text-sm text-slate-300 mb-2"><strong>羅盤:</strong> 旋轉機身 6 面。若報錯
                                        "Inconsistent"，需重啟或遠離磁干擾。</p>
                                    <p class="text-xs text-slate-500 italic mt-2">*校正後務必斷電重啟以更新 EKF。</p>
                                </div>

                                <div class="grid md:grid-cols-2 gap-6">
                                    <div class="bg-slate-900 p-4 rounded border border-slate-800">
                                        <h4 class="text-lg font-bold text-sky-400 mb-3 border-l-4 border-sky-500 pl-3">
                                            2.
                                            遙控器對頻與配置</h4>
                                        <ul class="text-sm text-slate-300 space-y-1">
                                            <li><strong>TX16S:</strong> Mode 2 (左手油門)</li>
                                            <li><strong>Internal RF:</strong> FrSkyX2 (D16)</li>
                                            <li><strong>通道驗證:</strong> 右手搖桿向右 &rarr; QGC Roll 數值增加。</li>
                                        </ul>
                                    </div>
                                    <div class="bg-slate-900 p-4 rounded border border-slate-800">
                                        <h4
                                            class="text-lg font-bold text-rose-400 mb-3 border-l-4 border-rose-500 pl-3">
                                            3. 飛行模式
                                            (Flight Modes)</h4>
                                        <ul class="text-sm text-slate-300 space-y-1">
                                            <li><strong>High (上):</strong> Stabilized (自穩，室內無 GPS 必用)</li>
                                            <li><strong>Mid (中):</strong> Position (定點，戶外標準)</li>
                                            <li><strong>Low (下):</strong> Return (自動返航 RTL)</li>
                                        </ul>
                                    </div>
                                </div>

                                <div class="bg-slate-900 p-4 rounded border border-slate-800">
                                    <h4 class="text-lg font-bold text-amber-400 mb-3 border-l-4 border-amber-500 pl-3">
                                        4.
                                        動力與解鎖驗證 (Props OFF)</h4>
                                    <div class="grid grid-cols-2 gap-4 text-sm text-slate-300">
                                        <div>
                                            <strong>解鎖指令 (Arming):</strong><br>
                                            油門置於最低，並向右下角 (Yaw Right) 保持 3 秒。
                                        </div>
                                        <div>
                                            <strong>轉向驗證 (Quad-X):</strong><br>
                                            M1(右上)/M2(左下): CCW (銀帽)<br>
                                            M3(左上)/M4(右下): CW (黑帽)
                                        </div>
                                    </div>
                                    <div
                                        class="mt-3 p-2 bg-amber-900/20 border border-amber-800 rounded text-xs text-amber-400">
                                        <strong>關鍵修正:</strong> 曾遇馬達無反應，經查為接線錯誤。ESC 訊號線必須接在 <strong>IO PWM OUT
                                            (Main)</strong>，並確認 <code>CBRK_IO_SAFETY</code> 參數設定正確。
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="section-maint" class="mb-16 hidden animate-section relative">
                    <header class="mb-8 border-b border-slate-800 pb-4">
                        <h2 class="text-3xl font-bold text-slate-100 mb-2">故障診斷 (Troubleshooting)</h2>
                    </header>
                    <div class="bg-slate-900 p-6 rounded-xl border border-slate-800">
                        <select id="diagnostic-select" onchange="showDiagnosis()"
                            class="w-full p-3 bg-slate-800 border border-slate-700 rounded text-slate-200 mb-4">
                            <option value="">選擇症狀...</option>
                            <option value="accel_nose_down">加速度計校正異常 (Nose Down)</option>
                            <option value="motor_no_spin">馬達無反應 / 接線錯誤</option>
                            <option value="kill_switch">緊急斷電 vs 安全鎖 (Kill Switch)</option>
                            <option value="compass_inc">羅盤不一致 (Compass Inconsistent)</option>
                            <option value="no_local_pos">位置預估失敗 (No Valid Local Position)</option>
                            <option value="battery_volt">電池壓降過大</option>
                            <option value="ubuntu_dep">Ubuntu 24.04 安裝 CubeIDE 失敗</option>
                            <option value="sitl_udp">PX4 SITL 連接 Gazebo 逾時</option>
                            <option value="ros2_topic">ROS 2 找不到 /fmu 主題</option>
                            <option value="desync">馬達失步 (Desync)</option>
                        </select>
                        <div id="diagnostic-result" class="hidden mt-4 p-4 bg-slate-950 border-l-4 border-emerald-500">
                            <h4 id="diag-title" class="font-bold text-emerald-400 mb-2"></h4>
                            <p id="diag-desc" class="text-sm text-slate-300 whitespace-pre-wrap"></p>
                        </div>
                    </div>
                </section>

                <!-- ============================================================
     Part 7: 實戰案例與未來展望章節
     插入位置: Part 1 的 <main> 區塊內，Part 6 之後
     ============================================================ -->

                <section id="section-cases" class="mb-16 animate-fade-in">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-3xl font-bold text-teal-400 flex items-center">
                            <i class="fa-solid fa-rocket mr-3"></i>實戰案例與未來展望
                        </h2>
                        <span class="bookmark-badge" data-section="section-cases"><i
                                class="fa-regular fa-bookmark"></i></span>
                    </div>

                    <!-- 案例一：室內導航 -->
                    <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                        <h3 class="text-xl font-bold text-cyan-300 mb-4 flex items-center">
                            <i class="fa-solid fa-building mr-2"></i>案例一：室內倉儲巡檢系統
                        </h3>
                        <div class="grid md:grid-cols-3 gap-6">
                            <!-- 系統架構 -->
                            <div class="bg-slate-950 p-5 rounded border border-cyan-500/30">
                                <div class="text-lg font-bold text-cyan-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-sitemap mr-2"></i>系統架構
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-emerald-400 text-sm mb-2">硬體配置</div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• Pixhawk 6C + ArduCopter 4.5</li>
                                            <li>• Intel RealSense T265 (VIO)</li>
                                            <li>• Intel RealSense D435i (避障)</li>
                                            <li>• Jetson Nano (伴隨電腦)</li>
                                            <li>• 4S 5000mAh 電池</li>
                                        </ul>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-sky-400 text-sm mb-2">軟體架構</div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• ROS Noetic (Ubuntu 20.04)</li>
                                            <li>• MAVROS (MAVLink 橋接)</li>
                                            <li>• realsense2_camera</li>
                                            <li>• rtabmap_ros (SLAM)</li>
                                            <li>• move_base (路徑規劃)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- 功能實現 -->
                            <div class="bg-slate-950 p-5 rounded border border-purple-500/30">
                                <div class="text-lg font-bold text-purple-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-list-check mr-2"></i>功能實現
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-purple-300 text-sm mb-2 flex items-center">
                                            <i
                                                class="fa-solid fa-1 w-5 h-5 bg-purple-500 rounded-full flex items-center justify-center text-white text-xs mr-2"></i>
                                            自主導航
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            • 預先建立 3D 地圖 (RTAB-Map)<br>
                                            • 設定巡檢路徑點 (Waypoints)<br>
                                            • 自動飛行並回傳影像
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-sky-300 text-sm mb-2 flex items-center">
                                            <i
                                                class="fa-solid fa-2 w-5 h-5 bg-sky-500 rounded-full flex items-center justify-center text-white text-xs mr-2"></i>
                                            避障功能
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            • D435i 提供深度資訊<br>
                                            • 偵測前方 0.3~3m 障礙物<br>
                                            • 自動減速或繞行
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-emerald-300 text-sm mb-2 flex items-center">
                                            <i
                                                class="fa-solid fa-3 w-5 h-5 bg-emerald-500 rounded-full flex items-center justify-center text-white text-xs mr-2"></i>
                                            異常偵測
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            • YOLOv8 偵測漏水、火源<br>
                                            • 溫度感測器監控過熱<br>
                                            • 自動拍照並發送警報
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 性能指標 -->
                            <div class="bg-slate-950 p-5 rounded border border-emerald-500/30">
                                <div class="text-lg font-bold text-emerald-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-chart-bar mr-2"></i>性能指標
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700 text-center">
                                        <div class="text-3xl font-bold text-cyan-400 mb-1">±8cm</div>
                                        <div class="text-xs text-slate-400">定位精度</div>
                                        <div class="text-xs text-slate-500 mt-1">在 50m × 30m 倉庫</div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700 text-center">
                                        <div class="text-3xl font-bold text-purple-400 mb-1">22 min</div>
                                        <div class="text-xs text-slate-400">續航時間</div>
                                        <div class="text-xs text-slate-500 mt-1">含避障與 SLAM</div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700 text-center">
                                        <div class="text-3xl font-bold text-emerald-400 mb-1">95%</div>
                                        <div class="text-xs text-slate-400">任務成功率</div>
                                        <div class="text-xs text-slate-500 mt-1">100 次測試統計</div>
                                    </div>

                                    <div class="bg-emerald-900/20 border border-emerald-500/30 p-3 rounded">
                                        <div class="text-xs text-emerald-300 flex items-start">
                                            <i class="fa-solid fa-trophy mr-2 mt-1"></i>
                                            <span><strong>成果</strong>：節省 60% 人力巡檢成本，提早發現 3 次潛在火災風險</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 案例二：橋梁檢測 -->
                    <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                        <h3 class="text-xl font-bold text-orange-300 mb-4 flex items-center">
                            <i class="fa-solid fa-bridge mr-2"></i>案例二：橋梁裂縫 AI 檢測
                        </h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <!-- 技術方案 -->
                            <div class="bg-slate-950 p-5 rounded border border-orange-500/30">
                                <div class="text-lg font-bold text-orange-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-microscope mr-2"></i>技術方案
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-sky-400 text-sm mb-2">影像採集</div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• Sony IMX477 (12MP, 4K)</li>
                                            <li>• 可變焦鏡頭 (6-22mm)</li>
                                            <li>• 雲台穩定 (3軸機械增穩)</li>
                                            <li>• 自動曝光與白平衡</li>
                                        </ul>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-purple-400 text-sm mb-2">AI 模型</div>
                                        <div class="text-xs text-slate-400 space-y-2">
                                            <div>
                                                <strong class="text-purple-300">模型</strong>：YOLOv8-seg (語義分割)<br>
                                                <strong class="text-sky-300">訓練集</strong>：5000 張橋梁裂縫標註影像<br>
                                                <strong class="text-emerald-300">準確率</strong>：mAP@0.5 = 89.3%
                                            </div>
                                            <div class="bg-slate-950 p-2 rounded">
                                                <div class="text-amber-300 font-bold mb-1">偵測類別</div>
                                                <div class="flex flex-wrap gap-1">
                                                    <span
                                                        class="px-2 py-1 bg-red-900/30 text-red-300 rounded text-xs">橫向裂縫</span>
                                                    <span
                                                        class="px-2 py-1 bg-orange-900/30 text-orange-300 rounded text-xs">縱向裂縫</span>
                                                    <span
                                                        class="px-2 py-1 bg-amber-900/30 text-amber-300 rounded text-xs">龜裂</span>
                                                    <span
                                                        class="px-2 py-1 bg-yellow-900/30 text-yellow-300 rounded text-xs">剝落</span>
                                                    <span
                                                        class="px-2 py-1 bg-lime-900/30 text-lime-300 rounded text-xs">鋼筋外露</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-emerald-400 text-sm mb-2">飛行策略</div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• 自動航線規劃 (Grid Pattern)</li>
                                            <li>• 距離橋面 3~5 米</li>
                                            <li>• 80% 影像重疊率</li>
                                            <li>• GPS + 光流融合定位</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- 實施流程 -->
                            <div class="bg-slate-950 p-5 rounded border border-sky-500/30">
                                <div class="text-lg font-bold text-sky-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-list-ol mr-2"></i>實施流程
                                </div>
                                <div class="space-y-2">
                                    <div class="bg-slate-900 p-3 rounded border-l-4 border-emerald-500">
                                        <div class="flex items-start">
                                            <div
                                                class="bg-emerald-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                                1</div>
                                            <div>
                                                <div class="font-bold text-emerald-300 text-sm">前期準備</div>
                                                <div class="text-xs text-slate-400 mt-1">
                                                    • 申請飛航許可 (橋梁屬管制區)<br>
                                                    • 現場勘查、風險評估<br>
                                                    • 設定地理圍欄與失效保護
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border-l-4 border-sky-500">
                                        <div class="flex items-start">
                                            <div
                                                class="bg-sky-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                                2</div>
                                            <div>
                                                <div class="font-bold text-sky-300 text-sm">自動巡檢</div>
                                                <div class="text-xs text-slate-400 mt-1">
                                                    • 上傳航線至飛控 (Mission Planner)<br>
                                                    • 自動起飛 → 拍攝 → 返航<br>
                                                    • 即時影像傳輸至地面站
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border-l-4 border-purple-500">
                                        <div class="flex items-start">
                                            <div
                                                class="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                                3</div>
                                            <div>
                                                <div class="font-bold text-purple-300 text-sm">AI 分析</div>
                                                <div class="text-xs text-slate-400 mt-1">
                                                    • 影像自動上傳至雲端<br>
                                                    • YOLOv8 批次推論<br>
                                                    • 標註裂縫位置與嚴重程度
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border-l-4 border-pink-500">
                                        <div class="flex items-start">
                                            <div
                                                class="bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5 flex-shrink-0">
                                                4</div>
                                            <div>
                                                <div class="font-bold text-pink-300 text-sm">報告生成</div>
                                                <div class="text-xs text-slate-400 mt-1">
                                                    • 自動生成檢測報告 (PDF)<br>
                                                    • 3D 模型重建 (Photogrammetry)<br>
                                                    • 歷史數據比對 (裂縫擴展趨勢)
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-4 bg-amber-900/20 border border-amber-500/30 p-3 rounded">
                                    <div class="text-xs text-amber-300 flex items-start">
                                        <i class="fa-solid fa-clock mr-2 mt-1"></i>
                                        <span><strong>效率提升</strong>：傳統人工檢測需 3 天，無人機方案僅需 4 小時 (含數據處理)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 案例三：編隊飛行 -->
                    <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                        <h3 class="text-xl font-bold text-purple-300 mb-4 flex items-center">
                            <i class="fa-solid fa-people-group mr-2"></i>案例三：多機協同編隊飛行
                        </h3>
                        <div class="grid md:grid-cols-3 gap-6">
                            <!-- 通訊架構 -->
                            <div class="bg-slate-950 p-5 rounded border border-purple-500/30">
                                <div class="text-lg font-bold text-purple-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-network-wired mr-2"></i>通訊架構
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-sky-400 text-sm mb-2">主從式架構</div>
                                        <div class="text-xs text-slate-400 space-y-2">
                                            <div>
                                                <strong class="text-emerald-300">主機 (Leader)</strong><br>
                                                • 規劃編隊路徑<br>
                                                • 廣播位置資訊<br>
                                                • 監控從機狀態
                                            </div>
                                            <div>
                                                <strong class="text-sky-300">從機 (Follower)</strong><br>
                                                • 接收主機指令<br>
                                                • 維持相對位置<br>
                                                • 避碰演算法
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-purple-400 text-sm mb-2">通訊協定</div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• MAVLink v2 (主控通訊)</li>
                                            <li>• DDS (ROS2 數據分發)</li>
                                            <li>• 2.4GHz Mesh 網路</li>
                                            <li>• 更新頻率：10 Hz</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- 編隊演算法 -->
                            <div class="bg-slate-950 p-5 rounded border border-cyan-500/30">
                                <div class="text-lg font-bold text-cyan-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-brain mr-2"></i>編隊演算法
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-cyan-300 text-sm mb-2">Leader-Follower</div>
                                        <div class="text-xs text-slate-400">
                                            從機維持與主機的<strong class="text-cyan-300">相對位置</strong>：<br>
                                            <div class="mono-font text-emerald-300 mt-2 bg-slate-950 p-2 rounded">
                                                P_follower = P_leader + Δ<br>
                                                Δ = [dx, dy, dz]
                                            </div>
                                            <div class="mt-2">
                                                <strong class="text-amber-300">優點</strong>：實現簡單<br>
                                                <strong class="text-red-300">缺點</strong>：主機故障全隊失控
                                            </div>
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-purple-300 text-sm mb-2">Consensus-based</div>
                                        <div class="text-xs text-slate-400">
                                            基於<strong class="text-purple-300">一致性演算法</strong>，每架無人機與鄰居通訊：<br>
                                            <div
                                                class="mono-font text-emerald-300 mt-2 bg-slate-950 p-2 rounded text-xs">
                                                u_i = Σ a_ij (x_j - x_i)
                                            </div>
                                            <div class="mt-2">
                                                <strong class="text-amber-300">優點</strong>：去中心化、容錯性高<br>
                                                <strong class="text-red-300">缺點</strong>：通訊負載大
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 應用場景 -->
                            <div class="bg-slate-950 p-5 rounded border border-emerald-500/30">
                                <div class="text-lg font-bold text-emerald-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-lightbulb mr-2"></i>應用場景
                                </div>
                                <div class="space-y-2">
                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-sky-400 text-sm mb-1 flex items-center">
                                            <i class="fa-solid fa-seedling mr-2"></i>農業植保
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            5 架無人機協同噴灑，效率提升 400%
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-purple-400 text-sm mb-1 flex items-center">
                                            <i class="fa-solid fa-mountain mr-2"></i>搜救任務
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            多機分區搜索，熱成像快速定位生還者
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-pink-400 text-sm mb-1 flex items-center">
                                            <i class="fa-solid fa-wand-sparkles mr-2"></i>燈光秀
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            100+ 架無人機編隊，精度 ±10cm
                                        </div>
                                    </div>

                                    <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-amber-400 text-sm mb-1 flex items-center">
                                            <i class="fa-solid fa-box mr-2"></i>物流配送
                                        </div>
                                        <div class="text-xs text-slate-400">
                                            多機接力運輸，延長配送距離
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-6 bg-purple-900/20 border border-purple-500/30 p-4 rounded">
                            <div class="flex items-start">
                                <i class="fa-solid fa-video text-purple-400 text-2xl mr-4 mt-1"></i>
                                <div>
                                    <div class="font-bold text-purple-300 mb-2">參考專案</div>
                                    <div class="text-sm text-slate-300 space-y-1">
                                        <div>• <a href="https://github.com/PX4/PX4-Autopilot"
                                                class="text-sky-400 hover:underline" target="_blank">PX4 Multi-Vehicle
                                                Simulation</a></div>
                                        <div>• <a href="https://github.com/ctu-mrs/mrs_uav_system"
                                                class="text-sky-400 hover:underline" target="_blank">CTU MRS UAV
                                                System</a>
                                            (捷克技術大學)</div>
                                        <div>• <a href="https://crazyswarm.readthedocs.io/"
                                                class="text-sky-400 hover:underline" target="_blank">Crazyswarm</a>
                                            (Crazyflie 微型無人機編隊)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 未來技術趨勢 -->
                    <div
                        class="bg-gradient-to-r from-indigo-900/20 to-purple-900/20 border border-indigo-500/30 rounded-lg p-6 mb-8">
                        <h3 class="text-xl font-bold text-indigo-300 mb-4 flex items-center">
                            <i class="fa-solid fa-crystal-ball mr-2"></i>未來技術趨勢 (Projected Future Trends)
                        </h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <!-- AI 與自主性 -->
                            <div class="bg-slate-900 p-5 rounded border border-indigo-500/30">
                                <div class="text-lg font-bold text-indigo-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-robot mr-2"></i>AI 與自主性提升
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-950 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-cyan-400 text-sm mb-2 flex items-center">
                                            <i class="fa-solid fa-brain mr-2"></i>端側 AI 推論
                                        </div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• <strong class="text-cyan-300">Transformer 模型</strong>：視覺語言多模態理解</li>
                                            <li>• <strong class="text-sky-300">神經輻射場 (NeRF)</strong>：即時 3D 重建</li>
                                            <li>• <strong class="text-purple-300">強化學習</strong>：自主避障與路徑規劃</li>
                                            <li>• <strong class="text-emerald-300">聯邦學習</strong>：預期實現多機協同訓練模型</li>
                                        </ul>
                                    </div>

                                    <div class="bg-slate-950 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-purple-400 text-sm mb-2 flex items-center">
                                            <i class="fa-solid fa-eye mr-2"></i>視覺感知革新
                                        </div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• <strong class="text-purple-300">Event Camera</strong>：微秒級響應、高動態範圍</li>
                                            <li>• <strong class="text-pink-300">LiDAR 小型化</strong>：固態激光雷達 &lt; 50g</li>
                                            <li>• <strong class="text-amber-300">熱成像融合</strong>：全天候偵測能力</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- 能源與續航 -->
                            <div class="bg-slate-900 p-5 rounded border border-emerald-500/30">
                                <div class="text-lg font-bold text-emerald-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-battery-full mr-2"></i>能源與續航突破
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-950 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-emerald-400 text-sm mb-2 flex items-center">
                                            <i class="fa-solid fa-bolt mr-2"></i>新型電池技術
                                        </div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• <strong class="text-emerald-300">固態電池</strong>：能量密度目標 500 Wh/kg (研發中)
                                            </li>
                                            <li>• <strong class="text-sky-300">鋰硫電池</strong>：理論能量密度 2600 Wh/kg</li>
                                            <li>• <strong class="text-purple-300">超級電容</strong>：快充 + 高功率輸出</li>
                                            <li>• <strong class="text-amber-300">無線充電</strong>：自動返航充電站</li>
                                        </ul>
                                    </div>

                                    <div class="bg-slate-950 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-sky-400 text-sm mb-2 flex items-center">
                                            <i class="fa-solid fa-sun mr-2"></i>混合動力系統
                                        </div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• <strong class="text-sky-300">氫燃料電池</strong>：續航 2+ 小時</li>
                                            <li>• <strong class="text-amber-300">太陽能電池翼</strong>：長航時監控</li>
                                            <li>• <strong class="text-pink-300">油電混合</strong>：垂直起降固定翼</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- 通訊與網路 -->
                            <div class="bg-slate-900 p-5 rounded border border-sky-500/30">
                                <div class="text-lg font-bold text-sky-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-satellite mr-2"></i>通訊與網路演進
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-950 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-sky-400 text-sm mb-2">5G/6G 整合</div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• <strong class="text-sky-300">超低延遲</strong>：&lt; 1ms (6G 預期目標)</li>
                                            <li>• <strong class="text-purple-300">網路切片</strong>：專用無人機通道</li>
                                            <li>• <strong class="text-emerald-300">邊緣運算</strong>：基站端 AI 推論</li>
                                        </ul>
                                    </div>

                                    <div class="bg-slate-950 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-purple-400 text-sm mb-2">衛星通訊</div>
                                        <ul class="space-y-1 text-xs text-slate-400">
                                            <li>• <strong class="text-purple-300">Starlink</strong>：全球覆蓋、低延遲</li>
                                            <li>• <strong class="text-pink-300">LEO 衛星</strong>：超視距控制</li>
                                            <li>• <strong class="text-amber-300">量子通訊</strong>：絕對安全 (實驗階段)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- 法規與標準 -->
                            <div class="bg-slate-900 p-5 rounded border border-pink-500/30">
                                <div class="text-lg font-bold text-pink-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-scale-balanced mr-2"></i>法規與標準化
                                </div>
                                <div class="space-y-3">
                                    <div class="bg-slate-950 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-pink-400 text-sm mb-2">UTM 系統</div>
                                        <div class="text-xs text-slate-400">
                                            <strong class="text-pink-300">無人機交通管理系統 (UTM)</strong><br>
                                            • 自動航線申請與核准<br>
                                            • 即時衝突偵測與避讓<br>
                                            • 與有人機空域整合
                                        </div>
                                    </div>

                                    <div class="bg-slate-950 p-3 rounded border border-slate-700">
                                        <div class="font-bold text-amber-400 text-sm mb-2">Remote ID</div>
                                        <div class="text-xs text-slate-400">
                                            <strong class="text-amber-300">遠端識別強制要求</strong><br>
                                            • 廣播無人機 ID 與位置<br>
                                            • 執法單位即時監控<br>
                                            • 2025 年全球逐步實施
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 學習資源推薦 -->
                    <div class="bg-slate-900 border border-slate-700 rounded-lg p-6 mb-8">
                        <h3 class="text-xl font-bold text-amber-300 mb-4 flex items-center">
                            <i class="fa-solid fa-book-open mr-2"></i>學習資源推薦 (Learning Resources)
                        </h3>
                        <div class="grid md:grid-cols-3 gap-6">
                            <!-- 官方文檔 -->
                            <div class="bg-slate-950 p-4 rounded border border-amber-500/30">
                                <div class="text-sm font-bold text-amber-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-file-lines mr-2"></i>官方文檔
                                </div>
                                <div class="space-y-2 text-xs">
                                    <a href="https://ardupilot.org/copter/" target="_blank"
                                        class="block bg-slate-900 p-2 rounded border border-slate-700 hover:border-orange-500 transition">
                                        <div class="font-bold text-orange-400">ArduPilot Copter</div>
                                        <div class="text-slate-400">完整參數說明與調參指南</div>
                                    </a>
                                    <a href="https://docs.px4.io/" target="_blank"
                                        class="block bg-slate-900 p-2 rounded border border-slate-700 hover:border-sky-500 transition">
                                        <div class="font-bold text-sky-400">PX4 User Guide</div>
                                        <div class="text-slate-400">模組化架構與開發文檔</div>
                                    </a>
                                    <a href="https://mavlink.io/" target="_blank"
                                        class="block bg-slate-900 p-2 rounded border border-slate-700 hover:border-purple-500 transition">
                                        <div class="font-bold text-purple-400">MAVLink Protocol</div>
                                        <div class="text-slate-400">通訊協定完整規範</div>
                                    </a>
                                </div>
                            </div>

                            <!-- 線上課程 -->
                            <div class="bg-slate-950 p-4 rounded border border-sky-500/30">
                                <div class="text-sm font-bold text-sky-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-graduation-cap mr-2"></i>線上課程
                                </div>
                                <div class="space-y-2 text-xs">
                                    <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                        <div class="font-bold text-emerald-400">Coursera - Aerial Robotics</div>
                                        <div class="text-slate-400">賓州大學 Vijay Kumar 教授</div>
                                    </div>
                                    <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                        <div class="font-bold text-sky-400">edX - Autonomous Navigation</div>
                                        <div class="text-slate-400">ETH Zurich 自主導航課程</div>
                                    </div>
                                    <div class="bg-slate-900 p-2 rounded border border-slate-700">
                                        <div class="font-bold text-purple-400">Udacity - Flying Car Nanodegree</div>
                                        <div class="text-slate-400">含 SLAM、路徑規劃實作</div>
                                    </div>
                                </div>
                            </div>

                            <!-- 社群論壇 -->
                            <div class="bg-slate-950 p-4 rounded border border-purple-500/30">
                                <div class="text-sm font-bold text-purple-400 mb-3 flex items-center">
                                    <i class="fa-solid fa-comments mr-2"></i>社群論壇
                                </div>
                                <div class="space-y-2 text-xs">
                                    <a href="https://discuss.ardupilot.org/" target="_blank"
                                        class="block bg-slate-900 p-2 rounded border border-slate-700 hover:border-orange-500 transition">
                                        <div class="font-bold text-orange-400">ArduPilot Discourse</div>
                                        <div class="text-slate-400">官方論壇，回覆速度快</div>
                                    </a>
                                    <a href="https://discuss.px4.io/" target="_blank"
                                        class="block bg-slate-900 p-2 rounded border border-slate-700 hover:border-sky-500 transition">
                                        <div class="font-bold text-sky-400">PX4 Discuss</div>
                                        <div class="text-slate-400">開發者社群，技術深度高</div>
                                    </a>
                                    <a href="https://www.reddit.com/r/diydrones/" target="_blank"
                                        class="block bg-slate-900 p-2 rounded border border-slate-700 hover:border-pink-500 transition">
                                        <div class="font-bold text-pink-400">r/diydrones</div>
                                        <div class="text-slate-400">Reddit 社群，案例分享豐富</div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 結語 -->
                    <div
                        class="bg-gradient-to-r from-purple-900/20 via-pink-900/20 to-orange-900/20 border border-purple-500/30 rounded-lg p-8 text-center">
                        <div class="text-4xl mb-4">🚁</div>
                        <h3
                            class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-pink-400 to-orange-400 mb-4">
                            探索無限可能
                        </h3>
                        <p class="text-slate-300 text-lg mb-6 max-w-3xl mx-auto">
                            從基礎硬體選型到 AI 視覺整合，從室內 VIO 定位到多機協同編隊，無人機技術正以前所未有的速度演進。
                            這份筆記涵蓋了 Sub-250g 微型無人機的完整開發流程，希望能為你的專案提供實用的參考。
                        </p>
                        <div class="flex flex-wrap justify-center gap-4 text-sm">
                            <div class="bg-slate-900 px-4 py-2 rounded border border-purple-500/30">
                                <i class="fa-solid fa-code text-purple-400 mr-2"></i>
                                <span class="text-slate-300">持續學習</span>
                            </div>
                            <div class="bg-slate-900 px-4 py-2 rounded border border-pink-500/30">
                                <i class="fa-solid fa-flask text-pink-400 mr-2"></i>
                                <span class="text-slate-300">勇於實驗</span>
                            </div>
                            <div class="bg-slate-900 px-4 py-2 rounded border border-orange-500/30">
                                <i class="fa-solid fa-users text-orange-400 mr-2"></i>
                                <span class="text-slate-300">分享經驗</span>
                            </div>
                            <div class="bg-slate-900 px-4 py-2 rounded border border-sky-500/30">
                                <i class="fa-solid fa-shield-halved text-sky-400 mr-2"></i>
                                <span class="text-slate-300">安全第一</span>
                            </div>
                        </div>
                        <div class="mt-6 text-slate-400 text-sm">
                            <i class="fa-solid fa-heart text-red-400 mr-2"></i>
                            Made with passion for the drone community
                        </div>
                    </div>
                </section>
                <section id="section-exam" class="mb-16 hidden animate-section relative">
                    <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-exam"></i>
                    <header class="mb-8 border-b border-slate-800 pb-4">
                        <h2 class="text-3xl font-bold text-slate-100 mb-2">CAA 無人機術科測驗指南 (Exam Guide)</h2>
                        <div class="flex items-center gap-2 text-slate-400 text-sm">
                            <span class="source-badge badge-exam">G1/G2/G3</span>
                            <span>專業級操作證攻略</span>
                        </div>
                    </header>

                    <div class="bg-slate-900 rounded-xl border border-slate-800 overflow-hidden mb-8">
                        <div class="flex border-b border-slate-800 bg-slate-950 overflow-x-auto">
                            <button onclick="switchExamTab('maneuvers')" id="tab-exam-maneuvers"
                                class="px-6 py-4 text-sm font-bold text-lime-400 bg-slate-900 border-r border-slate-800 transition whitespace-nowrap">測驗項目
                                (Maneuvers)</button>
                            <button onclick="switchExamTab('tips')" id="tab-exam-tips"
                                class="px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap">通關密技
                                (Pro Tips)</button>
                            <button onclick="switchExamTab('mission')" id="tab-exam-mission"
                                class="px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap">任務規劃
                                (Mission)</button>
                        </div>

                        <!-- Tab 1: Maneuvers -->
                        <div id="content-exam-maneuvers" class="p-6 md:p-8 animate-fade-in">
                            <div class="space-y-6">
                                <div class="bg-slate-950 p-4 rounded border border-slate-700">
                                    <h4 class="text-lg font-bold text-lime-400 mb-2">1. 垂直起降與四面停懸</h4>
                                    <p class="text-sm text-slate-300">起飛至指定高度 (通常 2-3m)，依序執行 機頭朝前 -> 朝右 -> 朝後 -> 朝左 的 90
                                        度轉向，每面需停懸 5 秒。</p>
                                </div>
                                <div class="bg-slate-950 p-4 rounded border border-slate-700">
                                    <h4 class="text-lg font-bold text-lime-400 mb-2">2. 八字水平圓 (Figure 8)</h4>
                                    <p class="text-sm text-slate-300">這是大魔王關卡。需保持機頭朝前，左右平移繞行兩個圓錐，形成 8 字軌跡。全程不可越界，高度需維持。
                                    </p>
                                </div>
                                <div class="bg-slate-950 p-4 rounded border border-slate-700">
                                    <h4 class="text-lg font-bold text-lime-400 mb-2">3. 矩形航線 (Rectangular Circuit)</h4>
                                    <p class="text-sm text-slate-300">G3 等級必考。需執行順時針與逆時針的矩形飛行，機頭需隨航線轉向 (Bank Turn)。</p>
                                </div>
                            </div>
                        </div>

                        <!-- Tab 2: Tips -->
                        <div id="content-exam-tips" class="hidden p-6 md:p-8 animate-fade-in">
                            <div class="grid md:grid-cols-2 gap-8">
                                <div class="bg-slate-900 p-5 rounded-xl border border-lime-800">
                                    <h4 class="text-lg font-bold text-lime-400 mb-3"><i
                                            class="fa-solid fa-wind mr-2"></i>抗風修正心法
                                    </h4>
                                    <ul class="text-sm text-slate-300 space-y-3">
                                        <li><strong>預先補償:</strong> 若風從左邊吹來，轉向 90 度前先稍微往左飛一點，轉的瞬間讓風把你「吹回」中心點。</li>
                                        <li><strong>慢速轉向:</strong> 不要轉太快！建議 0.5 秒轉 90 度，這樣才有時間邊轉邊修正位移。</li>
                                    </ul>
                                </div>
                                <div class="bg-slate-900 p-5 rounded-xl border border-lime-800">
                                    <h4 class="text-lg font-bold text-lime-400 mb-3"><i
                                            class="fa-solid fa-infinity mr-2"></i>八字水平圓攻略</h4>
                                    <ul class="text-sm text-slate-300 space-y-3">
                                        <li><strong>定舵打桿:</strong> 機頭保持朝前。左手搖桿 (Yaw) 固定微量不動，主要靠右手搖桿 (Roll/Pitch) 畫圓。
                                        </li>
                                        <li><strong>高度策略:</strong> 雖然規定 1-2m，建議飛低一點 (約 1m)，視覺誤差較小，比較容易對齊圓錐。</li>
                                        <li><strong>速度控制:</strong> 保持約 1m/s 的慢速，寧可慢也不要忽快忽慢。</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Tab 3: Mission -->
                        <div id="content-exam-mission" class="hidden p-6 md:p-8 animate-fade-in">
                            <div class="space-y-6">
                                <div class="bg-slate-950 p-4 rounded border border-slate-700">
                                    <h4 class="text-lg font-bold text-slate-200 mb-2">APP 選擇: Litchi (荔枝)</h4>
                                    <p class="text-sm text-slate-400 mb-3">考試推薦使用 Litchi 進行航點規劃，操作比 DJI Go 更直觀。</p>
                                    <ul class="list-disc list-inside text-xs text-slate-500 space-y-1">
                                        <li>在家先練習畫 G1/G2/G3 的圖形。</li>
                                        <li>考試時若平板髒污或觸控不良，請善用手指替代觸控筆。</li>
                                        <li>畫完後務必檢查每個航點的高度與速度設定。</li>
                                    </ul>
                                </div>
                                <div class="bg-slate-900 p-4 rounded border-l-4 border-rose-500">
                                    <strong class="text-rose-400 text-sm">緊急程序 (Emergency):</strong>
                                    <p class="text-xs text-slate-300 mt-1">G1/G2/G3 都會考。當考官喊「緊急迫降」或「返航」時，請保持冷靜，切換到姿態模式
                                        (Attitude) 或直接執行 RTH，切勿猶豫。</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="section-resources" class="mb-16 hidden animate-section relative">
                    <i class="fa-regular fa-bookmark bookmark-badge" data-bookmark="section-resources"></i>
                    <header class="mb-8 border-b border-slate-800 pb-4">
                        <h2 class="text-3xl font-bold text-slate-100 mb-2">資源與術語 (Resources & Glossary)</h2>
                    </header>

                    <div class="bg-slate-900 rounded-xl border border-slate-800 overflow-hidden mb-8">
                        <div class="flex border-b border-slate-800 bg-slate-950 overflow-x-auto">
                            <button onclick="switchResTab('bom')" id="tab-res-bom"
                                class="px-6 py-4 text-sm font-bold text-teal-400 bg-slate-900 border-r border-slate-800 transition whitespace-nowrap">BOM
                                & Datasheets</button>
                            <button onclick="switchResTab('battery')" id="tab-res-battery"
                                class="px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap">4S
                                電池規範</button>
                            <button onclick="switchResTab('glossary')" id="tab-res-glossary"
                                class="px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap">工程術語與操控</button>
                        </div>

                        <!-- Tab: BOM -->
                        <div id="content-res-bom" class="p-6 md:p-8 animate-fade-in">
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm text-left text-slate-400">
                                    <thead class="bg-slate-950 text-xs uppercase text-slate-500">
                                        <tr>
                                            <th class="p-3">類別</th>
                                            <th class="p-3">元件 (MPN)</th>
                                            <th class="p-3">關鍵規格</th>
                                            <th class="p-3">封裝</th>
                                            <th class="p-3 text-right">Datasheet</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-slate-800">
                                        <tr>
                                            <td class="p-3 text-purple-400">MCU (Main)</td>
                                            <td class="p-3 font-bold text-white">STM32H743ZIT6</td>
                                            <td>Cortex-M7, 480MHz, 2MB Flash</td>
                                            <td>LQFP-144</td>
                                            <td class="p-3 text-right"><a href="#"
                                                    class="text-sky-400 hover:underline">PDF</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="p-3 text-purple-400">MCU (IO)</td>
                                            <td class="p-3 font-bold text-white">STM32F103C8T6</td>
                                            <td>Cortex-M3, 72MHz (Failsafe)</td>
                                            <td>LQFP-48</td>
                                            <td class="p-3 text-right"><a href="#"
                                                    class="text-sky-400 hover:underline">PDF</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="p-3 text-emerald-400">IMU 1</td>
                                            <td class="p-3 font-bold text-white">ICM-42688-P</td>
                                            <td>High frequency vibration tolerance</td>
                                            <td>LGA-14</td>
                                            <td class="p-3 text-right"><a href="#"
                                                    class="text-sky-400 hover:underline">PDF</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="p-3 text-emerald-400">IMU 2</td>
                                            <td class="p-3 font-bold text-white">BMI088</td>
                                            <td>High stability, low drift</td>
                                            <td>LGA-16</td>
                                            <td class="p-3 text-right"><a href="#"
                                                    class="text-sky-400 hover:underline">PDF</a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Tab: Battery -->
                        <div id="content-res-battery" class="hidden p-6 md:p-8 animate-fade-in">
                            <div class="grid md:grid-cols-2 gap-6">
                                <div class="bg-slate-900 p-4 rounded border border-slate-700">
                                    <strong class="text-white block mb-3 border-b border-slate-800 pb-2">基本參數 (CNHL
                                        3300mAh)</strong>
                                    <div class="grid grid-cols-2 gap-2 text-sm text-slate-300">
                                        <div>標稱電壓: <span class="text-sky-400">14.8V</span></div>
                                        <div>滿充總壓: <span class="text-emerald-400">16.8V</span></div>
                                        <div>單節滿充: <span class="text-emerald-400">4.2V</span></div>
                                        <div>放電倍率: <span class="text-rose-400">40C</span></div>
                                    </div>
                                </div>
                                <div class="bg-slate-900 p-4 rounded border border-slate-700">
                                    <strong class="text-white block mb-3 border-b border-slate-800 pb-2">充電建議 (HOTA
                                        D6)</strong>
                                    <table class="w-full text-xs text-left text-slate-400">
                                        <thead>
                                            <tr>
                                                <th class="pb-1">模式</th>
                                                <th class="pb-1">電流</th>
                                                <th class="pb-1">倍率</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td class="text-emerald-400">長效壽命</td>
                                                <td>1.0A ~ 1.6A</td>
                                                <td>0.3C ~ 0.5C</td>
                                            </tr>
                                            <tr>
                                                <td class="text-sky-400">標準充電</td>
                                                <td>3.3A</td>
                                                <td>1.0C (推薦)</td>
                                            </tr>
                                            <tr>
                                                <td class="text-rose-400">快速充電</td>
                                                <td>6.6A</td>
                                                <td>2.0C (急用)</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="mt-4 grid md:grid-cols-2 gap-4 text-xs">
                                <div class="bg-slate-800 p-3 rounded text-slate-300 border-l-4 border-amber-500">
                                    <strong>安全規範:</strong> 必須連接平衡頭。超過 24hr 不使用請放電至 Storage 電壓 (3.85V/cell)。
                                </div>
                                <div class="bg-slate-800 p-3 rounded text-slate-300 border-l-4 border-rose-500">
                                    <strong>BMS 邏輯:</strong> 警報 (Alarm) 設為 3.5V/cell，強制切斷 (Cut-off) 設為 3.2V/cell。
                                </div>
                            </div>
                        </div>

                        <!-- Tab: Glossary (Mode 2 Included) -->
                        <div id="content-res-glossary" class="hidden p-6 md:p-8 animate-fade-in">

                            <!-- Mode 2 Visual Guide (New) -->
                            <div class="mb-8">
                                <h3 class="text-lg font-bold text-white mb-4 flex items-center">
                                    <i class="fa-solid fa-gamepad mr-2 text-indigo-400"></i>
                                    美國手 (Mode 2) 操控詳解
                                </h3>
                                <p
                                    class="text-sm text-slate-400 mb-4 bg-slate-900/50 p-3 rounded border border-slate-700">
                                    <strong class="text-white">定義：</strong>左手搖桿負責<span
                                        class="text-sky-400">動力與旋轉</span>，右手搖桿負責<span
                                        class="text-emerald-400">方向與水平移動</span>。此為全球 90% 主流設定 (含 DJI)。
                                </p>

                                <div class="grid md:grid-cols-2 gap-6">
                                    <!-- Left Stick -->
                                    <div
                                        class="bg-slate-900 p-5 rounded-xl border border-slate-700 relative overflow-hidden group hover:border-sky-500 transition">
                                        <div
                                            class="absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition">
                                            <i class="fa-solid fa-arrows-up-down text-6xl text-sky-500"></i>
                                        </div>
                                        <h4 class="font-bold text-sky-400 mb-3 border-b border-slate-800 pb-2">1. 左手搖桿
                                            (Left
                                            Stick)</h4>
                                        <div class="text-xs text-slate-500 mb-3">控制能量與機頭朝向 (不回中)</div>

                                        <div class="space-y-3 text-sm">
                                            <div class="flex items-center justify-between">
                                                <span class="text-slate-300"><i
                                                        class="fa-solid fa-arrow-up mr-2 text-sky-500"></i>上推
                                                    (Up)</span>
                                                <span class="font-mono text-sky-300">Throttle Up</span>
                                                <span class="text-slate-400 text-xs">上升 (Ascend)</span>
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-slate-300"><i
                                                        class="fa-solid fa-arrow-down mr-2 text-sky-500"></i>下拉
                                                    (Down)</span>
                                                <span class="font-mono text-sky-300">Throttle Down</span>
                                                <span class="text-slate-400 text-xs">下降 (Descend)</span>
                                            </div>
                                            <div
                                                class="flex items-center justify-between border-t border-slate-800 pt-2 mt-2">
                                                <span class="text-slate-300"><i
                                                        class="fa-solid fa-arrow-left mr-2 text-sky-500"></i>左撥
                                                    (Left)</span>
                                                <span class="font-mono text-sky-300">Yaw Left</span>
                                                <span class="text-slate-400 text-xs">左轉 (CCW)</span>
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-slate-300"><i
                                                        class="fa-solid fa-arrow-right mr-2 text-sky-500"></i>右撥
                                                    (Right)</span>
                                                <span class="font-mono text-sky-300">Yaw Right</span>
                                                <span class="text-slate-400 text-xs">右轉 (CW)</span>
                                            </div>
                                        </div>
                                        <div
                                            class="mt-4 p-2 bg-sky-900/20 border border-sky-800 rounded text-xs text-sky-200">
                                            💡 <strong>心法：</strong>控制飛機「去哪裡的高度」以及「臉朝向哪裡」。
                                        </div>
                                    </div>

                                    <!-- Right Stick -->
                                    <div
                                        class="bg-slate-900 p-5 rounded-xl border border-slate-700 relative overflow-hidden group hover:border-emerald-500 transition">
                                        <div
                                            class="absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition">
                                            <i
                                                class="fa-solid fa-arrows-up-down-left-right text-6xl text-emerald-500"></i>
                                        </div>
                                        <h4 class="font-bold text-emerald-400 mb-3 border-b border-slate-800 pb-2">2.
                                            右手搖桿
                                            (Right Stick)</h4>
                                        <div class="text-xs text-slate-500 mb-3">控制水平位置 (自動回中)</div>

                                        <div class="space-y-3 text-sm">
                                            <div class="flex items-center justify-between">
                                                <span class="text-slate-300"><i
                                                        class="fa-solid fa-arrow-up mr-2 text-emerald-500"></i>上推
                                                    (Up)</span>
                                                <span class="font-mono text-emerald-300">Pitch Down</span>
                                                <span class="text-slate-400 text-xs">前進 (Forward)</span>
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-slate-300"><i
                                                        class="fa-solid fa-arrow-down mr-2 text-emerald-500"></i>下拉
                                                    (Down)</span>
                                                <span class="font-mono text-emerald-300">Pitch Up</span>
                                                <span class="text-slate-400 text-xs">後退 (Backward)</span>
                                            </div>
                                            <div
                                                class="flex items-center justify-between border-t border-slate-800 pt-2 mt-2">
                                                <span class="text-slate-300"><i
                                                        class="fa-solid fa-arrow-left mr-2 text-emerald-500"></i>左撥
                                                    (Left)</span>
                                                <span class="font-mono text-emerald-300">Roll Left</span>
                                                <span class="text-slate-400 text-xs">左橫移 (Left)</span>
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-slate-300"><i
                                                        class="fa-solid fa-arrow-right mr-2 text-emerald-500"></i>右撥
                                                    (Right)</span>
                                                <span class="font-mono text-emerald-300">Roll Right</span>
                                                <span class="text-slate-400 text-xs">右橫移 (Right)</span>
                                            </div>
                                        </div>
                                        <div
                                            class="mt-4 p-2 bg-emerald-900/20 border border-emerald-800 rounded text-xs text-emerald-200">
                                            💡 <strong>心法：</strong>想像搖桿就是飛機本身，你推哪裡，它就往哪裡倒。
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Glossary Tables -->
                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <h4
                                        class="text-sm font-bold text-slate-300 border-l-4 border-emerald-500 pl-2 mb-2">
                                        QGC 設定
                                        (Configuration)</h4>
                                    <div class="grid grid-cols-2 gap-4 text-xs text-slate-400">
                                        <div class="bg-slate-900 p-2 rounded"><strong>Airframe:</strong> 機架選擇 (Quadrotor
                                            X,
                                            Hexacopter)。</div>
                                        <div class="bg-slate-900 p-2 rounded"><strong>Sensors:</strong> 感測器校正 (Accel,
                                            Gyro, Mag,
                                            Level)。</div>
                                        <div class="bg-slate-900 p-2 rounded"><strong>Radio:</strong> 遙控器通道映射與校正。</div>
                                        <div class="bg-slate-900 p-2 rounded"><strong>Actuators:</strong> 馬達輸出與轉向設定 (PX4
                                            v1.14+)。</div>
                                    </div>
                                </div>
                                <div>
                                    <h4 class="text-sm font-bold text-slate-300 border-l-4 border-amber-500 pl-2 mb-2">
                                        飛行模式
                                        (Flight Modes)</h4>
                                    <ul class="text-xs text-slate-400 space-y-1">
                                        <li><span class="text-white font-bold w-20 inline-block">Stabilized:</span>
                                            自穩模式。純手動，無
                                            GPS，僅維持水平。</li>
                                        <li><span class="text-white font-bold w-20 inline-block">Position:</span>
                                            定點模式。GPS 輔助懸停
                                            (Loiter)。</li>
                                        <li><span class="text-white font-bold w-20 inline-block">RTL:</span> 返航模式
                                            (Return To
                                            Launch)。</li>
                                        <li><span class="text-white font-bold w-20 inline-block">Offboard:</span> 外部控制。由
                                            Companion Computer (ROS 2) 控制。</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 頁尾 -->
                <footer class="mt-16 pt-8 border-t border-slate-800 text-center text-slate-500 text-sm">
                    <div class="mb-4">
                        <a href="#top"
                            class="inline-flex items-center px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded transition">
                            <i class="fa-solid fa-arrow-up mr-2"></i>
                            返回頂部
                        </a>
                    </div>

                    <p>© 2025 UAS Development Notes | 最後更新：2025-02-15</p>
                    <p class="mt-2 text-xs">
                        本文檔僅供學習參考，實際飛行請遵守當地法規並注意安全
                    </p>
                </footer>

        </main>
        <script>
            // ==================== 1. 全域變數 ====================
            let currentSection = 'section-landing';
            let vehicleChartInstance = null;
            let pidChartInstance = null;
            let bookmarks = JSON.parse(localStorage.getItem('uas-bookmarks') || '[]');
            let tourStep = 0;

            // ==================== 2. 搜尋資料 (完整版) ====================
            const searchData = [
                { title: '技術路線圖', section: 'section-roadmap', keywords: ['roadmap', 'imx', 'rt1176', 'pab', 'rtk'] },
                { title: '官方技術手冊', section: 'section-official-docs', keywords: ['docs', 'spec', 'ports', 'jst', 'pinout', 'manual'] },
                { title: 'X500 硬體拆解', section: 'section-teardown', keywords: ['x500', 'teardown', 'pixhawk', '6c'] },
                { title: 'X500 AIoT 建置', section: 'section-build-aiot', keywords: ['build', 'aiot', 'pi5', 'yolo', 'ubec'] },
                { title: '專案實作日誌', section: 'section-logs', keywords: ['log', 'build', 'config', 'qgc', 'calibration', 'sop'] },
                { title: 'MCU 架構詳解', section: 'section-mcu', keywords: ['mcu', 'stm32', 'h7', 'f103', 'io'] },
                { title: '硬體解剖', section: 'section-hardware', keywords: ['hardware', 'anatomy'] },
                { title: 'Pixhawk 6X/6C', section: 'section-pixhawk', keywords: ['pixhawk', '6x', '6c'] },
                { title: '自製硬體指南', section: 'section-design', keywords: ['design', 'diy', 'pinout'] },
                { title: 'BLDC 馬達實驗室', section: 'section-bldc', keywords: ['bldc', 'motor', 'esc', 'foc'] },
                { title: '系統概觀', section: 'section-pid', keywords: ['intro', 'overview', '飛行原理'] },
                { title: 'DShot 通訊時序', section: 'section-protocols', keywords: ['dshot', 'protocol', 'rf', 'elrs'] },
                { title: 'PID 控制理論', section: 'section-pid', keywords: ['pid', 'control', 'tuning'] },
                { title: '開發環境', section: 'section-devenv', keywords: ['dev', 'environment', 'ide', 'cubeide', 'platformio', 'checklist'] },
                { title: '軟體棧 (PX4/ArduPilot)', section: 'section-software', keywords: ['software', 'stack', 'px4', 'ardupilot', 'uorb'] },
                { title: 'AIoT 與 ROS 2', section: 'section-aiot', keywords: ['aiot', 'ros2', 'esp32', 'micro-ros', 'humble', 'trainer', 'ppm'] },
                { title: '故障診斷', section: 'section-maint', keywords: ['debug', 'troubleshooting', 'ubuntu', 'sitl', 'accel', 'motor'] },
                { title: '資源與術語', section: 'section-resources', keywords: ['cost', 'bom', 'price', 'community', 'battery', 'lipo', 'glossary', 'throttle', 'yaw', 'pitch', 'roll', 'mode 2', 'stick', 'control'] },
                { title: 'CAA 術科測驗', section: 'section-exam', keywords: ['exam', 'caa', 'g1', 'g2', 'g3', 'license', 'test', '八字'] }
                ,
                { title: 'Sub-250g 微型無人機', section: 'section-microuav', keywords: ['microuav', '250g', 'regulation', 'weight', 'betaflight'] },
                { title: 'VIO 視覺里程計', section: 'section-vio', keywords: ['vio', 'visual', 'odometry', 'slam', 'realsense', 't265', 'vins'] },
                { title: '系統調參實戰', section: 'section-tuning', keywords: ['tuning', 'pid', 'autotune', 'filter', 'vibration', 'log', 'analysis'] },
                { title: '實戰案例', section: 'section-cases', keywords: ['case', 'example', 'warehouse', 'inspection', 'swarm', 'bridge'] }
            ];

            // ==================== 3. 頁面加載初始化 ====================
            document.addEventListener('DOMContentLoaded', function () {
                initNavigation();
                initCharts();
                initPortDetails();
                initAnatomy();
                initMobileMenu();
                initScrollProgress();
                initBackToTop();
                initSearch();
                initBookmarks();
                initThemeToggle();
                updateBookmarkUI();
                initPinoutSearch(); // Initialize Pinout Table

                // 繪製 DShot bits
                const db = document.getElementById('dshot-bits');
                if (db) {
                    db.innerHTML = '';
                    for (let i = 0; i < 16; i++) {
                        const b = document.createElement('div');
                        let color = i < 11 ? 'bg-emerald-500' : (i < 12 ? 'bg-amber-500' : 'bg-rose-500');
                        b.className = `bit-box w-5 h-8 md:w-6 md:h-10 ${color} rounded opacity-60 hover:opacity-100 border border-white/10 m-0.5 cursor-help`;
                        db.appendChild(b);
                    }
                }
            });

            // ==================== 4. 側邊欄導航功能 ====================
            function initNavigation() {
                const navItems = document.querySelectorAll('.nav-item');
                navItems.forEach(item => {
                    item.addEventListener('click', function (e) {
                        e.preventDefault();
                        const targetSection = this.getAttribute('data-section');
                        showSection(targetSection);

                        if (window.innerWidth < 768) {
                            document.getElementById('sidebar').classList.add('-translate-x-full');
                        }
                    });
                });

                // Explicitly show the default section on load
                if (currentSection) {
                    showSection(currentSection);
                }
            }

            function showSection(sectionId) {
                document.querySelectorAll('section').forEach(section => {
                    section.classList.add('hidden');
                });

                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.remove('hidden');
                    targetSection.classList.add('animate-fade-in');
                    currentSection = sectionId;
                    window.scrollTo({ top: 0, behavior: 'smooth' });

                    // Sync Sidebar Active State & Scroll
                    const navItems = document.querySelectorAll('.nav-item');
                    navItems.forEach(nav => {
                        nav.classList.remove('active');
                        if (nav.getAttribute('data-section') === sectionId) {
                            nav.classList.add('active');
                            nav.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    });
                }
            }

            // ==================== 5. 圖表初始化 (Chart.js) ====================
            function initCharts() {
                const vehicleCtx = document.getElementById('vehicleChart');
                if (vehicleCtx) {
                    vehicleChartInstance = new Chart(vehicleCtx, {
                        type: 'radar',
                        data: {
                            labels: ['速度', '續航', '載重', '穩定性', '成本'],
                            datasets: [{
                                label: '多旋翼',
                                data: [8, 6, 7, 9, 7],
                                borderColor: 'rgb(56, 189, 248)',
                                backgroundColor: 'rgba(56, 189, 248, 0.2)'
                            }, {
                                label: '固定翼',
                                data: [9, 9, 6, 7, 6],
                                borderColor: 'rgb(16, 185, 129)',
                                backgroundColor: 'rgba(16, 185, 129, 0.2)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                r: {
                                    beginAtZero: true, max: 10,
                                    ticks: { color: '#64748b', display: false },
                                    grid: { color: '#334155' },
                                    pointLabels: { color: '#cbd5e1' }
                                }
                            },
                            plugins: { legend: { labels: { color: '#cbd5e1' } } }
                        }
                    });
                }

                const pidCtx = document.getElementById('pidChart');
                if (pidCtx) {
                    const timeData = Array.from({ length: 50 }, (_, i) => i * 0.1);
                    pidChartInstance = new Chart(pidCtx, {
                        type: 'line',
                        data: {
                            labels: timeData,
                            datasets: [{
                                label: 'P Only',
                                data: timeData.map(t => 1 - Math.exp(-t) + 0.2 * Math.sin(3 * t)),
                                borderColor: 'rgb(16, 185, 129)', backgroundColor: 'rgba(16, 185, 129, 0.1)', tension: 0.4
                            }, {
                                label: 'PD',
                                data: timeData.map(t => 1 - Math.exp(-1.5 * t) + 0.05 * Math.sin(4 * t)),
                                borderColor: 'rgb(56, 189, 248)', backgroundColor: 'rgba(56, 189, 248, 0.1)', tension: 0.4
                            }, {
                                label: 'PID',
                                data: timeData.map(t => 1 - Math.exp(-2 * t)),
                                borderColor: 'rgb(251, 191, 36)', backgroundColor: 'rgba(251, 191, 36, 0.1)', tension: 0.4
                            }, {
                                label: 'Setpoint',
                                data: timeData.map(() => 1),
                                borderColor: 'rgb(148, 163, 184)', borderDash: [5, 5], pointRadius: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: { display: false },
                                y: { ticks: { color: '#64748b' }, grid: { color: '#334155' } }
                            },
                            plugins: { legend: { labels: { color: '#cbd5e1' } } }
                        }
                    });
                }
            }

            function updatePidChart(t) {
                const m = {
                    balanced: { d: [0, 0.6, 1.1, 0.95, 1.02, 0.99, 1, 1, 1], c: '#34d399' },
                    highP: { d: [0, 0.8, 1.4, 0.6, 1.3, 0.8, 1.1, 0.95, 1], c: '#f43f5e' },
                    lowD: { d: [0, 0.5, 1.3, 1.1, 1.05, 1.01, 1, 1, 1], c: '#fbbf24' }
                };
                const p = m[t];
                if (pidChartInstance) {
                    // For a simple visual update, we are just regenerating data based on the key
                    // Real simulation logic is simplified here for UI demo purposes
                    // pidChartInstance.update();
                }
            }

            // ==================== 6. Port 詳細資訊互動 ====================
            const portData = {
                power: { icon: '<i class="fa-solid fa-battery-full text-rose-500"></i>', title: 'POWER 1 & 2', content: '<table class="w-full pin-table"><tr><th>Pin</th><th>Function</th><th>Spec</th></tr><tr><td>1,2</td><td>VCC</td><td class="v-5">5V (3A Max)</td></tr><tr><td>3</td><td>I_SENS</td><td class="v-33">0-3.3V Analog</td></tr><tr><td>4</td><td>V_SENS</td><td class="v-33">0-3.3V Analog</td></tr></table>' },
                telem: { icon: '<i class="fa-solid fa-wifi text-sky-500"></i>', title: 'TELEM 1', content: '<table class="w-full pin-table"><tr><th>Pin</th><th>Function</th><th>Spec</th></tr><tr><td>1</td><td>VCC</td><td class="v-5">5V (1.5A Limit)</td></tr><tr><td>2,3</td><td>TX/RX</td><td class="v-33">UART7 (CMOS)</td></tr><tr><td>4,5</td><td>CTS/RTS</td><td class="v-33">Flow Control</td></tr></table>' },
                gps: { icon: '<i class="fa-solid fa-satellite text-emerald-500"></i>', title: 'GPS 1', content: '<table class="w-full pin-table"><tr><th>Pin</th><th>Function</th></tr><tr><td>1</td><td>VCC</td></tr><tr><td>2,3</td><td>TX/RX</td></tr><tr><td>4,5</td><td>I2C (Mag)</td></tr></table>' },
                fmu_pwm: { icon: '<i class="fa-solid fa-fan text-amber-500"></i>', title: 'FMU PWM (AUX)', content: '由 H7 直接驅動。3.3V 邏輯。<br><strong>注意：</strong> 若使用 DShot 讀取 RPM，請將 ESC 訊號線接於此。' },
                io_pwm: { icon: '<i class="fa-solid fa-gears text-slate-400"></i>', title: 'IO PWM (MAIN)', content: '由 F103 驅動。3.3V 邏輯。<br><strong>特點：</strong> 具備安全開關鎖定與斷訊保護，標準 PWM 建議接此。' },
                can: { icon: '<i class="fa-solid fa-network-wired text-indigo-500"></i>', title: 'CAN 1/2', content: '<table class="w-full pin-table"><tr><th>Pin</th><th>Function</th></tr><tr><td>1</td><td>VCC</td></tr><tr><td>2</td><td>CAN_H</td></tr><tr><td>3</td><td>CAN_L</td></tr></table>' }
            };

            function initPortDetails() {
                document.querySelectorAll('.port-connector').forEach(c => {
                    c.addEventListener('click', function () {
                        const d = portData[this.getAttribute('data-port')];
                        if (d) {
                            document.getElementById('port-icon').innerHTML = d.icon;
                            document.getElementById('port-title').textContent = d.title;
                            document.getElementById('port-content').innerHTML = d.content;
                            document.querySelectorAll('.port-connector').forEach(el => el.classList.remove('ring-2', 'ring-sky-500'));
                            this.classList.add('ring-2', 'ring-sky-500');
                        }
                    });
                });
            }

            function showBldcDetail(k) {
                const data = {
                    mcu: { t: 'STM32 G4', d: 'CORDIC/FMAC 數學加速器，專為 FOC 設計。', s: ['170MHz Cortex-M4', '3x ADC (同步採樣)', 'Advanced Timer'] },
                    driver: { t: 'Gate Driver', d: '驅動 MOSFET 閘極，控制死區時間 (Deadtime)。', s: ['Bootstrap 電路', '保護機制 (OCP, OTP)', '驅動電流 > 1A'] },
                    mosfet: { t: 'MOSFETs', d: '三相逆變橋，低導通電阻。', s: ['Vds > 電池電壓 x 1.5', 'Rds(on) < 3mΩ', 'DFN 5x6 封裝'] }
                };
                const d = data[k];
                document.getElementById('bldc-title').innerText = d.t;
                document.getElementById('bldc-desc').innerText = d.d;
                document.getElementById('bldc-specs').innerHTML = d.s.map(i => `<li>> ${i}</li>`).join('');
                document.getElementById('bldc-detail-box').classList.remove('hidden');
            }

            // ==================== 7. 各種頁籤切換 ====================
            function switchDesignTab(tabId) {
                document.getElementById('content-design-modules').classList.add('hidden');
                document.getElementById('content-design-pinout').classList.add('hidden');
                document.getElementById(`content-design-${tabId}`).classList.remove('hidden');
                document.getElementById('tab-design-modules').className = tabId === 'modules' ? "px-6 py-4 text-sm font-bold text-pink-400 bg-slate-900 border-r border-slate-800 transition whitespace-nowrap" : "px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap";
                document.getElementById('tab-design-pinout').className = tabId === 'pinout' ? "px-6 py-4 text-sm font-bold text-pink-400 bg-slate-900 border-l border-slate-800 transition whitespace-nowrap" : "px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap";
            }
            function showDesignTab(id) { switchDesignTab(id); } // Alias

            function switchLogsTab(tabId) {
                document.getElementById('content-logs-status').classList.add('hidden');
                document.getElementById('content-logs-sop').classList.add('hidden');
                document.getElementById(`content-logs-${tabId}`).classList.remove('hidden');
                document.getElementById('tab-log-status').className = tabId === 'status' ? "px-6 py-4 text-sm font-bold text-amber-400 bg-slate-900 border-r border-slate-800 transition whitespace-nowrap" : "px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap";
                document.getElementById('tab-log-sop').className = tabId === 'sop' ? "px-6 py-4 text-sm font-bold text-amber-400 bg-slate-900 border-l border-slate-800 transition whitespace-nowrap" : "px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap";
            }

            function switchSoftTab(id) {
                document.getElementById('content-soft-px4').classList.add('hidden');
                document.getElementById('content-soft-ardupilot').classList.add('hidden');
                document.getElementById(`content-soft-${id}`).classList.remove('hidden');
                document.getElementById('tab-soft-px4').className = id === 'px4' ? 'flex-1 py-4 font-bold text-sky-400 bg-slate-900 border-r border-slate-800 transition' : 'flex-1 py-4 font-bold text-slate-500 bg-slate-950 transition';
                document.getElementById('tab-soft-ardupilot').className = id === 'ardupilot' ? 'flex-1 py-4 font-bold text-rose-400 bg-slate-900 transition' : 'flex-1 py-4 font-bold text-slate-500 bg-slate-950 transition';
            }

            // Updated for AIoT Tabs
            function switchAiotTab(id) {
                document.getElementById('content-aiot-ros').classList.add('hidden');
                document.getElementById('content-aiot-trainer').classList.add('hidden');
                document.getElementById(`content-aiot-${id}`).classList.remove('hidden');

                document.getElementById('tab-aiot-ros').className = id === 'ros'
                    ? 'px-6 py-4 text-sm font-bold text-violet-400 bg-slate-900 border-r border-slate-800 transition whitespace-nowrap'
                    : 'px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap';

                document.getElementById('tab-aiot-trainer').className = id === 'trainer'
                    ? 'px-6 py-4 text-sm font-bold text-pink-400 bg-slate-900 border-l border-slate-800 transition whitespace-nowrap'
                    : 'px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap';
            }

            // NEW: Exam Tabs
            function switchExamTab(id) {
                document.getElementById('content-exam-maneuvers').classList.add('hidden');
                document.getElementById('content-exam-tips').classList.add('hidden');
                document.getElementById('content-exam-mission').classList.add('hidden');

                document.getElementById(`content-exam-${id}`).classList.remove('hidden');

                ['maneuvers', 'tips', 'mission'].forEach(tab => {
                    document.getElementById(`tab-exam-${tab}`).className = 'px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap';
                });

                const activeClass = 'px-6 py-4 text-sm font-bold text-lime-400 bg-slate-900 border-x border-slate-800 transition whitespace-nowrap';
                document.getElementById(`tab-exam-${id}`).className = activeClass;
            }

            function switchProtoTab(id) {
                document.getElementById('content-proto-pwm').classList.add('hidden');
                document.getElementById('content-proto-dshot').classList.add('hidden');
                document.getElementById('content-proto-rf').classList.add('hidden');

                document.getElementById(`content-proto-${id}`).classList.remove('hidden');

                // Reset all tabs to inactive style
                ['pwm', 'dshot', 'rf'].forEach(tab => {
                    document.getElementById(`tab-proto-${tab}`).className = 'px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap';
                });

                // Set active tab style
                const activeClass = 'px-6 py-4 text-sm font-bold text-blue-400 bg-slate-900 border-x border-slate-800 transition whitespace-nowrap';
                const rfClass = 'px-6 py-4 text-sm font-bold text-teal-400 bg-slate-900 border-l border-slate-800 transition whitespace-nowrap';

                if (id === 'rf') {
                    document.getElementById('tab-proto-rf').className = rfClass;
                } else {
                    document.getElementById(`tab-proto-${id}`).className = activeClass.replace('blue', id === 'dshot' ? 'sky' : 'blue');
                }
            }

            function switchResTab(tabId) {
                document.getElementById('content-res-bom').classList.add('hidden');
                document.getElementById('content-res-battery').classList.add('hidden');
                document.getElementById('content-res-glossary').classList.add('hidden');
                document.getElementById(`content-res-${tabId}`).classList.remove('hidden');

                ['bom', 'battery', 'glossary'].forEach(id => {
                    document.getElementById(`tab-res-${id}`).className = "px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap";
                });
                document.getElementById(`tab-res-${tabId}`).className = "px-6 py-4 text-sm font-bold text-teal-400 bg-slate-900 border-x border-slate-800 transition whitespace-nowrap";
            }

            // NEW: Docs Tabs
            function switchDocsTab(id) {
                document.getElementById('content-docs-specs').classList.add('hidden');
                document.getElementById('content-docs-ports').classList.add('hidden');
                document.getElementById(`content-docs-${id}`).classList.remove('hidden');

                document.getElementById('tab-docs-specs').className = id === 'specs'
                    ? 'px-6 py-4 text-sm font-bold text-indigo-400 bg-slate-900 border-r border-slate-800 transition whitespace-nowrap'
                    : 'px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap';

                document.getElementById('tab-docs-ports').className = id === 'ports'
                    ? 'px-6 py-4 text-sm font-bold text-indigo-400 bg-slate-900 border-l border-slate-800 transition whitespace-nowrap'
                    : 'px-6 py-4 text-sm font-bold text-slate-500 bg-slate-950 transition whitespace-nowrap';
            }

            // ==================== 8. 硬體解剖學資料 ====================
            const anatomyDataArray = [
                { id: 'brain', icon: '🧠', title: 'FC (FMU H7)', desc: '系統大腦，執行 EKF3 與控制迴路。', specs: ['<span class="text-white">IMU Bus:</span> SPI1 (10MHz)', '<span class="text-white">SD Card:</span> SDMMC1 (4-bit)', '<span class="text-white">RAM:</span> 1MB SRAM + 2MB Flash'] },
                { id: 'senses', icon: '👁️', title: 'Sensors (IMU)', desc: 'ICM-42688-P (High Rate) + BMI088 (Stable)。', specs: ['<span class="text-white">ICM-42688:</span> Low noise, 4kHz loop', '<span class="text-white">BMI088:</span> Vibration robust', '<span class="text-white">Mag:</span> External I2C (BMM150)'] },
                { id: 'heart', icon: '🔋', title: 'Power (PMIC)', desc: 'LTC4417 三路電源切換 (PowerPath)。', specs: ['<span class="text-white">Input:</span> 3x Sources (Batt1/2, USB)', '<span class="text-white">Limit:</span> 5.7V Max Input', '<span class="text-white">Monitor:</span> Analog V/I Sense'] },
                { id: 'muscle', icon: '💪', title: 'IO (Failsafe)', desc: 'F103 協處理器，負責 PWM 與 RC。', specs: ['<span class="text-white">Proto:</span> SBUS/PPM/DSM', '<span class="text-white">PWM:</span> 8x Main Outputs', '<span class="text-white">Link:</span> UART @ 1.5Mbps'] }
            ];

            function initAnatomy() {
                const ag = document.getElementById('anatomy-grid');
                if (ag) {
                    anatomyDataArray.forEach(d => {
                        const div = document.createElement('div');
                        div.className = 'interactive-card bg-slate-900 p-4 rounded-xl border border-slate-800 shadow-lg text-center group';
                        div.onclick = () => {
                            document.getElementById('detail-title').innerText = d.title;
                            document.getElementById('detail-desc').innerText = d.desc;
                            document.getElementById('detail-specs').innerHTML = d.specs.map(s => `<li>> ${s}</li>`).join('');
                            document.getElementById('anatomy-detail').classList.remove('hidden');
                        };
                        div.innerHTML = `<div class="text-3xl mb-2 grayscale group-hover:grayscale-0 transition">${d.icon}</div><h3 class="font-bold text-slate-200 text-sm">${d.title}</h3>`;
                        ag.appendChild(div);
                    });
                }
            }

            // ==================== 9. 輔助/次要互動 ====================
            function initMobileMenu() {
                const menuBtn = document.getElementById('mobile-menu-btn');
                const closeBtn = document.getElementById('close-sidebar');
                const sidebar = document.getElementById('sidebar');

                if (menuBtn && sidebar) {
                    menuBtn.addEventListener('click', function () {
                        sidebar.classList.remove('-translate-x-full');
                    });
                }

                if (closeBtn && sidebar) {
                    closeBtn.addEventListener('click', function () {
                        sidebar.classList.add('-translate-x-full');
                    });
                }
            }

            function initScrollProgress() {
                const progressBar = document.getElementById('reading-progress');
                window.addEventListener('scroll', function () {
                    const windowHeight = window.innerHeight;
                    const documentHeight = document.documentElement.scrollHeight - windowHeight;
                    const scrolled = window.scrollY;
                    progressBar.style.width = (scrolled / documentHeight) * 100 + '%';
                });
            }

            function initBackToTop() {
                const btn = document.getElementById('back-to-top');
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 300) btn.classList.add('visible');
                    else btn.classList.remove('visible');
                });
                btn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
            }

            function initSearch() {
                const input = document.getElementById('search-input');
                const results = document.getElementById('search-results');

                input.addEventListener('input', function (e) {
                    const query = e.target.value.toLowerCase().trim();
                    if (query.length < 2) { results.classList.add('hidden'); return; }

                    const res = searchData.filter(item => item.title.toLowerCase().includes(query) || item.keywords.some(k => k.includes(query)));

                    if (res.length > 0) {
                        results.innerHTML = res.map(result => `
                        <div class="search-result-item" onclick="navigateToSection('${result.section}')">
                            <div class="font-bold text-slate-200 text-sm">${result.title}</div>
                        </div>
                    `).join('');
                        results.classList.remove('hidden');
                    } else {
                        results.innerHTML = '<div class="search-result-item text-slate-500 text-sm">無搜尋結果</div>';
                        results.classList.remove('hidden');
                    }
                });

                document.addEventListener('click', function (e) {
                    if (!e.target.closest('.search-container')) { results.classList.add('hidden'); }
                });
            }

            function navigateToSection(sectionId) {
                showSection(sectionId);
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-section') === sectionId) item.classList.add('active');
                });
                document.getElementById('search-results').classList.add('hidden');
                document.getElementById('search-input').value = '';
                if (window.innerWidth < 768) document.getElementById('sidebar').classList.add('-translate-x-full');
            }

            function initBookmarks() {
                document.querySelectorAll('.bookmark-badge').forEach(b => {
                    const sid = b.getAttribute('data-bookmark');
                    if (bookmarks.includes(sid)) {
                        b.classList.add('bookmarked'); b.classList.remove('fa-regular'); b.classList.add('fa-solid');
                    }

                    b.addEventListener('click', function (e) {
                        e.stopPropagation();
                        const index = bookmarks.indexOf(sid);
                        if (index > -1) {
                            bookmarks.splice(index, 1);
                            this.classList.remove('bookmarked', 'fa-solid'); this.classList.add('fa-regular');
                        } else {
                            bookmarks.push(sid);
                            this.classList.add('bookmarked', 'fa-solid'); this.classList.remove('fa-regular');
                        }
                        localStorage.setItem('uas-bookmarks', JSON.stringify(bookmarks));
                        updateBookmarkUI();
                    });
                });
            }

            function updateBookmarkUI() {
                const list = document.getElementById('bookmark-list');
                document.getElementById('bookmark-count').innerText = bookmarks.length;

                if (bookmarks.length === 0) {
                    list.innerHTML = '<div class="text-slate-600 italic">尚無書籤</div>'; return;
                }
                list.innerHTML = bookmarks.map(bid => {
                    const d = searchData.find(s => s.section === bid);
                    return `
                    <div class="flex items-center justify-between p-2 bg-slate-800 rounded hover:bg-slate-700 cursor-pointer transition" onclick="navigateToSection('${bid}')">
                        <span class="text-slate-300">${d ? d.title : bid}</span>
                        <i class="fa-solid fa-chevron-right text-slate-600"></i>
                    </div>
                `;
                }).join('');
            }

            function initThemeToggle() {
                const t = document.getElementById('theme-toggle');
                const html = document.documentElement;

                if (localStorage.getItem('uas-theme') === 'light') {
                    html.classList.remove('dark'); t.classList.remove('active');
                }

                t.addEventListener('click', function () {
                    html.classList.toggle('dark');
                    this.classList.toggle('active');
                    localStorage.setItem('uas-theme', html.classList.contains('dark') ? 'dark' : 'light');
                });
            }

            function showDiagnosis() {
                const v = document.getElementById('diagnostic-select').value;
                const r = document.getElementById('diagnostic-result');
                const t = document.getElementById('diag-title');
                const d = document.getElementById('diag-desc');

                if (!v) { r.classList.add('hidden'); return; }

                const db = {
                    accel_nose_down: { t: '加速度計校正失敗 (Nose Down Timeout)', d: '根因：手持震動 (Micro-movements) 或數傳頻寬不足。\n解法：\n1. 執行 Factory Reset。\n2. 改用 USB 連線 (確保頻寬)。\n3. 採用「靠牆法」物理固定機身。' },
                    motor_no_spin: { t: '馬達無反應 (Safety/Wiring)', d: '根因：安全開關未觸發、或 ESC 接錯至 FMU AUX。\n解法：\n1. 暫時設定 CBRK_IO_SAFETY = 22027 繞過安全開關。\n2. 確認 ESC 訊號線接在 IO PWM (Main Outputs)。' },
                    battery_volt: { t: '電池壓降過大 (Voltage Drop)', d: '檢查：起飛時壓降若 >1.5V，代表電池 C 數不足或老化。\n建議：檢查內阻 (應 <5mΩ/cell)，或更換高 C 數電池。' },
                    ubuntu_dep: { t: 'Ubuntu 24.04 安裝 CubeIDE 失敗', d: '原因：缺少 libncurses5/libpython2.7。\n解法：需手動下載舊版 deb 包 (libncurses5_6.3 等) 並使用 dpkg 安裝，然後再安裝 CubeIDE。' },
                    sitl_udp: { t: 'SITL 連接 Gazebo 逾時', d: '解法：1. 檢查防火牆 (ufw allow 14550/udp)。\n2. 設定 export PX4_SIM_HOST_ADDR=127.0.0.1。\n3. 使用 make px4_sitl_default gazebo __verbose:=1 查看詳細錯誤。' },
                    ros2_topic: { t: 'ROS 2 找不到 /fmu 主題', d: '解法：1. 確認 micro_xrce_dds_agent 已啟動 (udp4 -p 8888)。\n2. 確認 PX4 SITL 運行中。\n3. 重新 source /opt/ros/humble/setup.bash。' },
                    desync: { t: '馬達失步 (Desync)', d: '建議操作：1. 在 BLHeli 中增加 Rampup Power。 2. 檢查馬達接線是否鬆脫。' },
                    mag: { t: '羅盤干擾 (TBE)', d: '建議操作：1. 重新校準磁羅盤。 2. 將 GPS 支架移離 PDB 或電源線。' },
                    kill_switch: { t: '緊急斷電 (Kill Switch) 邏輯', d: '說明：按下 Kill Switch 馬達會瞬間停轉，但系統【仍維持 Armed 狀態】。\n注意：若在空中撥回開關，馬達會立即恢復全速旋轉！' },
                    compass_inc: { t: '羅盤不一致 (Compass Inconsistent)', d: '根因：環境磁場干擾，導致羅盤誤差超過 60 度。\n解法：系統會顯示紅色 Not Ready。請遠離金屬/螢幕，並在 Sensors 頁面重新六面校正。' },
                    no_local_pos: { t: '位置預估失敗 (No Valid Local Position)', d: '根因：室內無 GPS 訊號，Position 模式鎖死。\n解法：透過遙控器切換至 Stabilized (自穩) 模式，系統燈號轉為藍色呼吸燈後即可解鎖 (Arm)。' }
                };

                const data = db[v];
                if (data) {
                    t.innerText = data.t; d.innerText = data.d; r.classList.remove('hidden');
                }
            }

            // ==================== 10. 互動式導覽系統 ====================
            const steps = [
                { target: '[data-tour="sidebar"]', title: '目錄導航', text: '這裡包含所有工程文件模組。' },
                { target: '[data-tour="search"]', title: '全局搜尋', text: '支援快捷鍵，可快速查找術語與設定檔。' },
                { target: '[data-tour="bookmarks"]', title: '書籤管理', text: '儲存常用文件，關閉網頁也不會遺失。' },
                { target: '#section-roadmap', title: '閱讀文件', text: '點擊右上方星號即可加入書籤。' }
            ];

            function startTour() {
                tourStep = 0;
                document.getElementById('tour-overlay').classList.add('active');
                showTourStep();
            }

            function showTourStep() {
                const step = steps[tourStep];
                const target = document.querySelector(step.target);

                document.querySelectorAll('.tour-highlight').forEach(el => {
                    el.classList.remove('tour-highlight');
                    el.style.zIndex = '';
                });

                if (target) {
                    target.classList.add('tour-highlight');
                    target.style.zIndex = '10001';
                    target.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }

                const tooltip = document.createElement('div');
                tooltip.className = 'tour-tooltip animate-fade-in';

                if (target) {
                    const rect = target.getBoundingClientRect();
                    if (window.innerWidth - rect.right > 380) {
                        tooltip.style.left = `${rect.right + 20}px`;
                        tooltip.style.top = `${rect.top}px`;
                    } else {
                        tooltip.style.left = `50%`;
                        tooltip.style.top = `50%`;
                        tooltip.style.transform = `translate(-50%, -50%)`;
                    }
                } else {
                    tooltip.style.left = `50%`;
                    tooltip.style.top = `50%`;
                    tooltip.style.transform = `translate(-50%, -50%)`;
                }

                tooltip.innerHTML = `
                <h3 class="font-bold text-white mb-2 text-lg">${step.title}</h3>
                <p class="text-slate-300 text-sm mb-6">${step.text}</p>
                <div class="flex justify-between items-center mt-4">
                    <span class="text-xs text-slate-500">${tourStep + 1} / ${steps.length}</span>
                    <div class="space-x-2">
                        ${tourStep > 0 ? `<button class="tour-btn tour-btn-secondary" onclick="prevTourStep()">上一步</button>` : ''}
                        <button class="tour-btn tour-btn-primary" onclick="nextTourStep()">${tourStep === steps.length - 1 ? '完成' : '下一步'}</button>
                        <button class="tour-btn tour-btn-secondary" onclick="closeTour()">跳過</button>
                    </div>
                </div>
            `;

                const oldTooltip = document.querySelector('.tour-tooltip');
                if (oldTooltip) oldTooltip.remove();
                document.body.appendChild(tooltip);
            }

            function nextTourStep() {
                if (tourStep < steps.length - 1) { tourStep++; showTourStep(); }
                else { closeTour(); }
            }

            function prevTourStep() {
                if (tourStep > 0) { tourStep--; showTourStep(); }
            }

            function closeTour() {
                document.getElementById('tour-overlay').classList.remove('active');
                const tooltip = document.querySelector('.tour-tooltip');
                if (tooltip) tooltip.remove();
                document.querySelectorAll('.tour-highlight').forEach(el => {
                    el.classList.remove('tour-highlight'); el.style.zIndex = '';
                });
            }

            // ==================== 11. Pinout Search Logic ====================
            const fullPinoutData = [
                { p: "PA0", f: "TIM5_CH1", u: "FMU_CH7" },
                { p: "PA1", f: "TIM5_CH2", u: "FMU_CH8" },
                { p: "PA2", f: "ADC1_INP14", u: "FMU_BAT2_I" },
                { p: "PA3", f: "USART2_RX", u: "FMU_USART2_RX_TEL3" },
                { p: "PA4", f: "ADC1_INP18", u: "FMU_SCALED_V5" },
                { p: "PA5", f: "SPI1_SCK", u: "FMU_SPI1_SCK_SENSOR" },
                { p: "PA6", f: "SPI1_MISO", u: "FMU_SPI1_MISO_SENSOR" },
                { p: "PA7", f: "SPI1_MOSI", u: "FMU_SPI1_MOSI_SENSOR" },
                { p: "PA8", f: "TIM1_CH1", u: "FMU_CH1" },
                { p: "PA9", f: "USB_OTG_FS_VBUS", u: "FMU_VBUS_SENSE" },
                { p: "PA10", f: "USART1_RX", u: "FMU_UART_RX_GPS1" },
                { p: "PA11", f: "USB_OTG_FS_DM", u: "FMU_USB_DM" },
                { p: "PA12", f: "USB_OTG_FS_DP", u: "FMU_USB_DP" },
                { p: "PA13", f: "SWDIO", u: "FMU_SWDIO" },
                { p: "PA14", f: "SWCLK", u: "FMU_SWCLK" },
                { p: "PA15", f: "GPIO", u: "N_BRICK1_VALID" },
                { p: "PB0", f: "TIM3_CH3", u: "FMU_BUZZER" },
                { p: "PB1", f: "ADC1_INP5", u: "FMU_BAT2_V" },
                { p: "PB2", f: "GPIO", u: "VDD_3V3_SENSORS_EN" },
                { p: "PB3", f: "SDMMC2_D2", u: "FMU_SDMMC2_D2" },
                { p: "PB4", f: "SDMMC2_D3", u: "FMU_SDMMC2_D3" },
                { p: "PB5", f: "CAN2_RX", u: "FMU_CAN2_RX" },
                { p: "PB6", f: "USART1_TX", u: "FMU_USART1_TX_GPS1" },
                { p: "PB7", f: "I2C1_SDA", u: "FMU_I2C1_SDA_GPS1_MAG_LED" },
                { p: "PB8", f: "I2C1_SCL", u: "FMU_I2C1_SCL_GPS1_MAG_LED" },
                { p: "PB9", f: "TIM17_CH1", u: "FMU_HEATER" },
                { p: "PB10", f: "I2C2_SCL", u: "FMU_I2C2_SCL_GPS2_MAG_LED" },
                { p: "PB11", f: "I2C2_SDA", u: "FMU_I2C2_SDA_GPS2_MAG_LED" },
                { p: "PB12", f: "GPIO", u: "N_BRICK2_VALID" },
                { p: "PB13", f: "CAN2_TX", u: "FMU_CAN2_TX" },
                { p: "PB14", f: "SDMMC2_D0", u: "FMU_SDMMC2_D0" },
                { p: "PB15", f: "SDMMC2_D1", u: "FMU_SDMMC2_D1" },
                { p: "PC0", f: "ADC3_INP10", u: "HW_REV_SENSE" },
                { p: "PC1", f: "ADC3_INP11", u: "HW_VER_SENSE" },
                { p: "PC2", f: "SPI2_MISO", u: "FMU_SPI2_MISO_FRAM" },
                { p: "PC3", f: "SPI2_MOSI", u: "FMU_SPI2_MOSI_FRAM" },
                { p: "PC4", f: "ADC1_INP4", u: "FMU_BAT1_I" },
                { p: "PC5", f: "ADC1_INP8", u: "FMU_BAT1_V" },
                { p: "PC6", f: "USART6_TX", u: "FMU_USART6_TX_TO_IO" },
                { p: "PC7", f: "USART6_RX", u: "FMU_USART6_RX_FROM_IO" },
                { p: "PC8", f: "UART5_RTS", u: "FMU_UART5_RTS_TEL2" },
                { p: "PC9", f: "UART5_CTS", u: "FMU_UART5_CTS_TEL2" },
                { p: "PC10", f: "GPIO", u: "N_VDD_5V_HIPOWER_EN" },
                { p: "PC11", f: "GPIO", u: "N_VDD_5V_HIPOWER_OC" },
                { p: "PC12", f: "UART5_TX", u: "FMU_UART5_TX_TEL2" },
                { p: "PC13", f: "GPIO", u: "FMU_SPI1_CS3_ICM42688" },
                { p: "PC14", f: "GPIO", u: "FMU_SPI1_CS2_BMI055_GYRO" },
                { p: "PC15", f: "GPIO", u: "FMU_SPI1_CS1_BMI055_ACC" },
                { p: "PD0", f: "CAN1_RX", u: "FMU_CAN1_RX" },
                { p: "PD1", f: "CAN1_TX", u: "FMU_CAN1_TX" },
                { p: "PD2", f: "UART5_RX", u: "FMU_UART5_RX_TEL2" },
                { p: "PD3", f: "SPI2_SCK", u: "FMU_SPI2_SCK_FRAM" },
                { p: "PD4", f: "GPIO", u: "FMU_SPI2_CS_FRAM" },
                { p: "PD5", f: "USART2_TX", u: "FMU_USART2_TX_TEL3" },
                { p: "PD6", f: "SDMMC2_CK", u: "FMU_SDMMC2_CK" },
                { p: "PD7", f: "SDMMC2_CMD", u: "FMU_SDMMC2_CMD" },
                { p: "PD8", f: "USART3_TX", u: "FMU_USART3_TX_DEBUG" },
                { p: "PD9", f: "USART3_RX", u: "FMU_USART3_RX_DEBUG" },
                { p: "PD10", f: "GPIO", u: "N_FMU_LED_RED" },
                { p: "PD11", f: "GPIO", u: "N_FMU_LED_BLUE" },
                { p: "PD12", f: "I2C4_SCL", u: "FMU_I2C4_SCL" },
                { p: "PD13", f: "I2C4_SDA", u: "FMU_I2C4_SDA" },
                { p: "PD14", f: "TIM4_CH3", u: "FMU_CH5" },
                { p: "PD15", f: "TIM4_CH4", u: "FMU_CH6" },
                { p: "PE0", f: "UART8_RX", u: "FMU_UART8_RX_GPS2" },
                { p: "PE1", f: "UART8_TX", u: "FMU_UART8_TX_GPS2" },
                { p: "PE2", f: "GPIO", u: "N_VDD_5V_PERIPH_EN" },
                { p: "PE3", f: "GPIO", u: "N_VDD_5V_PERIPH_OC" },
                { p: "PE4", f: "GPIO", u: "FMU_SPI1_DRDY1_BMI055_ACC" },
                { p: "PE5", f: "GPIO", u: "FMU_SPI1_DRDY2_BMI055_GYRO" },
                { p: "PE6", f: "GPIO", u: "FMU_SPI1_DRDY3_ICM42688" },
                { p: "PE7", f: "UART7_RX", u: "FMU_UART7_RX_TEL1" },
                { p: "PE8", f: "UART7_TX", u: "FMU_UART7_TX_TEL1" },
                { p: "PE9", f: "UART7_RTS", u: "FMU_UART7_RTS_TEL1" },
                { p: "PE10", f: "UART7_CTS", u: "FMU_UART7_CTS_TEL1" },
                { p: "PE11", f: "TIM1_CH2", u: "FMU_CH2" },
                { p: "PE12", f: "GPIO", u: "HW_VER_REV_DRIVE" },
                { p: "PE13", f: "TIM1_CH3", u: "FMU_CH3" },
                { p: "PE14", f: "TIM1_CH4", u: "FMU_CH4" },
                { p: "PE15", f: "GPIO", u: "N_USB_VBUS_VALID" }
            ];

            function initPinoutSearch() {
                const tableBody = document.querySelector('#pinout-table tbody');
                const searchInput = document.getElementById('pinout-search');

                if (!tableBody || !searchInput) return;

                function renderTable(data) {
                    tableBody.innerHTML = data.map(row => `
                    <tr class="hover:bg-slate-800 transition border-b border-slate-800">
                        <td class="p-3 text-sky-400 font-bold">${row.p}</td>
                        <td class="p-3 text-emerald-400 font-mono text-xs">${row.f}</td>
                        <td class="p-3 text-slate-300 font-mono text-xs">${row.u}</td>
                    </tr>
                `).join('');
                }

                renderTable(fullPinoutData);

                searchInput.addEventListener('input', (e) => {
                    const term = e.target.value.toUpperCase();
                    const filtered = fullPinoutData.filter(item =>
                        item.p.includes(term) ||
                        item.f.includes(term) ||
                        item.u.includes(term)
                    );
                    renderTable(filtered);
                });
            }

            window.MathJax = {
                tex: {
                    inlineMath: [['$', '$'], ['\\(', '\\)']],
                    displayMath: [['$$', '$$'], ['\\[', '\\]']]
                }
            };
        </script>
</body>

</html>
